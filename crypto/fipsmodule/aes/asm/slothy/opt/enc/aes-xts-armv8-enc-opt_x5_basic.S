// The following xts encrypt is from MacBook M3 build folder
// after moving around some instructions

#if !defined(__has_feature)
#define __has_feature(x) 0
#endif
#if __has_feature(memory_sanitizer) && !defined(OPENSSL_NO_ASM)
#define OPENSSL_NO_ASM
#endif

#include <openssl/asm_base.h>

#if !defined(OPENSSL_NO_ASM) && defined(__AARCH64EL__)
#if defined(__ELF__)
#include <openssl/boringssl_prefix_symbols_asm.h>
#include <openssl/arm_arch.h>
.arch   armv8-a+crypto
.text
.globl  aes_hw_slothy_xts_encrypt
.hidden aes_hw_slothy_xts_encrypt
.type   aes_hw_slothy_xts_encrypt,%function
#elif defined(__APPLE__)
#if defined(BORINGSSL_PREFIX)
#include <boringssl_prefix_symbols_asm.h>
#endif
#include <openssl/arm_arch.h>
.text
.globl	_aes_hw_slothy_xts_encrypt
.private_extern	_aes_hw_slothy_xts_encrypt
#else
#error Unknown configuration
#endif

#if __ARM_MAX_ARCH__ >= 8

.align	4


#define STACK_BASE_VREGS 0
#define STACK_SIZE_VREGS (4*16)

.macro save_vregs
        stp  d8,  d9, [sp, #(STACK_BASE_VREGS + 16*0)]
        stp d10, d11, [sp, #(STACK_BASE_VREGS + 16*1)]
        stp d12, d13, [sp, #(STACK_BASE_VREGS + 16*2)]
        stp d14, d15, [sp, #(STACK_BASE_VREGS + 16*3)]
.endm

.macro restore_vregs
        ldp  d8,  d9, [sp, #(STACK_BASE_VREGS + 16*0)]
        ldp d10, d11, [sp, #(STACK_BASE_VREGS + 16*1)]
        ldp d12, d13, [sp, #(STACK_BASE_VREGS + 16*2)]
        ldp d14, d15, [sp, #(STACK_BASE_VREGS + 16*3)]
.endm

// A single AES round
// Prevent SLOTHY from unfolding because uArchs tend to fuse AESMC+AESE
.macro aesr data, key // @slothy:no-unfold
        aese  \data, \key
        aesmc \data, \data
.endm

_aes_hw_slothy_xts_encrypt:
aes_hw_slothy_xts_encrypt:
 # AARCH64_VALID_CALL_TARGET

    sub sp, sp, #STACK_SIZE_VREGS
    save_vregs

 cmp	x2,#16
    // Original input data size bigger than 16, jump to big size processing.
 b.ne	Lxts_enc_big_size
    // Encrypt the iv with key2, as the first XEX iv.
 ldr	w6,[x4,#240]
 ld1	{v0.16b},[x4],#16
 ld1	{v6.16b},[x5]
 sub	w6,w6,#2
 ld1	{v1.16b},[x4],#16

Loop_enc_iv_enc:
 aese	v6.16b,v0.16b
 aesmc	v6.16b,v6.16b
 ld1	{v0.4s},[x4],#16
 aese	v6.16b,v1.16b
 aesmc	v6.16b,v6.16b
 ld1	{v1.4s},[x4],#16
 subs	w6,w6,#2
 cbnz	w6,Loop_enc_iv_enc

 aese	v6.16b,v0.16b
 aesmc	v6.16b,v6.16b
 ld1	{v0.4s},[x4]
 aese	v6.16b,v1.16b
 eor	v6.16b,v6.16b,v0.16b

 ld1	{v0.16b},[x0]
 eor	v0.16b,v6.16b,v0.16b

 ldr	w6,[x3,#240]
 ld1	{v28.4s,v29.4s},[x3],#32       // load key schedule...

 aese	v0.16b,v28.16b
 aesmc	v0.16b,v0.16b
 ld1	{v16.4s,v17.4s},[x3],#32         // load key schedule...
 aese	v0.16b,v29.16b
 aesmc	v0.16b,v0.16b
 subs	w6,w6,#10     // if rounds==10, jump to aes-128-xts processing
// b.eq    .Lxts_128_enc
Lxts_enc_round_loop:
 aese	v0.16b,v16.16b
 aesmc	v0.16b,v0.16b
 ld1	{v16.4s},[x3],#16            // load key schedule...
 aese	v0.16b,v17.16b
 aesmc	v0.16b,v0.16b
 ld1	{v17.4s},[x3],#16            // load key schedule...
 subs	w6,w6,#2          // bias
 b.gt	Lxts_enc_round_loop
// .Lxts_128_enc:
 ld1	{v18.4s,v19.4s},[x3],#32       // load key schedule...
 aese	v0.16b,v16.16b
 aesmc	v0.16b,v0.16b
 aese	v0.16b,v17.16b
 aesmc	v0.16b,v0.16b
 ld1	{v20.4s,v21.4s},[x3],#32       // load key schedule...
 aese	v0.16b,v18.16b
 aesmc	v0.16b,v0.16b
 aese	v0.16b,v19.16b
 aesmc	v0.16b,v0.16b
 ld1	{v22.4s,v23.4s},[x3],#32       // load key schedule...
 aese	v0.16b,v20.16b
 aesmc	v0.16b,v0.16b
 aese	v0.16b,v21.16b
 aesmc	v0.16b,v0.16b
 ld1	{v7.4s},[x3]
 aese	v0.16b,v22.16b
 aesmc	v0.16b,v0.16b
 aese	v0.16b,v23.16b
 eor	v0.16b,v0.16b,v7.16b
 eor	v0.16b,v0.16b,v6.16b
 st1	{v0.16b},[x1]
 b	Lxts_enc_final_abort

.align	4
Lxts_enc_big_size:
   // Encrypt input size > 16 bytes
 stp	x19,x20,[sp,#-32]!
 stp	x21,x22,[sp,#16]

    // tailcnt store the tail value of length%16.
 and	x21,x2,#0xf
 and	x2,x2,#-16    // len &= 0x1..110000, now divisible by 16
 subs	x2,x2,#16
 mov	x8,#16
 b.lo	Lxts_abort         // if !(len > 16): error
 csel	x8,xzr,x8,eq  // if (len == 16): step = 0

    // Firstly, encrypt the iv with key2, as the first iv of XEX.
 ldr	w6,[x4,#240]
 ld1	{v0.4s},[x4],#16
 ld1	{v6.16b},[x5]
 sub	w6,w6,#2
 ld1	{v1.4s},[x4],#16

Loop_iv_enc:
 aese	v6.16b,v0.16b
 aesmc	v6.16b,v6.16b
 ld1	{v0.4s},[x4],#16
 subs	w6,w6,#2
 aese	v6.16b,v1.16b
 aesmc	v6.16b,v6.16b
 ld1	{v1.4s},[x4],#16
 b.gt	Loop_iv_enc

 aese	v6.16b,v0.16b
 aesmc	v6.16b,v6.16b
 ld1	{v0.4s},[x4]
 aese	v6.16b,v1.16b
 eor	v6.16b,v6.16b,v0.16b

    // The iv for second block
    // x9- iv(low), x10 - iv(high)
    // the five ivs stored into, v6.16b,v8.16b,v9.16b,v10.16b,v11.16b
 fmov	x9,d6
 fmov	x10,v6.d[1]
 mov	w19,#0x87
 extr	x22,x10,x10,#32
 extr	x10,x10,x9,#63
 and	w11,w19,w22,asr#31
 eor	x9,x11,x9,lsl#1
 fmov	d8,x9
 fmov	v8.d[1],x10

 ldr	w5,[x3,#240]       // next starting point
 ld1	{v0.16b},[x0],x8

    mov x7, x3
 ld1	{v16.4s,v17.4s},[x7], #32         // load key schedule...
    ld1 {v12.4s,v13.4s},[x7], #32
 ld1	{v14.4s,v15.4s},[x7], #32
    ld1 {v4.4s,v5.4s},  [x7], #32
    ld1	{v18.4s,v19.4s},[x7], #32
 ld1	{v20.4s,v21.4s},[x7], #32
 ld1	{v22.4s,v23.4s},[x7], #32
 ld1	{v7.4s},        [x7]

 sub	w5,w5,#8
 add	x7,x3,#32
 mov	w6,w5

    // Encryption
Lxts_enc:
 ld1	{v24.16b},[x0],#16
 subs	x2,x2,#32           // bias
 add	w6,w5,#2
 orr	v28.16b,v0.16b,v0.16b
 orr	v29.16b,v24.16b,v24.16b
 b.lo	Lxts_inner_enc_tail    // when input size % 5 = 1 or 2
                                    // (with tail or not)
 eor	v0.16b,v0.16b,v6.16b          // before encryption, xor with iv
 eor	v24.16b,v24.16b,v8.16b

    // The iv for third block
 extr	x22,x10,x10,#32
 extr	x10,x10,x9,#63
 and	w11,w19,w22,asr#31
 eor	x9,x11,x9,lsl#1
 fmov	d9,x9
 fmov	v9.d[1],x10


 orr	v1.16b,v24.16b,v24.16b
 ld1	{v24.16b},[x0],#16
 orr	v2.16b,v0.16b,v0.16b
 orr	v3.16b,v1.16b,v1.16b
 eor	v27.16b,v24.16b,v9.16b         // the third block
 eor	v24.16b,v24.16b,v9.16b
 cmp	x2,#32
 b.lo	Lxts_outer_enc_tail

    // The iv for fourth block
 extr	x22,x10,x10,#32
 extr	x10,x10,x9,#63
 and	w11,w19,w22,asr#31
 eor	x9,x11,x9,lsl#1
 fmov	d10,x9
 fmov	v10.d[1],x10

 ld1	{v25.16b},[x0],#16
    // The iv for fifth block
 extr	x22,x10,x10,#32
 extr	x10,x10,x9,#63
 and	w11,w19,w22,asr#31
 eor	x9,x11,x9,lsl#1
 fmov	d11,x9
 fmov	v11.d[1],x10

 ld1	{v26.16b},[x0],#16
 eor	v25.16b,v25.16b,v10.16b        // the fourth block
 eor	v26.16b,v26.16b,v11.16b
 sub	x2,x2,#32           // bias
 mov	w6,w5

.align	4
                                             // Instructions:    340
                                             // Expected cycles: 119
                                             // Expected IPC:    2.86
                                             //
                                             // Cycle bound:     119.0
                                             // IPC bound:       2.86
                                             //
                                             // Wall time:     85.00s
                                             // User time:     85.00s
                                             //
                                             // -------------------------------------------------- cycle (expected) -------------------------------------------------->
                                             // 0                        25                       50                       75                       100
                                             // |------------------------|------------------------|------------------------|------------------------|------------------
        extr x12, x10, x9, #63               // *......................................................................................................................
        extr x22, x10, x10, #32              // *......................................................................................................................
        aese v25.16b, v16.16b                // *......................................................................................................................
        aese v1.16b, v16.16b                 // *......................................................................................................................
        subs x15, x2, #0x50                  // *......................................................................................................................
        aese v24.16b, v16.16b                // .*.....................................................................................................................
        aese v26.16b, v16.16b                // .*.....................................................................................................................
        csel x17, xzr, x15, gt               // .*.....................................................................................................................
        subs x10, x2, #0x50                  // .*.....................................................................................................................
        and w6, w19, w22, asr #31            // .*.....................................................................................................................
        aesmc v31.16b, v25.16b               // ..*....................................................................................................................
        add x16, x0, x17                     // ..*....................................................................................................................
        eor x0, x6, x9, lsl #1               // ..*....................................................................................................................
        aesmc v27.16b, v1.16b                // ..*....................................................................................................................
        extr x22, x12, x12, #32              // ..*....................................................................................................................
        aesmc v1.16b, v26.16b                // ...*...................................................................................................................
        extr x6, x12, x0, #63                // ...*...................................................................................................................
        and w9, w19, w22, asr #31            // ...*...................................................................................................................
        aesmc v24.16b, v24.16b               // ...*...................................................................................................................
        aese v27.16b, v17.16b                // ....*..................................................................................................................
        eor x17, x9, x0, lsl #1              // ....*..................................................................................................................
        aese v31.16b, v17.16b                // ....*..................................................................................................................
        extr x22, x6, x6, #32                // ....*..................................................................................................................
        ldr q30, [x16, #32]                  // .....*.................................................................................................................
        aese v24.16b, v17.16b                // .....*.................................................................................................................
        aese v1.16b, v17.16b                 // .....*.................................................................................................................
        and w14, w19, w22, asr #31           // .....*.................................................................................................................
        extr x7, x6, x17, #63                // .....*.................................................................................................................
        aesmc v28.16b, v27.16b               // ......*................................................................................................................
        aesmc v2.16b, v31.16b                // ......*................................................................................................................
        eor x15, x14, x17, lsl #1            // ......*................................................................................................................
        extr x22, x7, x7, #32                // ......*................................................................................................................
        aesmc v31.16b, v24.16b               // .......*...............................................................................................................
        fmov d25, x15                        // .......*...............................................................................................................
        aese v2.16b, v12.16b                 // ........*..............................................................................................................
        aese v28.16b, v12.16b                // ........*..............................................................................................................
        extr x5, x7, x15, #63                // ........*..............................................................................................................
        and w4, w19, w22, asr #31            // ........*..............................................................................................................
        extr x22, x5, x5, #32                // .........*.............................................................................................................
        aesmc v1.16b, v1.16b                 // .........*.............................................................................................................
        aesmc v24.16b, v28.16b               // ..........*............................................................................................................
        aesmc v27.16b, v2.16b                // ..........*............................................................................................................
        fmov v25.d[1], x7                    // ..........*............................................................................................................
        and w14, w19, w22, asr #31           // ..........*............................................................................................................
        aese v1.16b, v12.16b                 // ...........*...........................................................................................................
        aese v31.16b, v12.16b                // ...........*...........................................................................................................
        aese v24.16b, v13.16b                // ............*..........................................................................................................
        aese v27.16b, v13.16b                // ............*..........................................................................................................
        eor v3.16B, v30.16B, v25.16B         // .............*.........................................................................................................
        aesmc v26.16b, v31.16b               // .............*.........................................................................................................
        aesmc v1.16b, v1.16b                 // .............*.........................................................................................................
        aesmc v31.16b, v27.16b               // ..............*........................................................................................................
        fmov d30, x0                         // ..............*........................................................................................................
        aesmc v27.16b, v24.16b               // ..............*........................................................................................................
        aese v3.16b, v16.16b                 // ...............*.......................................................................................................
        eor x8, x4, x15, lsl #1              // ...............*.......................................................................................................
        aese v26.16b, v13.16b                // ...............*.......................................................................................................
        aese v1.16b, v13.16b                 // ...............*.......................................................................................................
        csel x15, xzr, x10, gt               // ...............*.......................................................................................................
        aese v31.16b, v14.16b                // ................*......................................................................................................
        aese v27.16b, v14.16b                // ................*......................................................................................................
        eor x7, x14, x8, lsl #1              // ................*......................................................................................................
        aesmc v1.16b, v1.16b                 // .................*.....................................................................................................
        aesmc v2.16b, v26.16b                // .................*.....................................................................................................
        aesmc v24.16b, v3.16b                // .................*.....................................................................................................
        aesmc v29.16b, v27.16b               // ..................*....................................................................................................
        aesmc v3.16b, v31.16b                // ..................*....................................................................................................
        aese v24.16b, v17.16b                // ...................*...................................................................................................
        aese v2.16b, v14.16b                 // ...................*...................................................................................................
        aese v1.16b, v14.16b                 // ...................*...................................................................................................
        aese v0.16b, v16.16b                 // ....................*..................................................................................................
        aese v29.16b, v15.16b                // ....................*..................................................................................................
        aese v3.16b, v15.16b                 // ....................*..................................................................................................
        aesmc v26.16b, v2.16b                // .....................*.................................................................................................
        aesmc v27.16b, v24.16b               // .....................*.................................................................................................
        aesmc v1.16b, v1.16b                 // .....................*.................................................................................................
        aesmc v31.16b, v3.16b                // ......................*................................................................................................
        aesmc v28.16b, v29.16b               // ......................*................................................................................................
        aese v1.16b, v15.16b                 // .......................*...............................................................................................
        aese v27.16b, v12.16b                // .......................*...............................................................................................
        aese v26.16b, v15.16b                // .......................*...............................................................................................
        aese v31.16b, v4.16b                 // ........................*..............................................................................................
        add x0, x16, x15                     // ........................*..............................................................................................
        aese v28.16b, v4.16b                 // ........................*..............................................................................................
        aesmc v3.16b, v1.16b                 // .........................*.............................................................................................
        aesmc v1.16b, v27.16b                // .........................*.............................................................................................
        ldp q2, q27, [x16], #0x50            // .........................*.............................................................................................
        aesmc v26.16b, v26.16b               // .........................*.............................................................................................
        aesmc v29.16b, v31.16b               // ..........................*............................................................................................
        aesmc v24.16b, v28.16b               // ..........................*............................................................................................
        fmov v30.d[1], x12                   // ..........................*............................................................................................
        aese v1.16b, v13.16b                 // ...........................*...........................................................................................
        aese v24.16b, v5.16b                 // ............................*..........................................................................................
        aese v26.16b, v4.16b                 // ............................*..........................................................................................
        aese v29.16b, v5.16b                 // ............................*..........................................................................................
        aesmc v1.16b, v1.16b                 // .............................*.........................................................................................
        eor v31.16B, v2.16B, v30.16B         // .............................*.........................................................................................
        aesmc v28.16b, v26.16b               // ..............................*........................................................................................
        aesmc v29.16b, v29.16b               // ..............................*........................................................................................
        aesmc v24.16b, v24.16b               // ..............................*........................................................................................
        aese v3.16b, v4.16b                  // ...............................*.......................................................................................
        aese v31.16b, v16.16b                // ...............................*.......................................................................................
        aese v1.16b, v14.16b                 // ...............................*.......................................................................................
        aese v29.16b, v18.16b                // ................................*......................................................................................
        aese v28.16b, v5.16b                 // ................................*......................................................................................
        aese v24.16b, v18.16b                // ................................*......................................................................................
        aesmc v2.16b, v1.16b                 // .................................*.....................................................................................
        aesmc v31.16b, v31.16b               // .................................*.....................................................................................
        aesmc v1.16b, v29.16b                // ..................................*....................................................................................
        aesmc v29.16b, v28.16b               // ..................................*....................................................................................
        aesmc v26.16b, v24.16b               // ..................................*....................................................................................
        aese v2.16b, v15.16b                 // ...................................*...................................................................................
        aesmc v24.16b, v3.16b                // ...................................*...................................................................................
        aese v31.16b, v17.16b                // ...................................*...................................................................................
        aese v29.16b, v18.16b                // ....................................*..................................................................................
        aese v26.16b, v19.16b                // ....................................*..................................................................................
        aese v1.16b, v19.16b                 // ....................................*..................................................................................
        aese v24.16b, v5.16b                 // .....................................*.................................................................................
        aesmc v28.16b, v31.16b               // .....................................*.................................................................................
        aesmc v31.16b, v2.16b                // .....................................*.................................................................................
        aesmc v3.16b, v29.16b                // ......................................*................................................................................
        aesmc v29.16b, v1.16b                // ......................................*................................................................................
        aesmc v26.16b, v26.16b               // ......................................*................................................................................
        aese v28.16b, v12.16b                // .......................................*...............................................................................
        aesmc v1.16b, v24.16b                // .......................................*...............................................................................
        aese v31.16b, v4.16b                 // .......................................*...............................................................................
        aese v29.16b, v20.16b                // ........................................*..............................................................................
        aese v26.16b, v20.16b                // ........................................*..............................................................................
        aese v3.16b, v19.16b                 // ........................................*..............................................................................
        aesmc v24.16b, v28.16b               // .........................................*.............................................................................
        aese v1.16b, v18.16b                 // .........................................*.............................................................................
        aesmc v31.16b, v31.16b               // .........................................*.............................................................................
        aesmc v2.16b, v29.16b                // ..........................................*............................................................................
        aesmc v28.16b, v3.16b                // ..........................................*............................................................................
        aesmc v3.16b, v26.16b                // ..........................................*............................................................................
        aese v24.16b, v13.16b                // ...........................................*...........................................................................
        aesmc v29.16b, v1.16b                // ...........................................*...........................................................................
        aese v31.16b, v5.16b                 // ...........................................*...........................................................................
        aese v28.16b, v20.16b                // ............................................*..........................................................................
        aese v2.16b, v21.16b                 // ............................................*..........................................................................
        aese v3.16b, v21.16b                 // ............................................*..........................................................................
        aesmc v1.16b, v31.16b                // .............................................*.........................................................................
        aese v29.16b, v19.16b                // .............................................*.........................................................................
        aesmc v24.16b, v24.16b               // .............................................*.........................................................................
        aesmc v26.16b, v3.16b                // ..............................................*........................................................................
        aesmc v28.16b, v28.16b               // ..............................................*........................................................................
        aesmc v31.16b, v2.16b                // ..............................................*........................................................................
        aese v24.16b, v14.16b                // ...............................................*.......................................................................
        aese v1.16b, v18.16b                 // ...............................................*.......................................................................
        aese v28.16b, v21.16b                // ................................................*......................................................................
        aese v31.16b, v22.16b                // ................................................*......................................................................
        aese v26.16b, v22.16b                // ................................................*......................................................................
        aesmc v3.16b, v24.16b                // .................................................*.....................................................................
        aesmc v24.16b, v1.16b                // .................................................*.....................................................................
        aesmc v1.16b, v29.16b                // .................................................*.....................................................................
        aesmc v29.16b, v28.16b               // ..................................................*....................................................................
        aesmc v28.16b, v31.16b               // ..................................................*....................................................................
        fmov d31, x17                        // ..................................................*....................................................................
        aesmc v26.16b, v26.16b               // ..................................................*....................................................................
        aese v3.16b, v15.16b                 // ...................................................*...................................................................
        aese v1.16b, v20.16b                 // ...................................................*...................................................................
        aese v26.16b, v23.16b                // ....................................................*..................................................................
        aese v28.16b, v23.16b                // ....................................................*..................................................................
        aese v24.16b, v19.16b                // ....................................................*..................................................................
        aese v29.16b, v22.16b                // .....................................................*.................................................................
        aesmc v3.16b, v3.16b                 // .....................................................*.................................................................
        aesmc v2.16b, v1.16b                 // .....................................................*.................................................................
        fmov v31.d[1], x6                    // .....................................................*.................................................................
        eor v28.16B, v28.16B, v7.16B         // ......................................................*................................................................
        eor v1.16B, v26.16B, v7.16B          // ......................................................*................................................................
        aesmc v26.16b, v0.16b                // ......................................................*................................................................
        aese v3.16b, v4.16b                  // .......................................................*...............................................................
        aesmc v0.16b, v29.16b                // .......................................................*...............................................................
        extr x15, x5, x8, #63                // .......................................................*...............................................................
        eor v1.16B, v1.16B, v8.16B           // ........................................................*..............................................................
        eor v8.16B, v28.16B, v10.16B         // ........................................................*..............................................................
        fmov d10, x8                         // ........................................................*..............................................................
        aese v26.16b, v17.16b                // ........................................................*..............................................................
        aesmc v29.16b, v3.16b                // .........................................................*.............................................................
        aese v0.16b, v23.16b                 // .........................................................*.............................................................
        eor v3.16B, v27.16B, v31.16B         // .........................................................*.............................................................
        aesmc v27.16b, v26.16b               // ..........................................................*............................................................
        aesmc v26.16b, v24.16b               // ..........................................................*............................................................
        ldp q28, q24, [x16, #-32]            // ..........................................................*............................................................
        eor v0.16B, v0.16B, v7.16B           // ...........................................................*...........................................................
        fmov v10.d[1], x5                    // ...........................................................*...........................................................
        aese v29.16b, v5.16b                 // ...........................................................*...........................................................
        extr x22, x15, x15, #32              // ...........................................................*...........................................................
        aese v27.16b, v12.16b                // ............................................................*..........................................................
        aese v2.16b, v21.16b                 // ............................................................*..........................................................
        and w10, w19, w22, asr #31           // ............................................................*..........................................................
        aese v26.16b, v20.16b                // .............................................................*.........................................................
        eor v0.16B, v0.16B, v9.16B           // .............................................................*.........................................................
        extr x4, x15, x7, #63                // .............................................................*.........................................................
        eor v9.16B, v28.16B, v10.16B         // ..............................................................*........................................................
        aesmc v28.16b, v2.16b                // ..............................................................*........................................................
        aesmc v2.16b, v27.16b                // ..............................................................*........................................................
        aese v3.16b, v16.16b                 // ..............................................................*........................................................
        extr x22, x4, x4, #32                // ..............................................................*........................................................
        stp q0, q8, [x1, #32]                // ...............................................................*.......................................................
        aesmc v8.16b, v29.16b                // ...............................................................*.......................................................
        aese v28.16b, v22.16b                // ................................................................*......................................................
        aesmc v0.16b, v3.16b                 // ................................................................*......................................................
        aese v9.16b, v16.16b                 // ................................................................*......................................................
        aese v2.16b, v13.16b                 // ................................................................*......................................................
        aesmc v29.16b, v26.16b               // .................................................................*.....................................................
        aese v8.16b, v18.16b                 // .................................................................*.....................................................
        aese v0.16b, v17.16b                 // ..................................................................*....................................................
        aesmc v26.16b, v9.16b                // ..................................................................*....................................................
        aesmc v3.16b, v28.16b                // ..................................................................*....................................................
        aesmc v27.16b, v2.16b                // ..................................................................*....................................................
        aese v29.16b, v21.16b                // ...................................................................*...................................................
        aesmc v9.16b, v8.16b                 // ...................................................................*...................................................
        aese v27.16b, v14.16b                // ....................................................................*..................................................
        aese v26.16b, v17.16b                // ....................................................................*..................................................
        aese v3.16b, v23.16b                 // ....................................................................*..................................................
        aesmc v8.16b, v0.16b                 // ....................................................................*..................................................
        aesmc v28.16b, v29.16b               // .....................................................................*.................................................
        aese v9.16b, v19.16b                 // .....................................................................*.................................................
        aesmc v27.16b, v27.16b               // ......................................................................*................................................
        aesmc v29.16b, v26.16b               // ......................................................................*................................................
        aese v8.16b, v12.16b                 // ......................................................................*................................................
        aese v28.16b, v22.16b                // .......................................................................*...............................................
        aesmc v26.16b, v9.16b                // .......................................................................*...............................................
        aese v29.16b, v12.16b                // ........................................................................*..............................................
        aese v27.16b, v15.16b                // ........................................................................*..............................................
        aesmc v0.16b, v8.16b                 // ........................................................................*..............................................
        aese v26.16b, v20.16b                // .........................................................................*.............................................
        aesmc v8.16b, v29.16b                // ..........................................................................*............................................
        eor v9.16B, v3.16B, v7.16B           // ..........................................................................*............................................
        aesmc v29.16b, v27.16b               // ..........................................................................*............................................
        aese v0.16b, v13.16b                 // ..........................................................................*............................................
        aesmc v2.16b, v28.16b                // ...........................................................................*...........................................
        aesmc v28.16b, v26.16b               // ............................................................................*..........................................
        aese v8.16b, v13.16b                 // ............................................................................*..........................................
        aese v29.16b, v4.16b                 // ............................................................................*..........................................
        aesmc v0.16b, v0.16b                 // ............................................................................*..........................................
        aese v2.16b, v23.16b                 // .............................................................................*.........................................
        aesmc v3.16b, v8.16b                 // ..............................................................................*........................................
        aesmc v27.16b, v29.16b               // ..............................................................................*........................................
        aese v28.16b, v21.16b                // ..............................................................................*........................................
        aese v0.16b, v14.16b                 // ..............................................................................*........................................
        aesmc v28.16b, v28.16b               // ................................................................................*......................................
        aese v3.16b, v14.16b                 // ................................................................................*......................................
        aese v27.16b, v5.16b                 // ................................................................................*......................................
        aesmc v8.16b, v0.16b                 // ................................................................................*......................................
        aesmc v29.16b, v3.16b                // ..................................................................................*....................................
        aesmc v0.16b, v27.16b                // ..................................................................................*....................................
        aese v8.16b, v15.16b                 // ..................................................................................*....................................
        aese v28.16b, v22.16b                // ...................................................................................*...................................
        aese v0.16b, v18.16b                 // ....................................................................................*..................................
        aese v29.16b, v15.16b                // ....................................................................................*..................................
        aesmc v3.16b, v8.16b                 // ....................................................................................*..................................
        aesmc v26.16b, v28.16b               // .....................................................................................*.................................
        aesmc v8.16b, v0.16b                 // ......................................................................................*................................
        aesmc v29.16b, v29.16b               // ......................................................................................*................................
        aese v3.16b, v4.16b                  // ......................................................................................*................................
        aese v29.16b, v4.16b                 // ........................................................................................*..............................
        aese v8.16b, v19.16b                 // ........................................................................................*..............................
        aese v26.16b, v23.16b                // ........................................................................................*..............................
        aesmc v3.16b, v3.16b                 // ........................................................................................*..............................
        aesmc v28.16b, v29.16b               // ..........................................................................................*............................
        aesmc v29.16b, v8.16b                // ..........................................................................................*............................
        aese v3.16b, v5.16b                  // ..........................................................................................*............................
        aese v28.16b, v5.16b                 // ............................................................................................*..........................
        aese v29.16b, v20.16b                // ............................................................................................*..........................
        aesmc v3.16b, v3.16b                 // ............................................................................................*..........................
        aesmc v8.16b, v29.16b                // ..............................................................................................*........................
        aesmc v27.16b, v28.16b               // ..............................................................................................*........................
        aese v3.16b, v18.16b                 // ..............................................................................................*........................
        aese v8.16b, v21.16b                 // ................................................................................................*......................
        aese v27.16b, v18.16b                // ................................................................................................*......................
        aesmc v29.16b, v3.16b                // ................................................................................................*......................
        aesmc v0.16b, v8.16b                 // ..................................................................................................*....................
        aesmc v8.16b, v27.16b                // ..................................................................................................*....................
        aese v29.16b, v19.16b                // ..................................................................................................*....................
        eor v27.16B, v2.16B, v7.16B          // ...................................................................................................*...................
        aese v8.16b, v19.16b                 // ....................................................................................................*..................
        aesmc v28.16b, v29.16b               // ....................................................................................................*..................
        aesmc v3.16b, v8.16b                 // ......................................................................................................*................
        aese v0.16b, v22.16b                 // ......................................................................................................*................
        aese v28.16b, v20.16b                // ......................................................................................................*................
        eor v29.16B, v9.16B, v11.16B         // .......................................................................................................*...............
        fmov d11, x7                         // .......................................................................................................*...............
        aese v3.16b, v20.16b                 // ........................................................................................................*..............
        aesmc v2.16b, v0.16b                 // ........................................................................................................*..............
        aesmc v8.16b, v28.16b                // ........................................................................................................*..............
        eor v28.16B, v27.16B, v25.16B        // .........................................................................................................*.............
        fmov v11.d[1], x15                   // ..........................................................................................................*............
        aese v2.16b, v23.16b                 // ..........................................................................................................*............
        aesmc v3.16b, v3.16b                 // ..........................................................................................................*............
        aese v8.16b, v21.16b                 // ..........................................................................................................*............
        and w15, w19, w22, asr #31           // ..........................................................................................................*............
        eor x11, x10, x7, lsl #1             // ...........................................................................................................*...........
        eor v9.16B, v2.16B, v7.16B           // ............................................................................................................*..........
        aese v3.16b, v21.16b                 // ............................................................................................................*..........
        aesmc v0.16b, v8.16b                 // ............................................................................................................*..........
        eor x10, x15, x11, lsl #1            // ............................................................................................................*..........
        extr x5, x4, x11, #63                // ............................................................................................................*..........
        fmov d8, x10                         // .............................................................................................................*.........
        extr x22, x5, x5, #32                // .............................................................................................................*.........
        eor v24.16B, v24.16B, v11.16B        // .............................................................................................................*.........
        aesmc v25.16b, v3.16b                // ..............................................................................................................*........
        eor v9.16B, v9.16B, v6.16B           // ..............................................................................................................*........
        fmov d6, x11                         // ..............................................................................................................*........
        aese v0.16b, v22.16b                 // ..............................................................................................................*........
        and w15, w19, w22, asr #31           // ..............................................................................................................*........
        aese v24.16b, v16.16b                // ...............................................................................................................*.......
        ldp q2, q3, [x0], #0x50              // ...............................................................................................................*.......
        eor x7, x15, x10, lsl #1             // ...............................................................................................................*.......
        aese v25.16b, v22.16b                // ................................................................................................................*......
        stp q9, q1, [x1], #0x50              // ................................................................................................................*......
        fmov d9, x7                          // ................................................................................................................*......
        aesmc v0.16b, v0.16b                 // ................................................................................................................*......
        extr x10, x5, x10, #63               // ................................................................................................................*......
        aesmc v27.16b, v24.16b               // .................................................................................................................*.....
        eor v1.16B, v26.16B, v7.16B          // .................................................................................................................*.....
        fmov v6.d[1], x4                     // .................................................................................................................*.....
        aesmc v26.16b, v25.16b               // ..................................................................................................................*....
        extr x22, x10, x10, #32              // ..................................................................................................................*....
        aese v0.16b, v23.16b                 // ..................................................................................................................*....
        ldr q24, [x0, #-48]                  // ..................................................................................................................*....
        fmov v8.d[1], x5                     // ...................................................................................................................*...
        and w15, w19, w22, asr #31           // ...................................................................................................................*...
        fmov v9.d[1], x10                    // ...................................................................................................................*...
        extr x17, x10, x7, #63               // ...................................................................................................................*...
        aese v26.16b, v23.16b                // ....................................................................................................................*..
        eor v25.16B, v1.16B, v30.16B         // ....................................................................................................................*..
        eor v1.16B, v0.16B, v7.16B           // ....................................................................................................................*..
        extr x22, x17, x17, #32              // ....................................................................................................................*..
        eor v0.16B, v2.16B, v6.16B           // .....................................................................................................................*.
        eor x12, x15, x7, lsl #1             // .....................................................................................................................*.
        ldp q2, q30, [x0, #-32]              // .....................................................................................................................*.
        and w15, w19, w22, asr #31           // .....................................................................................................................*.
        eor v31.16B, v1.16B, v31.16B         // ......................................................................................................................*
        eor v24.16B, v24.16B, v9.16B         // ......................................................................................................................*
        eor v1.16B, v3.16B, v8.16B           // ......................................................................................................................*
        eor v3.16B, v26.16B, v7.16B          // ......................................................................................................................*
        eor x9, x15, x12, lsl #1             // ......................................................................................................................*
        extr x10, x17, x12, #63              // ......................................................................................................................*

                                                                 // -------------------------------------------------- cycle (expected) -------------------------------------------------->
                                                                 // 0                        25                       50                       75                       100
                                                                 // |------------------------|------------------------|------------------------|------------------------|------------------
        // extr X<ssa_1>, x10, x9, #63                           // *......................................................................................................................
        // aese v24.16b, v16.16b                                 // .*.....................................................................................................................
        // extr x22, x10, x10, #32                               // *......................................................................................................................
        // and W<ssa_3>, w19, w22, asr #31                       // .*.....................................................................................................................
        // aese v0.16b, v16.16b                                  // ....................*..................................................................................................
        // aese v1.16b, v16.16b                                  // *......................................................................................................................
        // subs X<ssa_4>, x2, #0x50                              // *......................................................................................................................
        // extr x22, X<ssa_1>, X<ssa_1>, #32                     // ..*....................................................................................................................
        // aesmc V<ssa_6>.16b, v24.16b                           // ...*...................................................................................................................
        // eor X<ssa_7>, X<ssa_3>, x9, lsl #1                    // ..*....................................................................................................................
        // csel X<ssa_8>, xzr, X<ssa_4>, gt                      // .*.....................................................................................................................
        // and W<ssa_9>, w19, w22, asr #31                       // ...*...................................................................................................................
        // aesmc V<ssa_10>.16b, v0.16b                           // ......................................................*................................................................
        // aesmc V<ssa_12>.16b, v1.16b                           // ..*....................................................................................................................
        // eor X<ssa_13>, X<ssa_9>, X<ssa_7>, lsl #1             // ....*..................................................................................................................
        // extr X<ssa_14>, X<ssa_1>, X<ssa_7>, #63               // ...*...................................................................................................................
        // add X<ssa_15>, x0, X<ssa_8>                           // ..*....................................................................................................................
        // aese V<ssa_6>.16b, v17.16b                            // .....*.................................................................................................................
        // extr X<ssa_16>, X<ssa_14>, X<ssa_13>, #63             // .....*.................................................................................................................
        // extr x22, X<ssa_14>, X<ssa_14>, #32                   // ....*..................................................................................................................
        // aese V<ssa_10>.16b, v17.16b                           // ........................................................*..............................................................
        // aese V<ssa_12>.16b, v17.16b                           // ....*..................................................................................................................
        // ldp Q<ssa_17>, Q<ssa_18>, [X<ssa_15>], #0x50          // .........................*.............................................................................................
        // and W<ssa_19>, w19, w22, asr #31                      // .....*.................................................................................................................
        // extr x22, X<ssa_16>, X<ssa_16>, #32                   // ......*................................................................................................................
        // aesmc V<ssa_20>.16b, V<ssa_6>.16b                     // .......*...............................................................................................................
        // eor X<ssa_21>, X<ssa_19>, X<ssa_13>, lsl #1           // ......*................................................................................................................
        // ldr Q<ssa_23>, [X<ssa_15>, #-48]                      // .....*.................................................................................................................
        // and W<ssa_24>, w19, w22, asr #31                      // ........*..............................................................................................................
        // aesmc V<ssa_26>.16b, V<ssa_10>.16b                    // ..........................................................*............................................................
        // aesmc V<ssa_27>.16b, V<ssa_12>.16b                    // ......*................................................................................................................
        // eor X<ssa_28>, X<ssa_24>, X<ssa_21>, lsl #1           // ...............*.......................................................................................................
        // extr X<ssa_29>, X<ssa_16>, X<ssa_21>, #63             // ........*..............................................................................................................
        // aese v25.16b, v16.16b                                 // *......................................................................................................................
        // aese V<ssa_20>.16b, v12.16b                           // ...........*...........................................................................................................
        // extr x22, X<ssa_29>, X<ssa_29>, #32                   // .........*.............................................................................................................
        // aese V<ssa_26>.16b, v12.16b                           // ............................................................*..........................................................
        // aese V<ssa_27>.16b, v12.16b                           // ........*..............................................................................................................
        // and W<ssa_30>, w19, w22, asr #31                      // ..........*............................................................................................................
        // aesmc V<ssa_31>.16b, v25.16b                          // ..*....................................................................................................................
        // aesmc V<ssa_32>.16b, V<ssa_20>.16b                    // .............*.........................................................................................................
        // aesmc V<ssa_34>.16b, V<ssa_26>.16b                    // ..............................................................*........................................................
        // aesmc V<ssa_35>.16b, V<ssa_27>.16b                    // ..........*............................................................................................................
        // aese V<ssa_32>.16b, v13.16b                           // ...............*.......................................................................................................
        // aese V<ssa_31>.16b, v17.16b                           // ....*..................................................................................................................
        // aese V<ssa_34>.16b, v13.16b                           // ................................................................*......................................................
        // aese V<ssa_35>.16b, v13.16b                           // ............*..........................................................................................................
        // aesmc V<ssa_36>.16b, V<ssa_31>.16b                    // ......*................................................................................................................
        // aesmc V<ssa_37>.16b, V<ssa_32>.16b                    // .................*.....................................................................................................
        // aesmc V<ssa_39>.16b, V<ssa_34>.16b                    // ..................................................................*....................................................
        // aesmc V<ssa_40>.16b, V<ssa_35>.16b                    // ..............*........................................................................................................
        // aese V<ssa_36>.16b, v12.16b                           // ........*..............................................................................................................
        // aese V<ssa_37>.16b, v14.16b                           // ...................*...................................................................................................
        // aese V<ssa_39>.16b, v14.16b                           // ....................................................................*..................................................
        // aese V<ssa_40>.16b, v14.16b                           // ................*......................................................................................................
        // aesmc V<ssa_41>.16b, V<ssa_36>.16b                    // ..........*............................................................................................................
        // aesmc V<ssa_42>.16b, V<ssa_37>.16b                    // .....................*.................................................................................................
        // aesmc V<ssa_44>.16b, V<ssa_39>.16b                    // ......................................................................*................................................
        // aesmc V<ssa_45>.16b, V<ssa_40>.16b                    // ..................*....................................................................................................
        // aese V<ssa_41>.16b, v13.16b                           // ............*..........................................................................................................
        // aese V<ssa_42>.16b, v15.16b                           // .......................*...............................................................................................
        // aese V<ssa_44>.16b, v15.16b                           // ........................................................................*..............................................
        // aese V<ssa_45>.16b, v15.16b                           // ....................*..................................................................................................
        // aesmc V<ssa_46>.16b, V<ssa_41>.16b                    // ..............*........................................................................................................
        // aesmc V<ssa_47>.16b, V<ssa_42>.16b                    // .........................*.............................................................................................
        // aesmc V<ssa_48>.16b, V<ssa_44>.16b                    // ..........................................................................*............................................
        // aesmc V<ssa_50>.16b, V<ssa_45>.16b                    // ......................*................................................................................................
        // aese V<ssa_46>.16b, v14.16b                           // ................*......................................................................................................
        // aese V<ssa_47>.16b, v4.16b                            // ............................*..........................................................................................
        // aese V<ssa_48>.16b, v4.16b                            // ............................................................................*..........................................
        // aese V<ssa_50>.16b, v4.16b                            // ........................*..............................................................................................
        // aesmc V<ssa_51>.16b, V<ssa_46>.16b                    // ..................*....................................................................................................
        // aesmc V<ssa_52>.16b, V<ssa_47>.16b                    // ..............................*........................................................................................
        // aesmc V<ssa_53>.16b, V<ssa_50>.16b                    // ..........................*............................................................................................
        // aesmc V<ssa_55>.16b, V<ssa_48>.16b                    // ..............................................................................*........................................
        // aese V<ssa_51>.16b, v15.16b                           // ....................*..................................................................................................
        // aese V<ssa_52>.16b, v5.16b                            // ................................*......................................................................................
        // aese V<ssa_53>.16b, v5.16b                            // ............................*..........................................................................................
        // aese V<ssa_55>.16b, v5.16b                            // ................................................................................*......................................
        // aesmc V<ssa_56>.16b, V<ssa_52>.16b                    // ..................................*....................................................................................
        // aesmc V<ssa_57>.16b, V<ssa_51>.16b                    // ......................*................................................................................................
        // aesmc V<ssa_58>.16b, V<ssa_53>.16b                    // ..............................*........................................................................................
        // aesmc V<ssa_59>.16b, V<ssa_55>.16b                    // ..................................................................................*....................................
        // aese V<ssa_56>.16b, v18.16b                           // ....................................*..................................................................................
        // aese V<ssa_57>.16b, v4.16b                            // ........................*..............................................................................................
        // aese V<ssa_58>.16b, v18.16b                           // ................................*......................................................................................
        // aese V<ssa_59>.16b, v18.16b                           // ....................................................................................*..................................
        // aesmc V<ssa_61>.16b, V<ssa_56>.16b                    // ......................................*................................................................................
        // aesmc V<ssa_62>.16b, V<ssa_57>.16b                    // ..........................*............................................................................................
        // aesmc V<ssa_63>.16b, V<ssa_58>.16b                    // ..................................*....................................................................................
        // aesmc V<ssa_64>.16b, V<ssa_59>.16b                    // ......................................................................................*................................
        // aese V<ssa_61>.16b, v19.16b                           // ........................................*..............................................................................
        // aese V<ssa_62>.16b, v5.16b                            // ............................*..........................................................................................
        // aese V<ssa_63>.16b, v19.16b                           // ....................................*..................................................................................
        // aese V<ssa_64>.16b, v19.16b                           // ........................................................................................*..............................
        // aesmc V<ssa_66>.16b, V<ssa_62>.16b                    // ..............................*........................................................................................
        // aesmc V<ssa_67>.16b, V<ssa_61>.16b                    // ..........................................*............................................................................
        // aesmc V<ssa_69>.16b, V<ssa_64>.16b                    // ..........................................................................................*............................
        // aesmc V<ssa_70>.16b, V<ssa_63>.16b                    // ......................................*................................................................................
        // aese V<ssa_66>.16b, v18.16b                           // ................................*......................................................................................
        // aese V<ssa_67>.16b, v20.16b                           // ............................................*..........................................................................
        // aese V<ssa_69>.16b, v20.16b                           // ............................................................................................*..........................
        // aese V<ssa_70>.16b, v20.16b                           // ........................................*..............................................................................
        // aesmc V<ssa_71>.16b, V<ssa_66>.16b                    // ..................................*....................................................................................
        // aesmc V<ssa_72>.16b, V<ssa_67>.16b                    // ..............................................*........................................................................
        // aesmc V<ssa_74>.16b, V<ssa_70>.16b                    // ..........................................*............................................................................
        // aesmc V<ssa_75>.16b, V<ssa_69>.16b                    // ..............................................................................................*........................
        // aese V<ssa_71>.16b, v19.16b                           // ....................................*..................................................................................
        // aese V<ssa_72>.16b, v21.16b                           // ................................................*......................................................................
        // aese V<ssa_74>.16b, v21.16b                           // ............................................*..........................................................................
        // aese V<ssa_75>.16b, v21.16b                           // ................................................................................................*......................
        // aesmc V<ssa_76>.16b, V<ssa_71>.16b                    // ......................................*................................................................................
        // aesmc V<ssa_77>.16b, V<ssa_72>.16b                    // ..................................................*....................................................................
        // aesmc V<ssa_79>.16b, V<ssa_75>.16b                    // ..................................................................................................*....................
        // aesmc V<ssa_80>.16b, V<ssa_74>.16b                    // ..............................................*........................................................................
        // aese V<ssa_76>.16b, v20.16b                           // ........................................*..............................................................................
        // aese V<ssa_77>.16b, v22.16b                           // .....................................................*.................................................................
        // aese V<ssa_79>.16b, v22.16b                           // ......................................................................................................*................
        // aese V<ssa_80>.16b, v22.16b                           // ................................................*......................................................................
        // aesmc V<ssa_81>.16b, V<ssa_77>.16b                    // .......................................................*...............................................................
        // aesmc V<ssa_82>.16b, V<ssa_76>.16b                    // ..........................................*............................................................................
        // aesmc V<ssa_83>.16b, V<ssa_79>.16b                    // ........................................................................................................*..............
        // aesmc V<ssa_85>.16b, V<ssa_80>.16b                    // ..................................................*....................................................................
        // aese V<ssa_81>.16b, v23.16b                           // .........................................................*.............................................................
        // aese V<ssa_82>.16b, v21.16b                           // ............................................*..........................................................................
        // aese V<ssa_83>.16b, v23.16b                           // ..........................................................................................................*............
        // aese V<ssa_85>.16b, v23.16b                           // ....................................................*..................................................................
        // eor X<ssa_88>, X<ssa_30>, X<ssa_28>, lsl #1           // ................*......................................................................................................
        // eor V<ssa_89>.16B, V<ssa_81>.16B, v7.16B              // ...........................................................*...........................................................
        // aesmc V<ssa_90>.16b, V<ssa_82>.16b                    // ..............................................*........................................................................
        // eor V<ssa_91>.16B, V<ssa_85>.16B, v7.16B              // ......................................................*................................................................
        // eor V<ssa_92>.16B, V<ssa_83>.16B, v7.16B              // ............................................................................................................*..........
        // eor V<ssa_93>.16B, V<ssa_89>.16B, v9.16B              // .............................................................*.........................................................
        // fmov D<ssa_94>, X<ssa_21>                             // .......*...............................................................................................................
        // aese V<ssa_90>.16b, v22.16b                           // ................................................*......................................................................
        // extr X<ssa_95>, X<ssa_29>, X<ssa_28>, #63             // .......................................................*...............................................................
        // eor V<ssa_96>.16B, V<ssa_92>.16B, v6.16B              // ..............................................................................................................*........
        // fmov D<ssa_97>, X<ssa_7>                              // ..............*........................................................................................................
        // eor V<ssa_98>.16B, V<ssa_91>.16B, v8.16B              // ........................................................*..............................................................
        // fmov D<ssa_99>, X<ssa_13>                             // ..................................................*....................................................................
        // aesmc V<ssa_100>.16b, V<ssa_90>.16b                   // ..................................................*....................................................................
        // fmov V<ssa_94>.d[1], X<ssa_16>                        // ..........*............................................................................................................
        // fmov V<ssa_97>.d[1], X<ssa_1>                         // ..........................*............................................................................................
        // fmov V<ssa_99>.d[1], X<ssa_14>                        // .....................................................*.................................................................
        // aese V<ssa_100>.16b, v23.16b                          // ....................................................*..................................................................
        // aese v26.16b, v16.16b                                 // .*.....................................................................................................................
        // eor V<ssa_102>.16B, V<ssa_23>.16B, V<ssa_94>.16B      // .............*.........................................................................................................
        // eor V<ssa_103>.16B, V<ssa_100>.16B, v7.16B            // ......................................................*................................................................
        // ldp Q<ssa_104>, Q<ssa_105>, [X<ssa_15>, #-32]         // ..........................................................*............................................................
        // eor V<ssa_106>.16B, V<ssa_18>.16B, V<ssa_99>.16B      // .........................................................*.............................................................
        // eor V<ssa_107>.16B, V<ssa_17>.16B, V<ssa_97>.16B      // .............................*.........................................................................................
        // aesmc V<ssa_108>.16b, v26.16b                         // ...*...................................................................................................................
        // eor V<ssa_109>.16B, V<ssa_103>.16B, v10.16B           // ........................................................*..............................................................
        // extr X<ssa_110>, X<ssa_95>, X<ssa_88>, #63            // .............................................................*.........................................................
        // fmov d10, X<ssa_28>                                   // ........................................................*..............................................................
        // aese V<ssa_102>.16b, v16.16b                          // ...............*.......................................................................................................
        // extr x22, X<ssa_95>, X<ssa_95>, #32                   // ...........................................................*...........................................................
        // and W<ssa_111>, w19, w22, asr #31                     // ............................................................*..........................................................
        // aese V<ssa_107>.16b, v16.16b                          // ...............................*.......................................................................................
        // aese V<ssa_108>.16b, v17.16b                          // .....*.................................................................................................................
        // aese V<ssa_106>.16b, v16.16b                          // ..............................................................*........................................................
        // subs X<ssa_112>, x2, #0x50                            // .*.....................................................................................................................
        // extr x22, X<ssa_110>, X<ssa_110>, #32                 // ..............................................................*........................................................
        // stp Q<ssa_93>, Q<ssa_109>, [x1, #32]                  // ...............................................................*.......................................................
        // aesmc V<ssa_114>.16b, V<ssa_102>.16b                  // .................*.....................................................................................................
        // eor X<ssa_115>, X<ssa_111>, X<ssa_88>, lsl #1         // ...........................................................................................................*...........
        // csel X<ssa_116>, xzr, X<ssa_112>, gt                  // ...............*.......................................................................................................
        // and W<ssa_117>, w19, w22, asr #31                     // ..........................................................................................................*............
        // fmov v10.d[1], X<ssa_29>                              // ...........................................................*...........................................................
        // aesmc V<ssa_118>.16b, V<ssa_107>.16b                  // .................................*.....................................................................................
        // aesmc V<ssa_119>.16b, V<ssa_108>.16b                  // .........*.............................................................................................................
        // aesmc V<ssa_120>.16b, V<ssa_106>.16b                  // ................................................................*......................................................
        // eor X<ssa_121>, X<ssa_117>, X<ssa_115>, lsl #1        // ............................................................................................................*..........
        // extr X<ssa_122>, X<ssa_110>, X<ssa_115>, #63          // ............................................................................................................*..........
        // add x0, X<ssa_15>, X<ssa_116>                         // ........................*..............................................................................................
        // aese V<ssa_114>.16b, v17.16b                          // ...................*...................................................................................................
        // extr X<ssa_123>, X<ssa_122>, X<ssa_121>, #63          // ................................................................................................................*......
        // stp Q<ssa_96>, Q<ssa_98>, [x1], #0x50                 // ................................................................................................................*......
        // extr x22, X<ssa_122>, X<ssa_122>, #32                 // .............................................................................................................*.........
        // aese V<ssa_119>.16b, v12.16b                          // ...........*...........................................................................................................
        // aese V<ssa_118>.16b, v17.16b                          // ...................................*...................................................................................
        // aese V<ssa_120>.16b, v17.16b                          // ..................................................................*....................................................
        // ldp Q<ssa_124>, Q<ssa_125>, [x0], #0x50               // ...............................................................................................................*.......
        // and W<ssa_126>, w19, w22, asr #31                     // ..............................................................................................................*........
        // extr x22, X<ssa_123>, X<ssa_123>, #32                 // ..................................................................................................................*....
        // aesmc V<ssa_127>.16b, V<ssa_114>.16b                  // .....................*.................................................................................................
        // eor X<ssa_128>, X<ssa_126>, X<ssa_121>, lsl #1        // ...............................................................................................................*.......
        // eor V<ssa_129>.16B, V<ssa_104>.16B, v10.16B           // ..............................................................*........................................................
        // ldr Q<ssa_130>, [x0, #-48]                            // ..................................................................................................................*....
        // and W<ssa_131>, w19, w22, asr #31                     // ...................................................................................................................*...
        // aesmc V<ssa_132>.16b, V<ssa_119>.16b                  // .............*.........................................................................................................
        // aesmc V<ssa_133>.16b, V<ssa_118>.16b                  // .....................................*.................................................................................
        // aesmc V<ssa_134>.16b, V<ssa_120>.16b                  // ....................................................................*..................................................
        // eor x12, X<ssa_131>, X<ssa_128>, lsl #1               // .....................................................................................................................*.
        // extr x17, X<ssa_123>, X<ssa_128>, #63                 // ...................................................................................................................*...
        // aese V<ssa_129>.16b, v16.16b                          // ................................................................*......................................................
        // aese V<ssa_127>.16b, v12.16b                          // .......................*...............................................................................................
        // extr x22, x17, x17, #32                               // ....................................................................................................................*..
        // aese V<ssa_132>.16b, v13.16b                          // ...............*.......................................................................................................
        // aese V<ssa_133>.16b, v12.16b                          // .......................................*...............................................................................
        // aese V<ssa_134>.16b, v12.16b                          // ......................................................................*................................................
        // and W<ssa_135>, w19, w22, asr #31                     // .....................................................................................................................*.
        // aesmc V<ssa_136>.16b, V<ssa_129>.16b                  // ..................................................................*....................................................
        // aesmc V<ssa_137>.16b, V<ssa_127>.16b                  // .........................*.............................................................................................
        // aesmc V<ssa_138>.16b, V<ssa_132>.16b                  // .................*.....................................................................................................
        // aesmc V<ssa_139>.16b, V<ssa_133>.16b                  // .........................................*.............................................................................
        // aesmc V<ssa_140>.16b, V<ssa_134>.16b                  // ........................................................................*..............................................
        // aese V<ssa_137>.16b, v13.16b                          // ...........................*...........................................................................................
        // aese V<ssa_136>.16b, v17.16b                          // ....................................................................*..................................................
        // aese V<ssa_138>.16b, v14.16b                          // ...................*...................................................................................................
        // aese V<ssa_139>.16b, v13.16b                          // ...........................................*...........................................................................
        // aese V<ssa_140>.16b, v13.16b                          // ..........................................................................*............................................
        // aesmc V<ssa_141>.16b, V<ssa_136>.16b                  // ......................................................................*................................................
        // aesmc V<ssa_142>.16b, V<ssa_137>.16b                  // .............................*.........................................................................................
        // aesmc V<ssa_143>.16b, V<ssa_138>.16b                  // .....................*.................................................................................................
        // aesmc V<ssa_144>.16b, V<ssa_139>.16b                  // .............................................*.........................................................................
        // aesmc V<ssa_145>.16b, V<ssa_140>.16b                  // ............................................................................*..........................................
        // aese V<ssa_141>.16b, v12.16b                          // ........................................................................*..............................................
        // aese V<ssa_142>.16b, v14.16b                          // ...............................*.......................................................................................
        // aese V<ssa_143>.16b, v15.16b                          // .......................*...............................................................................................
        // aese V<ssa_144>.16b, v14.16b                          // ...............................................*.......................................................................
        // aese V<ssa_145>.16b, v14.16b                          // ..............................................................................*........................................
        // aesmc V<ssa_146>.16b, V<ssa_141>.16b                  // ..........................................................................*............................................
        // aesmc V<ssa_147>.16b, V<ssa_142>.16b                  // .................................*.....................................................................................
        // aesmc V<ssa_148>.16b, V<ssa_143>.16b                  // .........................*.............................................................................................
        // aesmc V<ssa_149>.16b, V<ssa_144>.16b                  // .................................................*.....................................................................
        // aesmc V<ssa_150>.16b, V<ssa_145>.16b                  // ................................................................................*......................................
        // aese V<ssa_146>.16b, v13.16b                          // ............................................................................*..........................................
        // aese V<ssa_147>.16b, v15.16b                          // ...................................*...................................................................................
        // aese V<ssa_148>.16b, v4.16b                           // ...............................*.......................................................................................
        // aese V<ssa_149>.16b, v15.16b                          // ...................................................*...................................................................
        // aese V<ssa_150>.16b, v15.16b                          // ..................................................................................*....................................
        // aesmc V<ssa_151>.16b, V<ssa_146>.16b                  // ..............................................................................*........................................
        // aesmc V<ssa_152>.16b, V<ssa_147>.16b                  // .....................................*.................................................................................
        // aesmc V<ssa_153>.16b, V<ssa_149>.16b                  // .....................................................*.................................................................
        // aesmc V<ssa_154>.16b, V<ssa_148>.16b                  // ...................................*...................................................................................
        // aesmc V<ssa_155>.16b, V<ssa_150>.16b                  // ....................................................................................*..................................
        // aese V<ssa_151>.16b, v14.16b                          // ................................................................................*......................................
        // aese V<ssa_152>.16b, v4.16b                           // .......................................*...............................................................................
        // aese V<ssa_153>.16b, v4.16b                           // .......................................................*...............................................................
        // aese V<ssa_154>.16b, v5.16b                           // .....................................*.................................................................................
        // aese V<ssa_155>.16b, v4.16b                           // ......................................................................................*................................
        // aesmc V<ssa_156>.16b, V<ssa_151>.16b                  // ..................................................................................*....................................
        // aesmc V<ssa_157>.16b, V<ssa_152>.16b                  // .........................................*.............................................................................
        // aesmc V<ssa_158>.16b, V<ssa_155>.16b                  // ........................................................................................*..............................
        // aesmc V<ssa_159>.16b, V<ssa_154>.16b                  // .......................................*...............................................................................
        // aesmc V<ssa_160>.16b, V<ssa_153>.16b                  // .........................................................*.............................................................
        // aese V<ssa_156>.16b, v15.16b                          // ....................................................................................*..................................
        // aese V<ssa_157>.16b, v5.16b                           // ...........................................*...........................................................................
        // aese V<ssa_158>.16b, v5.16b                           // ..........................................................................................*............................
        // aese V<ssa_159>.16b, v18.16b                          // .........................................*.............................................................................
        // aese V<ssa_160>.16b, v5.16b                           // ...........................................................*...........................................................
        // aesmc V<ssa_161>.16b, V<ssa_157>.16b                  // .............................................*.........................................................................
        // aesmc V<ssa_162>.16b, V<ssa_156>.16b                  // ......................................................................................*................................
        // aesmc V<ssa_163>.16b, V<ssa_158>.16b                  // ............................................................................................*..........................
        // aesmc V<ssa_164>.16b, V<ssa_160>.16b                  // ...............................................................*.......................................................
        // aesmc V<ssa_165>.16b, V<ssa_159>.16b                  // ...........................................*...........................................................................
        // aese V<ssa_161>.16b, v18.16b                          // ...............................................*.......................................................................
        // aese V<ssa_162>.16b, v4.16b                           // ........................................................................................*..............................
        // aese V<ssa_163>.16b, v18.16b                          // ..............................................................................................*........................
        // aese V<ssa_164>.16b, v18.16b                          // .................................................................*.....................................................
        // aese V<ssa_165>.16b, v19.16b                          // .............................................*.........................................................................
        // aesmc V<ssa_166>.16b, V<ssa_161>.16b                  // .................................................*.....................................................................
        // aesmc V<ssa_167>.16b, V<ssa_162>.16b                  // ..........................................................................................*............................
        // aesmc V<ssa_168>.16b, V<ssa_163>.16b                  // ................................................................................................*......................
        // aesmc V<ssa_169>.16b, V<ssa_164>.16b                  // ...................................................................*...................................................
        // aesmc V<ssa_170>.16b, V<ssa_165>.16b                  // .................................................*.....................................................................
        // aese V<ssa_166>.16b, v19.16b                          // ....................................................*..................................................................
        // aese V<ssa_167>.16b, v5.16b                           // ............................................................................................*..........................
        // aese V<ssa_168>.16b, v19.16b                          // ..................................................................................................*....................
        // aese V<ssa_170>.16b, v20.16b                          // ...................................................*...................................................................
        // aese V<ssa_169>.16b, v19.16b                          // .....................................................................*.................................................
        // aesmc V<ssa_171>.16b, V<ssa_167>.16b                  // ..............................................................................................*........................
        // aesmc V<ssa_172>.16b, V<ssa_166>.16b                  // ..........................................................*............................................................
        // aesmc V<ssa_173>.16b, V<ssa_170>.16b                  // .....................................................*.................................................................
        // aesmc V<ssa_174>.16b, V<ssa_169>.16b                  // .......................................................................*...............................................
        // aesmc V<ssa_175>.16b, V<ssa_168>.16b                  // ....................................................................................................*..................
        // aese V<ssa_171>.16b, v18.16b                          // ................................................................................................*......................
        // aese V<ssa_172>.16b, v20.16b                          // .............................................................*.........................................................
        // aese V<ssa_173>.16b, v21.16b                          // ............................................................*..........................................................
        // aese V<ssa_174>.16b, v20.16b                          // .........................................................................*.............................................
        // aese V<ssa_175>.16b, v20.16b                          // ......................................................................................................*................
        // aesmc V<ssa_176>.16b, V<ssa_171>.16b                  // ..................................................................................................*....................
        // aesmc V<ssa_177>.16b, V<ssa_172>.16b                  // .................................................................*.....................................................
        // aesmc V<ssa_178>.16b, V<ssa_173>.16b                  // ..............................................................*........................................................
        // aesmc V<ssa_179>.16b, V<ssa_175>.16b                  // ........................................................................................................*..............
        // aesmc V<ssa_180>.16b, V<ssa_174>.16b                  // ............................................................................*..........................................
        // aese V<ssa_176>.16b, v19.16b                          // ....................................................................................................*..................
        // aese V<ssa_177>.16b, v21.16b                          // ...................................................................*...................................................
        // aese V<ssa_178>.16b, v22.16b                          // ................................................................*......................................................
        // aese V<ssa_179>.16b, v21.16b                          // ..........................................................................................................*............
        // aese V<ssa_180>.16b, v21.16b                          // ..............................................................................*........................................
        // aesmc V<ssa_181>.16b, V<ssa_176>.16b                  // ......................................................................................................*................
        // aesmc V<ssa_182>.16b, V<ssa_177>.16b                  // .....................................................................*.................................................
        // aesmc V<ssa_183>.16b, V<ssa_178>.16b                  // ..................................................................*....................................................
        // aesmc V<ssa_184>.16b, V<ssa_180>.16b                  // ................................................................................*......................................
        // aesmc V<ssa_185>.16b, V<ssa_179>.16b                  // ............................................................................................................*..........
        // aese V<ssa_181>.16b, v20.16b                          // ........................................................................................................*..............
        // aese V<ssa_182>.16b, v22.16b                          // .......................................................................*...............................................
        // aese V<ssa_183>.16b, v23.16b                          // ....................................................................*..................................................
        // aese V<ssa_184>.16b, v22.16b                          // ...................................................................................*...................................
        // aese V<ssa_185>.16b, v22.16b                          // ..............................................................................................................*........
        // aesmc V<ssa_186>.16b, V<ssa_182>.16b                  // ...........................................................................*...........................................
        // aesmc V<ssa_187>.16b, V<ssa_181>.16b                  // ..........................................................................................................*............
        // aesmc V<ssa_188>.16b, V<ssa_184>.16b                  // .....................................................................................*.................................
        // eor V<ssa_189>.16B, V<ssa_183>.16B, v7.16B            // ..........................................................................*............................................
        // aesmc V<ssa_190>.16b, V<ssa_185>.16b                  // ................................................................................................................*......
        // aese V<ssa_186>.16b, v23.16b                          // .............................................................................*.........................................
        // aese V<ssa_187>.16b, v21.16b                          // ............................................................................................................*..........
        // aese V<ssa_188>.16b, v23.16b                          // ........................................................................................*..............................
        // eor v29.16B, V<ssa_189>.16B, v11.16B                  // .......................................................................................................*...............
        // aese V<ssa_190>.16b, v23.16b                          // ..................................................................................................................*....
        // fmov d11, X<ssa_88>                                   // .......................................................................................................*...............
        // eor x9, X<ssa_135>, x12, lsl #1                       // ......................................................................................................................*
        // eor V<ssa_191>.16B, V<ssa_186>.16B, v7.16B            // ...................................................................................................*...................
        // aesmc V<ssa_192>.16b, V<ssa_187>.16b                  // ..............................................................................................................*........
        // eor V<ssa_193>.16B, V<ssa_190>.16B, v7.16B            // ....................................................................................................................*..
        // eor V<ssa_194>.16B, V<ssa_188>.16B, v7.16B            // .................................................................................................................*.....
        // eor v28.16B, V<ssa_191>.16B, V<ssa_94>.16B            // .........................................................................................................*.............
        // fmov d9, X<ssa_128>                                   // ................................................................................................................*......
        // fmov v11.d[1], X<ssa_95>                              // ..........................................................................................................*............
        // aese V<ssa_192>.16b, v22.16b                          // ................................................................................................................*......
        // extr x10, x17, x12, #63                               // ......................................................................................................................*
        // eor v25.16B, V<ssa_194>.16B, V<ssa_97>.16B            // ....................................................................................................................*..
        // fmov d6, X<ssa_115>                                   // ..............................................................................................................*........
        // eor v31.16B, V<ssa_193>.16B, V<ssa_99>.16B            // ......................................................................................................................*
        // fmov d8, X<ssa_121>                                   // .............................................................................................................*.........
        // aesmc V<ssa_195>.16b, V<ssa_192>.16b                  // ..................................................................................................................*....
        // fmov v9.d[1], X<ssa_123>                              // ...................................................................................................................*...
        // eor V<ssa_196>.16B, V<ssa_105>.16B, v11.16B           // .............................................................................................................*.........
        // fmov v6.d[1], X<ssa_110>                              // .................................................................................................................*.....
        // fmov v8.d[1], X<ssa_122>                              // ...................................................................................................................*...
        // aese V<ssa_195>.16b, v23.16b                          // ....................................................................................................................*..
        // aese V<ssa_196>.16b, v16.16b                          // ...............................................................................................................*.......
        // eor v24.16B, V<ssa_130>.16B, v9.16B                   // ......................................................................................................................*
        // eor v3.16B, V<ssa_195>.16B, v7.16B                    // ......................................................................................................................*
        // ldp q2, q30, [x0, #-32]                               // .....................................................................................................................*.
        // eor v1.16B, V<ssa_125>.16B, v8.16B                    // ......................................................................................................................*
        // eor v0.16B, V<ssa_124>.16B, v6.16B                    // .....................................................................................................................*.
        // aesmc v27.16b, V<ssa_196>.16b                         // .................................................................................................................*.....

        sub x2, x2, #160
Loop5x_xts_enc:
                                             // Instructions:    189
                                             // Expected cycles: 64
                                             // Expected IPC:    2.95
                                             //
                                             // Cycle bound:     64.0
                                             // IPC bound:       2.95
                                             //
                                             // Wall time:     61.75s
                                             // User time:     61.75s
                                             //
                                             // ---------------------- cycle (expected) ----------------------->
                                             // 0                        25                       50
                                             // |------------------------|------------------------|-------------
        eor v3.16B, v3.16B, v10.16B          // *...............................................................
        extr x8, x10, x9, #63                // e...............................................................
        fmov d10, x12                        // *...............................................................
        aese v24.16b, v16.16b                // e...............................................................
        extr x22, x10, x10, #32              // e...............................................................
        and w14, w19, w22, asr #31           // .e..............................................................
        aese v0.16b, v16.16b                 // .e..............................................................
        aese v27.16b, v17.16b                // .*..............................................................
        aese v1.16b, v16.16b                 // .e..............................................................
        subs x6, x2, #0x50                   // .e..............................................................
        extr x22, x8, x8, #32                // .e..............................................................
        stp q28, q3, [x1, #32]               // ..*.............................................................
        aesmc v28.16b, v24.16b               // ..e.............................................................
        eor x3, x14, x9, lsl #1              // ..e.............................................................
        str q29, [x1, #-16]                  // ..l.............................................................
        csel x11, xzr, x6, gt                // ..e.............................................................
        and w13, w19, w22, asr #31           // ..e.............................................................
        fmov v10.d[1], x17                   // ...*............................................................
        aesmc v26.16b, v0.16b                // ...e............................................................
        aesmc v24.16b, v27.16b               // ...*............................................................
        aesmc v29.16b, v1.16b                // ...e............................................................
        eor x13, x13, x3, lsl #1             // ...e............................................................
        extr x4, x8, x3, #63                 // ...e............................................................
        add x0, x0, x11                      // ....e...........................................................
        aese v28.16b, v17.16b                // ....e...........................................................
        extr x11, x4, x13, #63               // ....e...........................................................
        stp q25, q31, [x1], #0x50            // ....*...........................................................
        extr x22, x4, x4, #32                // ....e...........................................................
        aese v24.16b, v12.16b                // .....*..........................................................
        aese v26.16b, v17.16b                // .....e..........................................................
        aese v29.16b, v17.16b                // .....e..........................................................
        ldp q0, q27, [x0], #0x50             // .....e..........................................................
        and w6, w19, w22, asr #31            // .....e..........................................................
        extr x22, x11, x11, #32              // .....e..........................................................
        aesmc v31.16b, v28.16b               // ......e.........................................................
        eor x6, x6, x13, lsl #1              // ......e.........................................................
        eor v25.16B, v2.16B, v10.16B         // ......*.........................................................
        ldr q2, [x0, #-48]                   // ......e.........................................................
        and w16, w19, w22, asr #31           // ......e.........................................................
        aesmc v24.16b, v24.16b               // .......*........................................................
        aesmc v1.16b, v26.16b                // .......e........................................................
        aesmc v3.16b, v29.16b                // .......e........................................................
        eor x12, x16, x6, lsl #1             // .......e........................................................
        extr x17, x11, x6, #63               // .......e........................................................
        aese v25.16b, v16.16b                // ........e.......................................................
        aese v31.16b, v12.16b                // ........e.......................................................
        extr x22, x17, x17, #32              // ........e.......................................................
        aese v24.16b, v13.16b                // .........*......................................................
        aese v1.16b, v12.16b                 // .........e......................................................
        aese v3.16b, v12.16b                 // .........e......................................................
        and w14, w19, w22, asr #31           // .........e......................................................
        aesmc v29.16b, v25.16b               // ..........e.....................................................
        aesmc v25.16b, v31.16b               // ..........e.....................................................
        aesmc v28.16b, v24.16b               // ...........*....................................................
        aesmc v26.16b, v1.16b                // ...........e....................................................
        aesmc v3.16b, v3.16b                 // ...........e....................................................
        aese v25.16b, v13.16b                // ............e...................................................
        aese v29.16b, v17.16b                // ............e...................................................
        aese v28.16b, v14.16b                // .............*..................................................
        aese v26.16b, v13.16b                // .............e..................................................
        aese v3.16b, v13.16b                 // .............e..................................................
        aesmc v24.16b, v29.16b               // ..............e.................................................
        aesmc v1.16b, v25.16b                // ..............e.................................................
        aesmc v25.16b, v28.16b               // ...............*................................................
        aesmc v26.16b, v26.16b               // ...............e................................................
        aesmc v28.16b, v3.16b                // ...............e................................................
        aese v24.16b, v12.16b                // ................e...............................................
        aese v1.16b, v14.16b                 // ................e...............................................
        aese v25.16b, v15.16b                // .................*..............................................
        aese v26.16b, v14.16b                // .................e..............................................
        aese v28.16b, v14.16b                // .................e..............................................
        aesmc v29.16b, v24.16b               // ..................e.............................................
        aesmc v31.16b, v1.16b                // ..................e.............................................
        aesmc v1.16b, v25.16b                // ...................*............................................
        aesmc v3.16b, v26.16b                // ...................e............................................
        aesmc v26.16b, v28.16b               // ...................e............................................
        aese v29.16b, v13.16b                // ....................e...........................................
        aese v31.16b, v15.16b                // ....................e...........................................
        aese v1.16b, v4.16b                  // .....................*..........................................
        aese v3.16b, v15.16b                 // .....................e..........................................
        aese v26.16b, v15.16b                // .....................e..........................................
        aesmc v28.16b, v29.16b               // ......................e.........................................
        aesmc v24.16b, v31.16b               // ......................e.........................................
        aesmc v31.16b, v3.16b                // .......................e........................................
        aesmc v25.16b, v1.16b                // .......................*........................................
        aesmc v1.16b, v26.16b                // .......................e........................................
        aese v28.16b, v14.16b                // ........................e.......................................
        aese v24.16b, v4.16b                 // ........................e.......................................
        aese v31.16b, v4.16b                 // .........................e......................................
        aese v25.16b, v5.16b                 // .........................*......................................
        aese v1.16b, v4.16b                  // .........................e......................................
        aesmc v29.16b, v28.16b               // ..........................e.....................................
        aesmc v26.16b, v24.16b               // ..........................e.....................................
        aesmc v1.16b, v1.16b                 // ...........................e....................................
        aesmc v3.16b, v25.16b                // ...........................*....................................
        aesmc v24.16b, v31.16b               // ...........................e....................................
        aese v29.16b, v15.16b                // ............................e...................................
        aese v26.16b, v5.16b                 // ............................e...................................
        aese v1.16b, v5.16b                  // .............................e..................................
        aese v3.16b, v18.16b                 // .............................*..................................
        aese v24.16b, v5.16b                 // .............................e..................................
        aesmc v25.16b, v26.16b               // ..............................e.................................
        aesmc v28.16b, v29.16b               // ..............................e.................................
        aesmc v1.16b, v1.16b                 // ...............................e................................
        aesmc v31.16b, v24.16b               // ...............................e................................
        aesmc v3.16b, v3.16b                 // ...............................*................................
        aese v25.16b, v18.16b                // ................................e...............................
        aese v28.16b, v4.16b                 // ................................e...............................
        aese v1.16b, v18.16b                 // .................................e..............................
        aese v31.16b, v18.16b                // .................................e..............................
        aese v3.16b, v19.16b                 // .................................*..............................
        aesmc v29.16b, v25.16b               // ..................................e.............................
        aesmc v28.16b, v28.16b               // ..................................e.............................
        aesmc v24.16b, v1.16b                // ...................................e............................
        aesmc v26.16b, v31.16b               // ...................................e............................
        aesmc v25.16b, v3.16b                // ...................................*............................
        aese v29.16b, v19.16b                // ....................................e...........................
        aese v28.16b, v5.16b                 // ....................................e...........................
        aese v24.16b, v19.16b                // .....................................e..........................
        aese v25.16b, v20.16b                // .....................................*..........................
        aese v26.16b, v19.16b                // .....................................e..........................
        aesmc v28.16b, v28.16b               // ......................................e.........................
        aesmc v29.16b, v29.16b               // ......................................e.........................
        aesmc v3.16b, v25.16b                // .......................................*........................
        aesmc v31.16b, v26.16b               // .......................................e........................
        aesmc v24.16b, v24.16b               // .......................................e........................
        aese v28.16b, v18.16b                // ........................................e.......................
        aese v29.16b, v20.16b                // ........................................e.......................
        aese v3.16b, v21.16b                 // .........................................*......................
        aese v31.16b, v20.16b                // .........................................e......................
        aese v24.16b, v20.16b                // .........................................e......................
        aesmc v26.16b, v28.16b               // ..........................................e.....................
        aesmc v29.16b, v29.16b               // ..........................................e.....................
        aesmc v3.16b, v3.16b                 // ...........................................*....................
        aesmc v1.16b, v24.16b                // ...........................................e....................
        aesmc v28.16b, v31.16b               // ...........................................e....................
        aese v26.16b, v19.16b                // ............................................e...................
        aese v29.16b, v21.16b                // ............................................e...................
        aese v3.16b, v22.16b                 // .............................................*..................
        aese v1.16b, v21.16b                 // .............................................e..................
        aese v28.16b, v21.16b                // .............................................e..................
        aesmc v24.16b, v26.16b               // ..............................................e.................
        aesmc v29.16b, v29.16b               // ..............................................e.................
        aesmc v31.16b, v3.16b                // ...............................................*................
        aesmc v26.16b, v28.16b               // ...............................................e................
        aesmc v25.16b, v1.16b                // ...............................................e................
        aese v24.16b, v20.16b                // ................................................e...............
        aese v29.16b, v22.16b                // ................................................e...............
        aese v31.16b, v23.16b                // .................................................*..............
        aese v26.16b, v22.16b                // .................................................e..............
        aese v25.16b, v22.16b                // .................................................e..............
        aesmc v28.16b, v29.16b               // ..................................................e.............
        aesmc v3.16b, v24.16b                // ..................................................e.............
        aesmc v24.16b, v26.16b               // ...................................................e............
        eor v26.16B, v31.16B, v7.16B         // ...................................................*............
        aesmc v25.16b, v25.16b               // ...................................................e............
        aese v28.16b, v23.16b                // ....................................................e...........
        aese v3.16b, v21.16b                 // ....................................................e...........
        aese v24.16b, v23.16b                // .....................................................e..........
        eor v29.16B, v26.16B, v11.16B        // .....................................................*..........
        aese v25.16b, v23.16b                // .....................................................e..........
        fmov d11, x9                         // .....................................................*..........
        eor x9, x14, x12, lsl #1             // .....................................................e..........
        eor v26.16B, v28.16B, v7.16B         // ......................................................e.........
        aesmc v3.16b, v3.16b                 // ......................................................e.........
        eor v31.16B, v25.16B, v7.16B         // .......................................................e........
        eor v24.16B, v24.16B, v7.16B         // .......................................................e........
        eor v28.16B, v26.16B, v9.16B         // ........................................................e.......
        fmov d9, x6                          // ........................................................e.......
        fmov v11.d[1], x10                   // ........................................................*.......
        aese v3.16b, v22.16b                 // ........................................................e.......
        extr x10, x17, x12, #63              // ........................................................e.......
        eor v25.16B, v24.16B, v6.16B         // .........................................................e......
        fmov d6, x3                          // .........................................................e......
        eor v31.16B, v31.16B, v8.16B         // .........................................................e......
        fmov d8, x13                         // .........................................................e......
        aesmc v1.16b, v3.16b                 // ..........................................................e.....
        fmov v9.d[1], x11                    // ...........................................................e....
        eor v26.16B, v30.16B, v11.16B        // ...........................................................*....
        fmov v6.d[1], x8                     // ............................................................e...
        fmov v8.d[1], x4                     // ............................................................e...
        aese v1.16b, v23.16b                 // ............................................................e...
        aese v26.16b, v16.16b                // .............................................................e..
        eor v24.16B, v2.16B, v9.16B          // ..............................................................e.
        eor v3.16B, v1.16B, v7.16B           // ..............................................................e.
        ldp q2, q30, [x0, #-32]              // ..............................................................e.
        eor v1.16B, v27.16B, v8.16B          // ...............................................................e
        eor v0.16B, v0.16B, v6.16B           // ...............................................................e
        aesmc v27.16b, v26.16b               // ...............................................................e

                                            // -------------------------------------------------------- cycle (expected) -------------------------------------------------------->
                                            // 0                        25                       50                       75                       100                      125
                                            // |------------------------|------------------------|------------------------|------------------------|------------------------|-----
        // aese v0.16b,v16.16b              // .e..............................................................'~..............................................................'~.
        // aesmc v0.16b,v0.16b              // ...e............................................................'..~............................................................'..
        // aese v1.16b,v16.16b              // .e..............................................................'~..............................................................'~.
        // aesmc v1.16b,v1.16b              // ...e............................................................'..~............................................................'..
        // aese v24.16b,v16.16b             // e...............................................................~...............................................................~..
        // aesmc v24.16b,v24.16b            // ..e.............................................................'.~.............................................................'..
        // aese v25.16b,v16.16b             // ........e.......................................................'.......~.......................................................'..
        // aesmc v25.16b,v25.16b            // ..........e.....................................................'.........~.....................................................'..
        // aese v26.16b,v16.16b             // .............................................................e..'............................................................~..'..
        // aesmc v26.16b,v26.16b            // ...............................................................e'..............................................................~'..
        // subs x12,x2,#0x50                // .e..............................................................'~..............................................................'~.
        // aese v0.16b,v17.16b              // .....e..........................................................'....~..........................................................'..
        // aesmc v0.16b,v0.16b              // .......e........................................................'......~........................................................'..
        // aese v1.16b,v17.16b              // .....e..........................................................'....~..........................................................'..
        // aesmc v1.16b,v1.16b              // .......e........................................................'......~........................................................'..
        // aese v24.16b,v17.16b             // ....e...........................................................'...~...........................................................'..
        // aesmc v24.16b,v24.16b            // ......e.........................................................'.....~.........................................................'..
        // aese v25.16b,v17.16b             // ............e...................................................'...........~...................................................'..
        // aesmc v25.16b,v25.16b            // ..............e.................................................'.............~.................................................'..
        // aese v26.16b,v17.16b             // .~..............................................................'*..............................................................'~.
        // aesmc v26.16b,v26.16b            // ...~............................................................'..*............................................................'..
        // csel x6,xzr,x12,gt               // ..e.............................................................'.~.............................................................'..
        // aese v0.16b,v12.16b              // .........e......................................................'........~......................................................'..
        // aesmc v0.16b,v0.16b              // ...........e....................................................'..........~....................................................'..
        // aese v1.16b,v12.16b              // .........e......................................................'........~......................................................'..
        // aesmc v1.16b,v1.16b              // ...........e....................................................'..........~....................................................'..
        // aese v24.16b,v12.16b             // ........e.......................................................'.......~.......................................................'..
        // aesmc v24.16b,v24.16b            // ..........e.....................................................'.........~.....................................................'..
        // aese v25.16b,v12.16b             // ................e...............................................'...............~...............................................'..
        // aesmc v25.16b,v25.16b            // ..................e.............................................'.................~.............................................'..
        // aese v26.16b,v12.16b             // .....~..........................................................'....*..........................................................'..
        // aesmc v26.16b,v26.16b            // .......~........................................................'......*........................................................'..
        // aese v0.16b,v13.16b              // .............e..................................................'............~..................................................'..
        // aesmc v0.16b,v0.16b              // ...............e................................................'..............~................................................'..
        // aese v1.16b,v13.16b              // .............e..................................................'............~..................................................'..
        // aesmc v1.16b,v1.16b              // ...............e................................................'..............~................................................'..
        // aese v24.16b,v13.16b             // ............e...................................................'...........~...................................................'..
        // aesmc v24.16b,v24.16b            // ..............e.................................................'.............~.................................................'..
        // aese v25.16b,v13.16b             // ....................e...........................................'...................~...........................................'..
        // aesmc v25.16b,v25.16b            // ......................e.........................................'.....................~.........................................'..
        // aese v26.16b,v13.16b             // .........~......................................................'........*......................................................'..
        // aesmc v26.16b,v26.16b            // ...........~....................................................'..........*....................................................'..
        // aese v0.16b,v14.16b              // .................e..............................................'................~..............................................'..
        // aesmc v0.16b,v0.16b              // ...................e............................................'..................~............................................'..
        // aese v1.16b,v14.16b              // .................e..............................................'................~..............................................'..
        // aesmc v1.16b,v1.16b              // ...................e............................................'..................~............................................'..
        // aese v24.16b,v14.16b             // ................e...............................................'...............~...............................................'..
        // aesmc v24.16b,v24.16b            // ..................e.............................................'.................~.............................................'..
        // aese v25.16b,v14.16b             // ........................e.......................................'.......................~.......................................'..
        // aesmc v25.16b,v25.16b            // ..........................e.....................................'.........................~.....................................'..
        // aese v26.16b,v14.16b             // .............~..................................................'............*..................................................'..
        // aesmc v26.16b,v26.16b            // ...............~................................................'..............*................................................'..
        // aese v0.16b,v15.16b              // .....................e..........................................'....................~..........................................'..
        // aesmc v0.16b,v0.16b              // .......................e........................................'......................~........................................'..
        // aese v1.16b,v15.16b              // .....................e..........................................'....................~..........................................'..
        // aesmc v1.16b,v1.16b              // .......................e........................................'......................~........................................'..
        // aese v24.16b,v15.16b             // ....................e...........................................'...................~...........................................'..
        // aesmc v24.16b,v24.16b            // ......................e.........................................'.....................~.........................................'..
        // aese v25.16b,v15.16b             // ............................e...................................'...........................~...................................'..
        // aesmc v25.16b,v25.16b            // ..............................e.................................'.............................~.................................'..
        // aese v26.16b,v15.16b             // .................~..............................................'................*..............................................'..
        // aesmc v26.16b,v26.16b            // ...................~............................................'..................*............................................'..
        // aese v0.16b,v4.16b               // .........................e......................................'........................~......................................'..
        // aesmc v0.16b,v0.16b              // ...........................e....................................'..........................~....................................'..
        // aese v1.16b,v4.16b               // .........................e......................................'........................~......................................'..
        // aesmc v1.16b,v1.16b              // ...........................e....................................'..........................~....................................'..
        // aese v24.16b,v4.16b              // ........................e.......................................'.......................~.......................................'..
        // aesmc v24.16b,v24.16b            // ..........................e.....................................'.........................~.....................................'..
        // aese v25.16b,v4.16b              // ................................e...............................'...............................~...............................'..
        // aesmc v25.16b,v25.16b            // ..................................e.............................'.................................~.............................'..
        // aese v26.16b,v4.16b              // .....................~..........................................'....................*..........................................'..
        // aesmc v26.16b,v26.16b            // .......................~........................................'......................*........................................'..
        // aese v0.16b,v5.16b               // .............................e..................................'............................~..................................'..
        // aesmc v0.16b,v0.16b              // ...............................e................................'..............................~................................'..
        // aese v1.16b,v5.16b               // .............................e..................................'............................~..................................'..
        // aesmc v1.16b,v1.16b              // ...............................e................................'..............................~................................'..
        // aese v24.16b,v5.16b              // ............................e...................................'...........................~...................................'..
        // aesmc v24.16b,v24.16b            // ..............................e.................................'.............................~.................................'..
        // aese v25.16b,v5.16b              // ....................................e...........................'...................................~...........................'..
        // aesmc v25.16b,v25.16b            // ......................................e.........................'.....................................~.........................'..
        // aese v26.16b,v5.16b              // .........................~......................................'........................*......................................'..
        // aesmc v26.16b,v26.16b            // ...........................~....................................'..........................*....................................'..
        // aese v0.16b,v18.16b              // .................................e..............................'................................~..............................'..
        // aesmc v0.16b,v0.16b              // ...................................e............................'..................................~............................'..
        // aese v1.16b,v18.16b              // .................................e..............................'................................~..............................'..
        // aesmc v1.16b,v1.16b              // ...................................e............................'..................................~............................'..
        // aese v24.16b,v18.16b             // ................................e...............................'...............................~...............................'..
        // aesmc v24.16b,v24.16b            // ..................................e.............................'.................................~.............................'..
        // aese v25.16b,v18.16b             // ........................................e.......................'.......................................~.......................'..
        // aesmc v25.16b,v25.16b            // ..........................................e.....................'.........................................~.....................'..
        // aese v26.16b,v18.16b             // .............................~..................................'............................*..................................'..
        // aesmc v26.16b,v26.16b            // ...............................~................................'..............................*................................'..
        // add x0,x0,x6                     // ....e...........................................................'...~...........................................................'..
        // aese v0.16b,v19.16b              // .....................................e..........................'....................................~..........................'..
        // aesmc v0.16b,v0.16b              // .......................................e........................'......................................~........................'..
        // aese v1.16b,v19.16b              // .....................................e..........................'....................................~..........................'..
        // aesmc v1.16b,v1.16b              // .......................................e........................'......................................~........................'..
        // aese v24.16b,v19.16b             // ....................................e...........................'...................................~...........................'..
        // aesmc v24.16b,v24.16b            // ......................................e.........................'.....................................~.........................'..
        // aese v25.16b,v19.16b             // ............................................e...................'...........................................~...................'..
        // aesmc v25.16b,v25.16b            // ..............................................e.................'.............................................~.................'..
        // aese v26.16b,v19.16b             // .................................~..............................'................................*..............................'..
        // aesmc v26.16b,v26.16b            // ...................................~............................'..................................*............................'..
        // aese v0.16b,v20.16b              // .........................................e......................'........................................~......................'..
        // aesmc v0.16b,v0.16b              // ...........................................e....................'..........................................~....................'..
        // aese v1.16b,v20.16b              // .........................................e......................'........................................~......................'..
        // aesmc v1.16b,v1.16b              // ...........................................e....................'..........................................~....................'..
        // aese v24.16b,v20.16b             // ........................................e.......................'.......................................~.......................'..
        // aesmc v24.16b,v24.16b            // ..........................................e.....................'.........................................~.....................'..
        // aese v25.16b,v20.16b             // ................................................e...............'...............................................~...............'..
        // aesmc v25.16b,v25.16b            // ..................................................e.............'.................................................~.............'..
        // aese v26.16b,v20.16b             // .....................................~..........................'....................................*..........................'..
        // aesmc v26.16b,v26.16b            // .......................................~........................'......................................*........................'..
        // aese v0.16b,v21.16b              // .............................................e..................'............................................~..................'..
        // aesmc v0.16b,v0.16b              // ...............................................e................'..............................................~................'..
        // aese v1.16b,v21.16b              // .............................................e..................'............................................~..................'..
        // aesmc v1.16b,v1.16b              // ...............................................e................'..............................................~................'..
        // aese v24.16b,v21.16b             // ............................................e...................'...........................................~...................'..
        // aesmc v24.16b,v24.16b            // ..............................................e.................'.............................................~.................'..
        // aese v25.16b,v21.16b             // ....................................................e...........'...................................................~...........'..
        // aesmc v25.16b,v25.16b            // ......................................................e.........'.....................................................~.........'..
        // aese v26.16b,v21.16b             // .........................................~......................'........................................*......................'..
        // aesmc v26.16b,v26.16b            // ...........................................~....................'..........................................*....................'..
        // aese v0.16b,v22.16b              // .................................................e..............'................................................~..............'..
        // aesmc v0.16b,v0.16b              // ...................................................e............'..................................................~............'..
        // aese v1.16b,v22.16b              // .................................................e..............'................................................~..............'..
        // aesmc v1.16b,v1.16b              // ...................................................e............'..................................................~............'..
        // aese v24.16b,v22.16b             // ................................................e...............'...............................................~...............'..
        // aesmc v24.16b,v24.16b            // ..................................................e.............'.................................................~.............'..
        // aese v25.16b,v22.16b             // ........................................................e.......'.......................................................~.......'..
        // aesmc v25.16b,v25.16b            // ..........................................................e.....'.........................................................~.....'..
        // aese v26.16b,v22.16b             // .............................................~..................'............................................*..................'..
        // aesmc v26.16b,v26.16b            // ...............................................~................'..............................................*................'..
        // aese v0.16b,v23.16b              // .....................................................e..........'....................................................~..........'..
        // aese v1.16b,v23.16b              // .....................................................e..........'....................................................~..........'..
        // aese v24.16b,v23.16b             // ....................................................e...........'...................................................~...........'..
        // aese v25.16b,v23.16b             // ............................................................e...'...........................................................~...'..
        // aese v26.16b,v23.16b             // .................................................~..............'................................................*..............'..
        // eor v0.16b,v0.16b,v7.16b         // .......................................................e........'......................................................~........'..
        // eor v0.16b,v0.16b,v6.16b         // .........................................................e......'........................................................~......'..
        // extr x22,x10,x10,#32             // e...............................................................~...............................................................~..
        // extr x10,x10,x9,#63              // e...............................................................~...............................................................~..
        // and w11,w19,w22,asr#31           // .e..............................................................'~..............................................................'~.
        // eor x9,x11,x9,lsl#1              // ..e.............................................................'.~.............................................................'..
        // fmov d6,x9                       // .........................................................e......'........................................................~......'..
        // fmov v6.d[1],x10                 // ............................................................e...'...........................................................~...'..
        // eor v1.16b,v1.16b,v7.16b         // .......................................................e........'......................................................~........'..
        // eor v1.16b,v1.16b,v8.16b         // .........................................................e......'........................................................~......'..
        // ldp q2, q3, [x0], #0x50          // .....e..........................................................'....~..........................................................'..
        // extr x22,x10,x10,#32             // .e..............................................................'~..............................................................'~.
        // extr x10,x10,x9,#63              // ...e............................................................'..~............................................................'..
        // and w11,w19,w22,asr#31           // ..e.............................................................'.~.............................................................'..
        // eor x9,x11,x9,lsl#1              // ...e............................................................'..~............................................................'..
        // fmov d8,x9                       // .........................................................e......'........................................................~......'..
        // fmov v8.d[1],x10                 // ............................................................e...'...........................................................~...'..
        // eor v24.16b,v24.16b,v7.16b       // ......................................................e.........'.....................................................~.........'..
        // eor v24.16b,v24.16b,v9.16b       // ........................................................e.......'.......................................................~.......'..
        // extr x22,x10,x10,#32             // ....e...........................................................'...~...........................................................'..
        // extr x10,x10,x9,#63              // ....e...........................................................'...~...........................................................'..
        // and w11,w19,w22,asr#31           // .....e..........................................................'....~..........................................................'..
        // eor x9,x11,x9,lsl#1              // ......e.........................................................'.....~.........................................................'..
        // fmov d9,x9                       // ........................................................e.......'.......................................................~.......'..
        // fmov v9.d[1],x10                 // ...........................................................e....'..........................................................~....'..
        // eor v25.16b,v25.16b,v7.16b       // ..............................................................e.'.............................................................~.'..
        // eor v25.16b,v25.16b,v10.16b      // ~...............................................................*...............................................................~..
        // ldr q27, [x0, #-0x30]            // ......e.........................................................'.....~.........................................................'..
        // extr x22,x10,x10,#32             // .....e..........................................................'....~..........................................................'..
        // extr x10,x10,x9,#63              // .......e........................................................'......~........................................................'..
        // and w11,w19,w22,asr#31           // ......e.........................................................'.....~.........................................................'..
        // eor x9,x11,x9,lsl#1              // .......e........................................................'......~........................................................'..
        // fmov d10,x9                      // ~...............................................................*...............................................................~..
        // fmov v10.d[1],x10                // ...~............................................................'..*............................................................'..
        // eor v26.16b,v26.16b,v7.16b       // ...................................................~............'..................................................*............'..
        // eor v26.16b,v26.16b,v11.16b      // .....................................................~..........'....................................................*..........'..
        // ldp q28, q29,[x0, #-0x20]        // ..............................................................e.'.............................................................~.'..
        // extr x22,x10,x10,#32             // ........e.......................................................'.......~.......................................................'..
        // extr x10,x10,x9,#63              // ........................................................e.......'.......................................................~.......'..
        // and w11,w19,w22,asr #31          // .........e......................................................'........~......................................................'..
        // eor x9,x11,x9,lsl #1             // .....................................................e..........'....................................................~..........'..
        // fmov d11,x9                      // .....................................................~..........'....................................................*..........'..
        // fmov v11.d[1],x10                // ........................................................~.......'.......................................................*.......'..
        // stp q0, q1, [x1], #0x50          // ....~...........................................................'...*...........................................................'..
        // stp q24, q25, [x1, #-0x30]       // ..~.............................................................'.*.............................................................'..
        // str q26, [x1, #-0x10]            // ..~.............................................................'.~.............................................................'.l
        // eor v0.16b,v2.16b,v6.16b         // ...............................................................e'..............................................................~'..
        // eor v1.16b,v3.16b,v8.16b         // ...............................................................e'..............................................................~'..
        // eor v24.16b,v27.16b,v9.16b       // ..............................................................e.'.............................................................~.'..
        // eor v25.16b,v28.16b,v10.16b      // ......~.........................................................'.....*.........................................................'..
        // eor v26.16b,v29.16b,v11.16b      // ...........................................................~....'..........................................................*....'..

        subs x2, x2, #0x50
        b.hs Loop5x_xts_enc
                                             // Instructions:    38
                                             // Expected cycles: 59
                                             // Expected IPC:    0.64
                                             //
                                             // Cycle bound:     59.0
                                             // IPC bound:       0.64
                                             //
                                             // Wall time:     0.13s
                                             // User time:     0.13s
                                             //
                                             // -------------------- cycle (expected) -------------------->
                                             // 0                        25                       50
                                             // |------------------------|------------------------|--------
        eor v3.16B, v3.16B, v10.16B          // *..........................................................
        aese v27.16b, v17.16b                // *..........................................................
        stp q25, q31, [x1], #0x50            // *..........................................................
        str q29, [x1, #-96]                  // *..........................................................
        fmov d10, x12                        // .*.........................................................
        stp q28, q3, [x1, #-48]              // ..*........................................................
        aesmc v31.16b, v27.16b               // ..*........................................................
        fmov v10.d[1], x17                   // ....*......................................................
        aese v31.16b, v12.16b                // ....*......................................................
        aesmc v29.16b, v31.16b               // ......*....................................................
        eor v25.16B, v2.16B, v10.16B         // .......*...................................................
        aese v29.16b, v13.16b                // ........*..................................................
        aesmc v3.16b, v29.16b                // ..........*................................................
        aese v3.16b, v14.16b                 // ............*..............................................
        aesmc v31.16b, v3.16b                // ..............*............................................
        aese v31.16b, v15.16b                // ................*..........................................
        aesmc v31.16b, v31.16b               // ..................*........................................
        aese v31.16b, v4.16b                 // ....................*......................................
        aesmc v28.16b, v31.16b               // ......................*....................................
        aese v28.16b, v5.16b                 // ........................*..................................
        aesmc v31.16b, v28.16b               // ..........................*................................
        aese v31.16b, v18.16b                // ............................*..............................
        aesmc v26.16b, v31.16b               // ..............................*............................
        aese v26.16b, v19.16b                // ................................*..........................
        aesmc v27.16b, v26.16b               // ..................................*........................
        aese v27.16b, v20.16b                // ....................................*......................
        aesmc v26.16b, v27.16b               // ......................................*....................
        aese v26.16b, v21.16b                // ........................................*..................
        aesmc v28.16b, v26.16b               // ..........................................*................
        aese v28.16b, v22.16b                // ............................................*..............
        aesmc v29.16b, v28.16b               // ..............................................*............
        aese v29.16b, v23.16b                // ................................................*..........
        eor v28.16B, v29.16B, v7.16B         // ..................................................*........
        eor v2.16B, v28.16B, v11.16B         // ....................................................*......
        fmov d11, x9                         // ....................................................*......
        str q2, [x1, #-16]                   // ......................................................*....
        fmov v11.d[1], x10                   // .......................................................*...
        eor v26.16B, v30.16B, v11.16B        // ..........................................................*

                                                          // -------------------- cycle (expected) -------------------->
                                                          // 0                        25                       50
                                                          // |------------------------|------------------------|--------
        // eor V<ssa_0>.16B, v3.16B, v10.16B              // *..........................................................
        // fmov d10, x12                                  // .*.........................................................
        // aese v27.16b, v17.16b                          // *..........................................................
        // stp q28, Q<ssa_0>, [x1, #32]                   // ..*........................................................
        // str q29, [x1, #-16]                            // *..........................................................
        // fmov v10.d[1], x17                             // ....*......................................................
        // aesmc V<ssa_11>.16b, v27.16b                   // ..*........................................................
        // stp q25, q31, [x1], #0x50                      // *..........................................................
        // aese V<ssa_11>.16b, v12.16b                    // ....*......................................................
        // eor v25.16B, v2.16B, v10.16B                   // .......*...................................................
        // aesmc V<ssa_25>.16b, V<ssa_11>.16b             // ......*....................................................
        // aese V<ssa_25>.16b, v13.16b                    // ........*..................................................
        // aesmc V<ssa_33>.16b, V<ssa_25>.16b             // ..........*................................................
        // aese V<ssa_33>.16b, v14.16b                    // ............*..............................................
        // aesmc V<ssa_38>.16b, V<ssa_33>.16b             // ..............*............................................
        // aese V<ssa_38>.16b, v15.16b                    // ................*..........................................
        // aesmc V<ssa_43>.16b, V<ssa_38>.16b             // ..................*........................................
        // aese V<ssa_43>.16b, v4.16b                     // ....................*......................................
        // aesmc V<ssa_49>.16b, V<ssa_43>.16b             // ......................*....................................
        // aese V<ssa_49>.16b, v5.16b                     // ........................*..................................
        // aesmc V<ssa_54>.16b, V<ssa_49>.16b             // ..........................*................................
        // aese V<ssa_54>.16b, v18.16b                    // ............................*..............................
        // aesmc V<ssa_60>.16b, V<ssa_54>.16b             // ..............................*............................
        // aese V<ssa_60>.16b, v19.16b                    // ................................*..........................
        // aesmc V<ssa_65>.16b, V<ssa_60>.16b             // ..................................*........................
        // aese V<ssa_65>.16b, v20.16b                    // ....................................*......................
        // aesmc V<ssa_68>.16b, V<ssa_65>.16b             // ......................................*....................
        // aese V<ssa_68>.16b, v21.16b                    // ........................................*..................
        // aesmc V<ssa_73>.16b, V<ssa_68>.16b             // ..........................................*................
        // aese V<ssa_73>.16b, v22.16b                    // ............................................*..............
        // aesmc V<ssa_78>.16b, V<ssa_73>.16b             // ..............................................*............
        // aese V<ssa_78>.16b, v23.16b                    // ................................................*..........
        // eor V<ssa_84>.16B, V<ssa_78>.16B, v7.16B       // ..................................................*........
        // eor V<ssa_86>.16B, V<ssa_84>.16B, v11.16B      // ....................................................*......
        // fmov d11, x9                                   // ....................................................*......
        // fmov v11.d[1], x10                             // .......................................................*...
        // eor v26.16B, v30.16B, v11.16B                  // ..........................................................*
        // str Q<ssa_86>, [x1, #-16]                      // ......................................................*....



    // If left 4 blocks, borrow the five block's processing.
    // This means if (x2 + 1 block) == 0, which is the case
    // when input size % 5 = 4, continue processing and do
    // another iteration in Loop5x_xts_enc which will exit from
    // cbz  x6,.Lxts_enc_tail4x.
    // Otherwise, this is the end of the loop continue processing
    // 0, 1, 2 or 3 blocks (with or without tail) starting at
    // Loop5x_enc_after
 cmn	x2,#0x10
 b.ne	Loop5x_enc_after
    b.eq  Lxts_enc_tail4x

Loop5x_enc_after:
 add	x2,x2,#0x50
 cbz	x2,Lxts_enc_done     // no blocks left

 add	w6,w5,#2
 subs	x2,x2,#0x30
 b.lo	Lxts_inner_enc_tail    // 1 or 2 blocks left
                                    // (with tail or not)

 eor	v0.16b,v6.16b,v27.16b         // 3 blocks left
 eor	v1.16b,v8.16b,v28.16b
 eor	v24.16b,v29.16b,v9.16b
 b	Lxts_outer_enc_tail

.align	4
Lxts_enc_tail4x:
 orr	v11.16b,v10.16b,v10.16b
 orr	v10.16b,v9.16b,v9.16b
 orr	v9.16b,v8.16b,v8.16b
 orr	v8.16b,v6.16b,v6.16b
 fmov	x9,d11
 fmov	x10,v11.d[1]
 eor	v1.16b,v8.16b,v3.16b
 eor	v24.16b,v27.16b,v9.16b
 eor	v25.16b,v28.16b,v10.16b
 eor	v26.16b,v29.16b,v11.16b

 aese	v1.16b,v16.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v16.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v16.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v16.16b
 aesmc	v26.16b,v26.16b
 subs	x2,x2,#0x50         // because Lxts_enc_tail4x

 aese	v1.16b,v17.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v17.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v17.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v17.16b
 aesmc	v26.16b,v26.16b
 csel	x6,xzr,x2,gt    // borrow x6, w6, "gt" is not typo
 mov	x7,x3

 aese	v1.16b,v12.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v12.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v12.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v12.16b
 aesmc	v26.16b,v26.16b

 aese	v1.16b,v13.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v13.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v13.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v13.16b
 aesmc	v26.16b,v26.16b

 aese	v1.16b,v14.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v14.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v14.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v14.16b
 aesmc	v26.16b,v26.16b

 aese	v1.16b,v15.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v15.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v15.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v15.16b
 aesmc	v26.16b,v26.16b

 aese	v1.16b,v4.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v4.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v4.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v4.16b
 aesmc	v26.16b,v26.16b

 aese	v1.16b,v5.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v5.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v5.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v5.16b
 aesmc	v26.16b,v26.16b

 aese	v1.16b,v18.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v18.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v18.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v18.16b
 aesmc	v26.16b,v26.16b
 add	x0,x0,x6  // x0 is adjusted in such way that
                                // at exit from the loop v1.16b-v26.16b
                                // are loaded with last "words"
 // add	x6,x2,#0x60          // because Lxts_enc_tail4x

 aese	v1.16b,v19.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v19.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v19.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v19.16b
 aesmc	v26.16b,v26.16b

 aese	v1.16b,v20.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v20.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v20.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v20.16b
 aesmc	v26.16b,v26.16b

 aese	v1.16b,v21.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v21.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v21.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v21.16b
 aesmc	v26.16b,v26.16b

 aese	v1.16b,v22.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v22.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v22.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v22.16b
 aesmc	v26.16b,v26.16b

 aese	v1.16b,v23.16b
 aese	v24.16b,v23.16b
 aese	v25.16b,v23.16b
 aese	v26.16b,v23.16b

    // The iv for first block of one iteration
 extr	x22,x10,x10,#32
 extr	x10,x10,x9,#63
 and	w11,w19,w22,asr#31
 eor	x9,x11,x9,lsl#1
 fmov	d6,x9
 fmov	v6.d[1],x10
    eor	v1.16b,v1.16b,v7.16b
    eor	v1.16b,v1.16b,v8.16b
 ld1	{v2.16b},[x0],#16
    // The iv for second block
 extr	x22,x10,x10,#32
 extr	x10,x10,x9,#63
 and	w11,w19,w22,asr#31
 eor	x9,x11,x9,lsl#1
 fmov	d8,x9
 fmov	v8.d[1],x10
    eor	v24.16b,v24.16b,v7.16b
    eor	v24.16b,v24.16b,v9.16b
    ld1	{v3.16b},[x0],#16
    // The iv for third block
 extr	x22,x10,x10,#32
 extr	x10,x10,x9,#63
 and	w11,w19,w22,asr#31
 eor	x9,x11,x9,lsl#1
 fmov	d9,x9
 fmov	v9.d[1],x10
    eor	v25.16b,v25.16b,v7.16b
    eor	v25.16b,v25.16b,v10.16b
 ld1	{v27.16b},[x0],#16
    // The iv for fourth block
 extr	x22,x10,x10,#32
 extr	x10,x10,x9,#63
 and	w11,w19,w22,asr#31
 eor	x9,x11,x9,lsl#1
 fmov	d10,x9
 fmov	v10.d[1],x10
    eor	v26.16b,v26.16b,v7.16b
    eor	v26.16b,v26.16b,v11.16b
 ld1	{v28.16b},[x0],#16
 ld1	{v29.16b},[x0],#16

 add	x0,x0,#16
    st1  {v1.16b},[x1],#16
    st1	{v24.16b,v25.16b},[x1],#32
    st1  {v26.16b},[x1],#16
 b	Lxts_enc_done
.align	4
Lxts_outer_enc_tail:
  // First round with v16
  aese	v0.16b,v16.16b
  aesmc	v0.16b,v0.16b
  aese	v1.16b,v16.16b
  aesmc	v1.16b,v1.16b
  aese	v24.16b,v16.16b
  aesmc	v24.16b,v24.16b

  // Second round with v17
  aese	v0.16b,v17.16b
  aesmc	v0.16b,v0.16b
  aese	v1.16b,v17.16b
  aesmc	v1.16b,v1.16b
  aese	v24.16b,v17.16b
  aesmc	v24.16b,v24.16b

  // Third round with v12
  aese	v0.16b,v12.16b
  aesmc	v0.16b,v0.16b
  aese	v1.16b,v12.16b
  aesmc	v1.16b,v1.16b
  aese	v24.16b,v12.16b
  aesmc	v24.16b,v24.16b

  // Fourth round with v13
  aese	v0.16b,v13.16b
  aesmc	v0.16b,v0.16b
  aese	v1.16b,v13.16b
  aesmc	v1.16b,v1.16b
  aese	v24.16b,v13.16b
  aesmc	v24.16b,v24.16b

  // Fifth round with v14
  aese	v0.16b,v14.16b
  aesmc	v0.16b,v0.16b
  aese	v1.16b,v14.16b
  aesmc	v1.16b,v1.16b
  aese	v24.16b,v14.16b
  aesmc	v24.16b,v24.16b

  // Sixth round with v15
  aese	v0.16b,v15.16b
  aesmc	v0.16b,v0.16b
  aese	v1.16b,v15.16b
  aesmc	v1.16b,v1.16b
  aese	v24.16b,v15.16b
  aesmc	v24.16b,v24.16b

  // Seventh round with v4
  aese	v0.16b,v4.16b
  aesmc	v0.16b,v0.16b
  aese	v1.16b,v4.16b
  aesmc	v1.16b,v1.16b
  aese	v24.16b,v4.16b
  aesmc	v24.16b,v24.16b

  // Eighth round with v5
  aese	v0.16b,v5.16b
  aesmc	v0.16b,v0.16b
  aese	v1.16b,v5.16b
  aesmc	v1.16b,v1.16b
  aese	v24.16b,v5.16b
  aesmc	v24.16b,v24.16b

  // 9th round with v18
  aese	v0.16b,v18.16b
  aesmc	v0.16b,v0.16b
  aese	v1.16b,v18.16b
  aesmc	v1.16b,v1.16b
  aese	v24.16b,v18.16b
  aesmc	v24.16b,v24.16b

  // 10th round with v19
  aese	v0.16b,v19.16b
  aesmc	v0.16b,v0.16b
  aese	v1.16b,v19.16b
  aesmc	v1.16b,v1.16b
  aese	v24.16b,v19.16b
  aesmc	v24.16b,v24.16b

// aese	v0.16b,v16.16b
// aesmc	v0.16b,v0.16b
// aese	v1.16b,v16.16b
// aesmc	v1.16b,v1.16b
// aese	v24.16b,v16.16b
// aesmc	v24.16b,v24.16b
// ld1	{v16.4s},[x7],#16
// subs	w6,w6,#2
// aese	v0.16b,v17.16b
// aesmc	v0.16b,v0.16b
// aese	v1.16b,v17.16b
// aesmc	v1.16b,v1.16b
// aese	v24.16b,v17.16b
// aesmc	v24.16b,v24.16b
// ld1	{v17.4s},[x7],#16
// b.gt	Lxts_outer_enc_tail

// aese	v0.16b,v16.16b
// aesmc	v0.16b,v0.16b
// aese	v1.16b,v16.16b
// aesmc	v1.16b,v1.16b
// aese	v24.16b,v16.16b
// aesmc	v24.16b,v24.16b
// aese	v0.16b,v17.16b
// aesmc	v0.16b,v0.16b
// aese	v1.16b,v17.16b
// aesmc	v1.16b,v1.16b
// aese	v24.16b,v17.16b
// aesmc	v24.16b,v24.16b

 aese	v0.16b,v20.16b
 aesmc	v0.16b,v0.16b
 aese	v1.16b,v20.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v20.16b
 aesmc	v24.16b,v24.16b
 aese	v0.16b,v21.16b
 aesmc	v0.16b,v0.16b
 aese	v1.16b,v21.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v21.16b
 aesmc	v24.16b,v24.16b
 aese	v0.16b,v22.16b
 aesmc	v0.16b,v0.16b
 aese	v1.16b,v22.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v22.16b
 aesmc	v24.16b,v24.16b
 aese	v0.16b,v23.16b
 aese	v1.16b,v23.16b
 aese	v24.16b,v23.16b

 eor	v30.16b,v6.16b,v7.16b
 eor	v11.16b,v9.16b,v7.16b
 subs	x2,x2,#0x30
    // The iv for first block
 fmov	x9,d9
 fmov	x10,v9.d[1]
    // mov   w19,#0x87
 extr	x22,x10,x10,#32
 extr	x10,x10,x9,#63
 and	w11,w19,w22,asr#31
 eor	x9,x11,x9,lsl#1
 fmov	d6,x9
 fmov	v6.d[1],x10
 eor	v10.16b,v8.16b,v7.16b
 csel	x6,x2,x6,lo   // x6, w6, is zero at this point

 add	x6,x6,#0x20
 add	x0,x0,x6
 mov	x7,x3

 ld1	{v27.16b},[x0],#16
 add	w6,w5,#2
 eor	v30.16b,v30.16b,v0.16b
 eor	v31.16b,v10.16b,v1.16b
 eor	v24.16b,v24.16b,v11.16b
 ld1	{v16.4s,v17.4s},[x7],#32
 st1	{v30.16b,v31.16b},[x1],#32
 st1	{v24.16b},[x1],#16
 cmn	x2,#0x30
 b.eq	Lxts_enc_done
Lxts_encxor_one:
 orr	v28.16b,v3.16b,v3.16b
 orr	v29.16b,v27.16b,v27.16b
 nop

Lxts_inner_enc_tail:
 cmn	x2,#0x10
 eor	v1.16b,v28.16b,v6.16b
 eor	v24.16b,v29.16b,v8.16b
 b.eq	Lxts_enc_tail_loop
 eor	v24.16b,v29.16b,v6.16b
Lxts_enc_tail_loop:
  // First round with v16
  aese	v1.16b,v16.16b
  aesmc	v1.16b,v1.16b
  aese	v24.16b,v16.16b
  aesmc	v24.16b,v24.16b

  // Second round with v17
  aese	v1.16b,v17.16b
  aesmc	v1.16b,v1.16b
  aese	v24.16b,v17.16b
  aesmc	v24.16b,v24.16b

  // Third round with v12
  aese	v1.16b,v12.16b
  aesmc	v1.16b,v1.16b
  aese	v24.16b,v12.16b
  aesmc	v24.16b,v24.16b

  // Fourth round with v13
  aese	v1.16b,v13.16b
  aesmc	v1.16b,v1.16b
  aese	v24.16b,v13.16b
  aesmc	v24.16b,v24.16b

  // Fifth round with v14
  aese	v1.16b,v14.16b
  aesmc	v1.16b,v1.16b
  aese	v24.16b,v14.16b
  aesmc	v24.16b,v24.16b

  // Sixth round with v15
  aese	v1.16b,v15.16b
  aesmc	v1.16b,v1.16b
  aese	v24.16b,v15.16b
  aesmc	v24.16b,v24.16b

  // Seventh round with v4
  aese	v1.16b,v4.16b
  aesmc	v1.16b,v1.16b
  aese	v24.16b,v4.16b
  aesmc	v24.16b,v24.16b

  // Eighth round with v5
  aese	v1.16b,v5.16b
  aesmc	v1.16b,v1.16b
  aese	v24.16b,v5.16b
  aesmc	v24.16b,v24.16b

  // 9th round with v18
  aese	v1.16b,v18.16b
  aesmc	v1.16b,v1.16b
  aese	v24.16b,v18.16b
  aesmc	v24.16b,v24.16b

  // 10th round with v19
  aese	v1.16b,v19.16b
  aesmc	v1.16b,v1.16b
  aese	v24.16b,v19.16b
  aesmc	v24.16b,v24.16b

// aese	v1.16b,v16.16b
// aesmc	v1.16b,v1.16b
// aese	v24.16b,v16.16b
// aesmc	v24.16b,v24.16b
// ld1	{v16.4s},[x7],#16
// subs	w6,w6,#2
// aese	v1.16b,v17.16b
// aesmc	v1.16b,v1.16b
// aese	v24.16b,v17.16b
// aesmc	v24.16b,v24.16b
// ld1	{v17.4s},[x7],#16
// b.gt	Lxts_enc_tail_loop

// aese	v1.16b,v16.16b
// aesmc	v1.16b,v1.16b
// aese	v24.16b,v16.16b
// aesmc	v24.16b,v24.16b
// aese	v1.16b,v17.16b
// aesmc	v1.16b,v1.16b
// aese	v24.16b,v17.16b
// aesmc	v24.16b,v24.16b


 aese	v1.16b,v20.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v20.16b
 aesmc	v24.16b,v24.16b
 cmn	x2,#0x20
 aese	v1.16b,v21.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v21.16b
 aesmc	v24.16b,v24.16b
 eor	v5.16b,v6.16b,v7.16b
 aese	v1.16b,v22.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v22.16b
 aesmc	v24.16b,v24.16b
 eor	v17.16b,v8.16b,v7.16b
 aese	v1.16b,v23.16b
 aese	v24.16b,v23.16b
 b.eq	Lxts_enc_one
 eor	v5.16b,v5.16b,v1.16b
 st1	{v5.16b},[x1],#16
 eor	v17.16b,v17.16b,v24.16b
 orr	v6.16b,v8.16b,v8.16b
 st1	{v17.16b},[x1],#16
 fmov	x9,d8
 fmov	x10,v8.d[1]
 mov	w19,#0x87
 extr	x22,x10,x10,#32
 extr	x10,x10,x9,#63
 and	w11,w19,w22,asr #31
 eor	x9,x11,x9,lsl #1
 fmov	d6,x9
 fmov	v6.d[1],x10
 b	Lxts_enc_done

Lxts_enc_one:
 eor	v5.16b,v5.16b,v24.16b
 orr	v6.16b,v6.16b,v6.16b
 st1	{v5.16b},[x1],#16
 fmov	x9,d6
 fmov	x10,v6.d[1]
 mov	w19,#0x87
 extr	x22,x10,x10,#32
 extr	x10,x10,x9,#63
 and	w11,w19,w22,asr #31
 eor	x9,x11,x9,lsl #1
 fmov	d6,x9
 fmov	v6.d[1],x10
 b	Lxts_enc_done
.align	5
Lxts_enc_done:
    // Process the tail block with cipher stealing.
 tst	x21,#0xf
 b.eq	Lxts_abort

 mov	x20,x0
 mov	x13,x1
 sub	x1,x1,#16
.composite_enc_loop:
 subs	x21,x21,#1
 ldrb	w15,[x1,x21]
 ldrb	w14,[x20,x21]
 strb	w15,[x13,x21]
 strb	w14,[x1,x21]
 b.gt	.composite_enc_loop
Lxts_enc_load_done:
 ld1	{v26.16b},[x1]
 eor	v26.16b,v26.16b,v6.16b

    // Encrypt the composite block to get the last second encrypted text block
 ldr	w6,[x3,#240]        // load key schedule...
 ld1	{v0.16b},[x3],#16
 sub	w6,w6,#2
 ld1	{v1.16b},[x3],#16     // load key schedule...
Loop_final_enc:
 aese	v26.16b,v0.16b
 aesmc	v26.16b,v26.16b
 ld1	{v0.4s},[x3],#16
 subs	w6,w6,#2
 aese	v26.16b,v1.16b
 aesmc	v26.16b,v26.16b
 ld1	{v1.4s},[x3],#16
 b.gt	Loop_final_enc

 aese	v26.16b,v0.16b
 aesmc	v26.16b,v26.16b
 ld1	{v0.4s},[x3]
 aese	v26.16b,v1.16b
 eor	v26.16b,v26.16b,v0.16b
 eor	v26.16b,v26.16b,v6.16b
 st1	{v26.16b},[x1]

Lxts_abort:
 ldp	x21,x22,[sp,#16]
 ldp	x19,x20,[sp],#32
Lxts_enc_final_abort:
    restore_vregs
    add sp, sp, #STACK_SIZE_VREGS
 ret

#endif
#endif  // !OPENSSL_NO_ASM && defined(__AARCH64EL__) && defined(__APPLE__)
#if defined(__ELF__)
// See https: // www.airs.com/blog/archives/518.
.section .note.GNU-stack,"",%progbits
#endif
