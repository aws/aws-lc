// The following xts encrypt is from MacBook M3 build folder
// after moving around some instructions

#if !defined(__has_feature)
#define __has_feature(x) 0
#endif
#if __has_feature(memory_sanitizer) && !defined(OPENSSL_NO_ASM)
#define OPENSSL_NO_ASM
#endif

#include <openssl/asm_base.h>

#if !defined(OPENSSL_NO_ASM) && defined(__AARCH64EL__)
#if defined(__ELF__)
#include <openssl/boringssl_prefix_symbols_asm.h>
#include <openssl/arm_arch.h>
.arch   armv8-a+crypto
.text
.globl  aes_hw_slothy_xts_encrypt
.hidden aes_hw_slothy_xts_encrypt
.type   aes_hw_slothy_xts_encrypt,%function
#elif defined(__APPLE__)
#if defined(BORINGSSL_PREFIX)
#include <boringssl_prefix_symbols_asm.h>
#endif
#include <openssl/arm_arch.h>
.text
.globl	_aes_hw_slothy_xts_encrypt
.private_extern	_aes_hw_slothy_xts_encrypt
#else
#error Unknown configuration
#endif

#if __ARM_MAX_ARCH__ >= 8

.align	4


#define STACK_BASE_VREGS 0
#define STACK_SIZE_VREGS (4*16)

.macro save_vregs
        stp  d8,  d9, [sp, #(STACK_BASE_VREGS + 16*0)]
        stp d10, d11, [sp, #(STACK_BASE_VREGS + 16*1)]
        stp d12, d13, [sp, #(STACK_BASE_VREGS + 16*2)]
        stp d14, d15, [sp, #(STACK_BASE_VREGS + 16*3)]
.endm

.macro restore_vregs
        ldp  d8,  d9, [sp, #(STACK_BASE_VREGS + 16*0)]
        ldp d10, d11, [sp, #(STACK_BASE_VREGS + 16*1)]
        ldp d12, d13, [sp, #(STACK_BASE_VREGS + 16*2)]
        ldp d14, d15, [sp, #(STACK_BASE_VREGS + 16*3)]
.endm

// A single AES round
// Prevent SLOTHY from unfolding because uArchs tend to fuse AESMC+AESE
.macro aesr data, key // @slothy:no-unfold
        aese  \data, \key
        aesmc \data, \data
.endm

_aes_hw_slothy_xts_encrypt:
aes_hw_slothy_xts_encrypt:
 # AARCH64_VALID_CALL_TARGET

    sub sp, sp, #STACK_SIZE_VREGS
    save_vregs

 cmp	x2,#16
    // Original input data size bigger than 16, jump to big size processing.
 b.ne	Lxts_enc_big_size
    // Encrypt the iv with key2, as the first XEX iv.
 ldr	w6,[x4,#240]
 ld1	{v0.16b},[x4],#16
 ld1	{v6.16b},[x5]
 sub	w6,w6,#2
 ld1	{v1.16b},[x4],#16

Loop_enc_iv_enc:
 aese	v6.16b,v0.16b
 aesmc	v6.16b,v6.16b
 ld1	{v0.4s},[x4],#16
 aese	v6.16b,v1.16b
 aesmc	v6.16b,v6.16b
 ld1	{v1.4s},[x4],#16
 subs	w6,w6,#2
 cbnz	w6,Loop_enc_iv_enc

 aese	v6.16b,v0.16b
 aesmc	v6.16b,v6.16b
 ld1	{v0.4s},[x4]
 aese	v6.16b,v1.16b
 eor	v6.16b,v6.16b,v0.16b

 ld1	{v0.16b},[x0]
 eor	v0.16b,v6.16b,v0.16b

 ldr	w6,[x3,#240]
 ld1	{v28.4s,v29.4s},[x3],#32       // load key schedule...

 aese	v0.16b,v28.16b
 aesmc	v0.16b,v0.16b
 ld1	{v16.4s,v17.4s},[x3],#32         // load key schedule...
 aese	v0.16b,v29.16b
 aesmc	v0.16b,v0.16b
 subs	w6,w6,#10     // if rounds==10, jump to aes-128-xts processing
// b.eq    .Lxts_128_enc
Lxts_enc_round_loop:
 aese	v0.16b,v16.16b
 aesmc	v0.16b,v0.16b
 ld1	{v16.4s},[x3],#16            // load key schedule...
 aese	v0.16b,v17.16b
 aesmc	v0.16b,v0.16b
 ld1	{v17.4s},[x3],#16            // load key schedule...
 subs	w6,w6,#2          // bias
 b.gt	Lxts_enc_round_loop
// .Lxts_128_enc:
 ld1	{v18.4s,v19.4s},[x3],#32       // load key schedule...
 aese	v0.16b,v16.16b
 aesmc	v0.16b,v0.16b
 aese	v0.16b,v17.16b
 aesmc	v0.16b,v0.16b
 ld1	{v20.4s,v21.4s},[x3],#32       // load key schedule...
 aese	v0.16b,v18.16b
 aesmc	v0.16b,v0.16b
 aese	v0.16b,v19.16b
 aesmc	v0.16b,v0.16b
 ld1	{v22.4s,v23.4s},[x3],#32       // load key schedule...
 aese	v0.16b,v20.16b
 aesmc	v0.16b,v0.16b
 aese	v0.16b,v21.16b
 aesmc	v0.16b,v0.16b
 ld1	{v7.4s},[x3]
 aese	v0.16b,v22.16b
 aesmc	v0.16b,v0.16b
 aese	v0.16b,v23.16b
 eor	v0.16b,v0.16b,v7.16b
 eor	v0.16b,v0.16b,v6.16b
 st1	{v0.16b},[x1]
 b	Lxts_enc_final_abort

.align	4
Lxts_enc_big_size:
   // Encrypt input size > 16 bytes
 stp	x19,x20,[sp,#-32]!
 stp	x21,x22,[sp,#16]

    // tailcnt store the tail value of length%16.
 and	x21,x2,#0xf
 and	x2,x2,#-16    // len &= 0x1..110000, now divisible by 16
 subs	x2,x2,#16
 mov	x8,#16
 b.lo	Lxts_abort         // if !(len > 16): error
 csel	x8,xzr,x8,eq  // if (len == 16): step = 0

    // Firstly, encrypt the iv with key2, as the first iv of XEX.
 ldr	w6,[x4,#240]
 ld1	{v0.4s},[x4],#16
 ld1	{v6.16b},[x5]
 sub	w6,w6,#2
 ld1	{v1.4s},[x4],#16

Loop_iv_enc:
 aese	v6.16b,v0.16b
 aesmc	v6.16b,v6.16b
 ld1	{v0.4s},[x4],#16
 subs	w6,w6,#2
 aese	v6.16b,v1.16b
 aesmc	v6.16b,v6.16b
 ld1	{v1.4s},[x4],#16
 b.gt	Loop_iv_enc

 aese	v6.16b,v0.16b
 aesmc	v6.16b,v6.16b
 ld1	{v0.4s},[x4]
 aese	v6.16b,v1.16b
 eor	v6.16b,v6.16b,v0.16b

    // The iv for second block
    // x9- iv(low), x10 - iv(high)
    // the five ivs stored into, v6.16b,v8.16b,v9.16b,v10.16b,v11.16b
 fmov	x9,d6
 fmov	x10,v6.d[1]
 mov	w19,#0x87
 extr	x22,x10,x10,#32
 extr	x10,x10,x9,#63
 and	w11,w19,w22,asr#31
 eor	x9,x11,x9,lsl#1
 fmov	d8,x9
 fmov	v8.d[1],x10

 ldr	w5,[x3,#240]       // next starting point
 ld1	{v0.16b},[x0],x8

    mov x7, x3
 ld1	{v16.4s,v17.4s},[x7], #32         // load key schedule...
    ld1 {v12.4s,v13.4s},[x7], #32
 ld1	{v14.4s,v15.4s},[x7], #32
    ld1 {v4.4s,v5.4s},  [x7], #32
    ld1	{v18.4s,v19.4s},[x7], #32
 ld1	{v20.4s,v21.4s},[x7], #32
 ld1	{v22.4s,v23.4s},[x7], #32
 ld1	{v7.4s},        [x7]

 sub	w5,w5,#8
 add	x7,x3,#32
 mov	w6,w5

    // Encryption
Lxts_enc:
 ld1	{v24.16b},[x0],#16
 subs	x2,x2,#32           // bias
 add	w6,w5,#2
 orr	v28.16b,v0.16b,v0.16b
 orr	v29.16b,v24.16b,v24.16b
 b.lo	Lxts_inner_enc_tail    // when input size % 5 = 1 or 2
                                    // (with tail or not)
 eor	v0.16b,v0.16b,v6.16b          // before encryption, xor with iv
 eor	v24.16b,v24.16b,v8.16b

    // The iv for third block
 extr	x22,x10,x10,#32
 extr	x10,x10,x9,#63
 and	w11,w19,w22,asr#31
 eor	x9,x11,x9,lsl#1
 fmov	d9,x9
 fmov	v9.d[1],x10


 orr	v1.16b,v24.16b,v24.16b
 ld1	{v24.16b},[x0],#16
 orr	v2.16b,v0.16b,v0.16b
 orr	v3.16b,v1.16b,v1.16b
 eor	v27.16b,v24.16b,v9.16b         // the third block
 eor	v24.16b,v24.16b,v9.16b
 cmp	x2,#32
 b.lo	Lxts_outer_enc_tail

    // The iv for fourth block
 extr	x22,x10,x10,#32
 extr	x10,x10,x9,#63
 and	w11,w19,w22,asr#31
 eor	x9,x11,x9,lsl#1
 fmov	d10,x9
 fmov	v10.d[1],x10

 ld1	{v25.16b},[x0],#16
    // The iv for fifth block
 extr	x22,x10,x10,#32
 extr	x10,x10,x9,#63
 and	w11,w19,w22,asr#31
 eor	x9,x11,x9,lsl#1
 fmov	d11,x9
 fmov	v11.d[1],x10

 ld1	{v26.16b},[x0],#16
 eor	v25.16b,v25.16b,v10.16b        // the fourth block
 eor	v26.16b,v26.16b,v11.16b
 sub	x2,x2,#32           // bias
 mov	w6,w5

.align	4
                                             // Instructions:    156
                                             // Expected cycles: 58
                                             // Expected IPC:    2.69
                                             //
                                             // Cycle bound:     58.0
                                             // IPC bound:       2.69
                                             //
                                             // Wall time:     2.49s
                                             // User time:     2.49s
                                             //
                                             // ------------------- cycle (expected) -------------------->
                                             // 0                        25                       50
                                             // |------------------------|------------------------|-------
        aese v26.16b, v16.16b                // *.........................................................
        extr x22, x10, x10, #32              // *.........................................................
        extr x13, x10, x9, #63               // *.........................................................
        aese v1.16b, v16.16b                 // *.........................................................
        subs x4, x2, #0x50                   // *.........................................................
        mov x15, x3                          // *.........................................................
        aese v0.16b, v16.16b                 // .*........................................................
        aese v24.16b, v16.16b                // .*........................................................
        aese v25.16b, v16.16b                // .*........................................................
        and w12, w19, w22, asr #31           // .*........................................................
        csel x11, xzr, x4, gt                // .*........................................................
        extr x22, x13, x13, #32              // .*........................................................
        add x0, x0, x11                      // ..*.......................................................
        eor x8, x12, x9, lsl #1              // ..*.......................................................
        aesmc v29.16b, v26.16b               // ..*.......................................................
        aesmc v31.16b, v1.16b                // ..*.......................................................
        and w14, w19, w22, asr #31           // ..*.......................................................
        subs x4, x2, #0x50                   // ..*.......................................................
        aesmc v28.16b, v0.16b                // ...*......................................................
        aesmc v24.16b, v24.16b               // ...*......................................................
        aesmc v2.16b, v25.16b                // ...*......................................................
        ld1 {v16.4S}, [x15], #16             // ...*......................................................
        eor x14, x14, x8, lsl #1             // ...*......................................................
        extr x6, x13, x8, #63                // ...*......................................................
        aese v29.16b, v17.16b                // ....*.....................................................
        aese v31.16b, v17.16b                // ....*.....................................................
        csel x12, xzr, x4, gt                // ....*.....................................................
        extr x22, x6, x6, #32                // ....*.....................................................
        extr x17, x6, x14, #63               // ....*.....................................................
        aese v28.16b, v17.16b                // .....*....................................................
        aese v24.16b, v17.16b                // .....*....................................................
        aese v2.16b, v17.16b                 // .....*....................................................
        ld1 {v17.4S}, [x15], #16             // .....*....................................................
        and w4, w19, w22, asr #31            // .....*....................................................
        extr x22, x17, x17, #32              // .....*....................................................
        aesmc v30.16b, v29.16b               // ......*...................................................
        aesmc v0.16b, v31.16b                // ......*...................................................
        eor x5, x4, x14, lsl #1              // ......*...................................................
        and w16, w19, w22, asr #31           // ......*...................................................
        aesmc v3.16b, v28.16b                // .......*..................................................
        aesmc v25.16b, v24.16b               // .......*..................................................
        aesmc v24.16b, v2.16b                // .......*..................................................
        eor x7, x16, x5, lsl #1              // .......*..................................................
        extr x11, x17, x5, #63               // .......*..................................................
        aese v30.16b, v12.16b                // ........*.................................................
        aese v0.16b, v12.16b                 // ........*.................................................
        extr x22, x11, x11, #32              // ........*.................................................
        extr x10, x11, x7, #63               // ........*.................................................
        aese v3.16b, v12.16b                 // .........*................................................
        aese v25.16b, v12.16b                // .........*................................................
        aese v24.16b, v12.16b                // .........*................................................
        and w4, w19, w22, asr #31            // .........*................................................
        extr x22, x10, x10, #32              // .........*................................................
        aesmc v29.16b, v30.16b               // ..........*...............................................
        aesmc v2.16b, v0.16b                 // ..........*...............................................
        eor x9, x4, x7, lsl #1               // ..........*...............................................
        and w4, w19, w22, asr #31            // ..........*...............................................
        aesmc v31.16b, v3.16b                // ...........*..............................................
        aesmc v30.16b, v25.16b               // ...........*..............................................
        aesmc v26.16b, v24.16b               // ...........*..............................................
        eor x4, x4, x9, lsl #1               // ...........*..............................................
        aese v29.16b, v13.16b                // ............*.............................................
        aese v2.16b, v13.16b                 // ............*.............................................
        aese v31.16b, v13.16b                // .............*............................................
        aese v30.16b, v13.16b                // .............*............................................
        aese v26.16b, v13.16b                // .............*............................................
        aesmc v0.16b, v29.16b                // ..............*...........................................
        aesmc v29.16b, v2.16b                // ..............*...........................................
        aesmc v27.16b, v31.16b               // ...............*..........................................
        aesmc v31.16b, v30.16b               // ...............*..........................................
        aesmc v1.16b, v26.16b                // ...............*..........................................
        aese v0.16b, v14.16b                 // ................*.........................................
        aese v29.16b, v14.16b                // ................*.........................................
        aese v27.16b, v14.16b                // .................*........................................
        aese v31.16b, v14.16b                // .................*........................................
        aese v1.16b, v14.16b                 // .................*........................................
        aesmc v0.16b, v0.16b                 // ..................*.......................................
        aesmc v26.16b, v29.16b               // ..................*.......................................
        aesmc v24.16b, v27.16b               // ...................*......................................
        aesmc v3.16b, v1.16b                 // ...................*......................................
        aese v0.16b, v15.16b                 // ....................*.....................................
        aese v26.16b, v15.16b                // ....................*.....................................
        aese v24.16b, v15.16b                // .....................*....................................
        aese v3.16b, v15.16b                 // .....................*....................................
        aesmc v2.16b, v0.16b                 // ......................*...................................
        aesmc v0.16b, v26.16b                // ......................*...................................
        aesmc v25.16b, v24.16b               // .......................*..................................
        aesmc v29.16b, v3.16b                // .......................*..................................
        aese v2.16b, v4.16b                  // ........................*.................................
        aese v0.16b, v4.16b                  // ........................*.................................
        aese v25.16b, v4.16b                 // .........................*................................
        aese v29.16b, v4.16b                 // .........................*................................
        aesmc v27.16b, v2.16b                // ..........................*...............................
        aesmc v26.16b, v0.16b                // ..........................*...............................
        aesmc v0.16b, v25.16b                // ...........................*..............................
        aesmc v2.16b, v29.16b                // ...........................*..............................
        aese v27.16b, v5.16b                 // ............................*.............................
        aese v26.16b, v5.16b                 // ............................*.............................
        aese v0.16b, v5.16b                  // .............................*............................
        aese v2.16b, v5.16b                  // .............................*............................
        aesmc v3.16b, v27.16b                // ..............................*...........................
        aesmc v30.16b, v26.16b               // ..............................*...........................
        aesmc v0.16b, v0.16b                 // ...............................*..........................
        aesmc v26.16b, v2.16b                // ...............................*..........................
        aese v3.16b, v18.16b                 // ................................*.........................
        aese v30.16b, v18.16b                // ................................*.........................
        aese v0.16b, v18.16b                 // .................................*........................
        aese v26.16b, v18.16b                // .................................*........................
        aesmc v2.16b, v3.16b                 // ..................................*.......................
        aesmc v24.16b, v30.16b               // ..................................*.......................
        aesmc v3.16b, v0.16b                 // ...................................*......................
        aesmc v30.16b, v26.16b               // ...................................*......................
        aese v2.16b, v19.16b                 // ....................................*.....................
        aese v24.16b, v19.16b                // ....................................*.....................
        aese v3.16b, v19.16b                 // .....................................*....................
        aese v30.16b, v19.16b                // .....................................*....................
        aesmc v29.16b, v2.16b                // ......................................*...................
        aesmc v25.16b, v24.16b               // ......................................*...................
        aesmc v27.16b, v3.16b                // .......................................*..................
        aesmc v24.16b, v30.16b               // .......................................*..................
        aese v29.16b, v20.16b                // ........................................*.................
        aese v25.16b, v20.16b                // ........................................*.................
        aese v27.16b, v20.16b                // .........................................*................
        aese v24.16b, v20.16b                // .........................................*................
        aesmc v0.16b, v29.16b                // ..........................................*...............
        aesmc v1.16b, v25.16b                // ..........................................*...............
        aesmc v2.16b, v27.16b                // ...........................................*..............
        aesmc v25.16b, v24.16b               // ...........................................*..............
        aese v0.16b, v21.16b                 // ............................................*.............
        aese v1.16b, v21.16b                 // ............................................*.............
        aese v2.16b, v21.16b                 // .............................................*............
        aese v25.16b, v21.16b                // .............................................*............
        aesmc v26.16b, v0.16b                // ..............................................*...........
        aesmc v28.16b, v1.16b                // ..............................................*...........
        aesmc v3.16b, v2.16b                 // ...............................................*..........
        aesmc v25.16b, v25.16b               // ...............................................*..........
        aese v26.16b, v22.16b                // ................................................*.........
        aese v28.16b, v22.16b                // ................................................*.........
        aese v3.16b, v22.16b                 // .................................................*........
        aese v25.16b, v22.16b                // .................................................*........
        aesmc v30.16b, v28.16b               // ..................................................*.......
        aesmc v28.16b, v26.16b               // ..................................................*.......
        aesmc v1.16b, v3.16b                 // ...................................................*......
        aesmc v2.16b, v25.16b                // ...................................................*......
        aese v30.16b, v23.16b                // ....................................................*.....
        aese v1.16b, v23.16b                 // .....................................................*....
        aese v2.16b, v23.16b                 // .....................................................*....
        eor v24.16B, v30.16B, v7.16B         // ......................................................*...
        eor v30.16B, v1.16B, v7.16B          // .......................................................*..
        eor v27.16B, v2.16B, v7.16B          // .......................................................*..
        eor v29.16B, v24.16B, v8.16B         // ........................................................*.
        fmov d8, x14                         // ........................................................*.
        eor v3.16B, v30.16B, v6.16B          // .........................................................*
        fmov d6, x8                          // .........................................................*
        eor v27.16B, v27.16B, v10.16B        // .........................................................*
        fmov d10, x7                         // .........................................................*

                                                               // ------------------- cycle (expected) -------------------->
                                                               // 0                        25                       50
                                                               // |------------------------|------------------------|-------
        // subs X<ssa_22>, x2, #0x50                           // *.........................................................
        // csel X<ssa_25>, xzr, X<ssa_22>, gt                  // .*........................................................
        // extr x22, x10, x10, #32                             // *.........................................................
        // and W<ssa_101>, w19, w22, asr #31                   // .*........................................................
        // eor X<ssa_108>, X<ssa_101>, x9, lsl #1              // ..*.......................................................
        // mov X<ssa_112>, x3                                  // *.........................................................
        // add x0, x0, X<ssa_25>                               // ..*.......................................................
        // extr x13, x10, x9, #63                              // *.........................................................
        // extr x6, x13, X<ssa_108>, #63                       // ...*......................................................
        // extr x22, x13, x13, #32                             // .*........................................................
        // and W<ssa_122>, w19, w22, asr #31                   // ..*.......................................................
        // extr x22, x6, x6, #32                               // ....*.....................................................
        // aese v1.16b, v16.16b                                // *.........................................................
        // eor X<ssa_123>, X<ssa_122>, X<ssa_108>, lsl #1      // ...*......................................................
        // and W<ssa_124>, w19, w22, asr #31                   // .....*....................................................
        // aese v25.16b, v16.16b                               // .*........................................................
        // aese v0.16b, v16.16b                                // .*........................................................
        // aesmc V<ssa_125>.16b, v1.16b                        // ..*.......................................................
        // subs X<ssa_127>, x2, #0x50                          // ..*.......................................................
        // aesmc V<ssa_129>.16b, v0.16b                        // ...*......................................................
        // csel x12, xzr, X<ssa_127>, gt                       // ....*.....................................................
        // aesmc V<ssa_130>.16b, v25.16b                       // ...*......................................................
        // aese V<ssa_125>.16b, v17.16b                        // ....*.....................................................
        // aese V<ssa_129>.16b, v17.16b                        // .....*....................................................
        // aese V<ssa_130>.16b, v17.16b                        // .....*....................................................
        // aese v26.16b, v16.16b                               // *.........................................................
        // aesmc V<ssa_133>.16b, V<ssa_125>.16b                // ......*...................................................
        // aesmc V<ssa_134>.16b, V<ssa_130>.16b                // .......*..................................................
        // aesmc V<ssa_135>.16b, V<ssa_129>.16b                // .......*..................................................
        // aesmc V<ssa_136>.16b, v26.16b                       // ..*.......................................................
        // aese V<ssa_133>.16b, v12.16b                        // ........*.................................................
        // aese V<ssa_134>.16b, v12.16b                        // .........*................................................
        // aese V<ssa_135>.16b, v12.16b                        // .........*................................................
        // aese V<ssa_136>.16b, v17.16b                        // ....*.....................................................
        // aesmc V<ssa_137>.16b, V<ssa_133>.16b                // ..........*...............................................
        // aesmc V<ssa_139>.16b, V<ssa_134>.16b                // ...........*..............................................
        // aesmc V<ssa_140>.16b, V<ssa_135>.16b                // ...........*..............................................
        // aese V<ssa_137>.16b, v13.16b                        // ............*.............................................
        // aesmc V<ssa_141>.16b, V<ssa_136>.16b                // ......*...................................................
        // aese V<ssa_139>.16b, v13.16b                        // .............*............................................
        // aese V<ssa_140>.16b, v13.16b                        // .............*............................................
        // aesmc V<ssa_143>.16b, V<ssa_137>.16b                // ..............*...........................................
        // aese V<ssa_141>.16b, v12.16b                        // ........*.................................................
        // aesmc V<ssa_144>.16b, V<ssa_139>.16b                // ...............*..........................................
        // aesmc V<ssa_145>.16b, V<ssa_140>.16b                // ...............*..........................................
        // aesmc V<ssa_146>.16b, V<ssa_141>.16b                // ..........*...............................................
        // aese V<ssa_143>.16b, v14.16b                        // ................*.........................................
        // aese V<ssa_144>.16b, v14.16b                        // .................*........................................
        // aese V<ssa_145>.16b, v14.16b                        // .................*........................................
        // aesmc V<ssa_148>.16b, V<ssa_143>.16b                // ..................*.......................................
        // aese V<ssa_146>.16b, v13.16b                        // ............*.............................................
        // aesmc V<ssa_149>.16b, V<ssa_144>.16b                // ...................*......................................
        // aesmc V<ssa_150>.16b, V<ssa_145>.16b                // ...................*......................................
        // aesmc V<ssa_151>.16b, V<ssa_146>.16b                // ..............*...........................................
        // aese V<ssa_148>.16b, v15.16b                        // ....................*.....................................
        // aese V<ssa_149>.16b, v15.16b                        // .....................*....................................
        // aese V<ssa_150>.16b, v15.16b                        // .....................*....................................
        // aesmc V<ssa_153>.16b, V<ssa_148>.16b                // ......................*...................................
        // aese V<ssa_151>.16b, v14.16b                        // ................*.........................................
        // aesmc V<ssa_154>.16b, V<ssa_149>.16b                // .......................*..................................
        // aesmc V<ssa_155>.16b, V<ssa_150>.16b                // .......................*..................................
        // aese V<ssa_153>.16b, v4.16b                         // ........................*.................................
        // aesmc V<ssa_156>.16b, V<ssa_151>.16b                // ..................*.......................................
        // aese V<ssa_154>.16b, v4.16b                         // .........................*................................
        // aese V<ssa_155>.16b, v4.16b                         // .........................*................................
        // aesmc V<ssa_158>.16b, V<ssa_153>.16b                // ..........................*...............................
        // aese V<ssa_156>.16b, v15.16b                        // ....................*.....................................
        // aesmc V<ssa_159>.16b, V<ssa_154>.16b                // ...........................*..............................
        // aesmc V<ssa_160>.16b, V<ssa_155>.16b                // ...........................*..............................
        // aese V<ssa_158>.16b, v5.16b                         // ............................*.............................
        // aesmc V<ssa_161>.16b, V<ssa_156>.16b                // ......................*...................................
        // aese V<ssa_160>.16b, v5.16b                         // .............................*............................
        // aese V<ssa_159>.16b, v5.16b                         // .............................*............................
        // aesmc V<ssa_163>.16b, V<ssa_158>.16b                // ..............................*...........................
        // aese V<ssa_161>.16b, v4.16b                         // ........................*.................................
        // aesmc V<ssa_164>.16b, V<ssa_160>.16b                // ...............................*..........................
        // aesmc V<ssa_165>.16b, V<ssa_159>.16b                // ...............................*..........................
        // aese V<ssa_163>.16b, v18.16b                        // ................................*.........................
        // aesmc V<ssa_167>.16b, V<ssa_161>.16b                // ..........................*...............................
        // aese V<ssa_165>.16b, v18.16b                        // .................................*........................
        // aese V<ssa_164>.16b, v18.16b                        // .................................*........................
        // eor x5, X<ssa_124>, X<ssa_123>, lsl #1              // ......*...................................................
        // aese V<ssa_167>.16b, v5.16b                         // ............................*.............................
        // aesmc V<ssa_168>.16b, V<ssa_163>.16b                // ..................................*.......................
        // aesmc V<ssa_169>.16b, V<ssa_165>.16b                // ...................................*......................
        // aesmc V<ssa_170>.16b, V<ssa_164>.16b                // ...................................*......................
        // extr x17, x6, X<ssa_123>, #63                       // ....*.....................................................
        // aesmc V<ssa_171>.16b, V<ssa_167>.16b                // ..............................*...........................
        // aese V<ssa_168>.16b, v19.16b                        // ....................................*.....................
        // extr x11, x17, x5, #63                              // .......*..................................................
        // extr x22, x17, x17, #32                             // .....*....................................................
        // aese V<ssa_169>.16b, v19.16b                        // .....................................*....................
        // and W<ssa_172>, w19, w22, asr #31                   // ......*...................................................
        // aese V<ssa_170>.16b, v19.16b                        // .....................................*....................
        // extr x22, x11, x11, #32                             // ........*.................................................
        // aesmc V<ssa_174>.16b, V<ssa_168>.16b                // ......................................*...................
        // eor X<ssa_175>, X<ssa_172>, x5, lsl #1              // .......*..................................................
        // aese V<ssa_171>.16b, v18.16b                        // ................................*.........................
        // aesmc V<ssa_176>.16b, V<ssa_169>.16b                // .......................................*..................
        // aesmc V<ssa_177>.16b, V<ssa_170>.16b                // .......................................*..................
        // and W<ssa_178>, w19, w22, asr #31                   // .........*................................................
        // aesmc V<ssa_179>.16b, V<ssa_171>.16b                // ..................................*.......................
        // aese V<ssa_174>.16b, v20.16b                        // ........................................*.................
        // aese v24.16b, v16.16b                               // .*........................................................
        // eor x9, X<ssa_178>, X<ssa_175>, lsl #1              // ..........*...............................................
        // aese V<ssa_177>.16b, v20.16b                        // .........................................*................
        // aese V<ssa_176>.16b, v20.16b                        // .........................................*................
        // extr x10, x11, X<ssa_175>, #63                      // ........*.................................................
        // aesmc V<ssa_180>.16b, v24.16b                       // ...*......................................................
        // aese V<ssa_179>.16b, v19.16b                        // ....................................*.....................
        // aesmc V<ssa_181>.16b, V<ssa_174>.16b                // ..........................................*...............
        // extr x22, x10, x10, #32                             // .........*................................................
        // aesmc V<ssa_182>.16b, V<ssa_176>.16b                // ...........................................*..............
        // aesmc V<ssa_183>.16b, V<ssa_177>.16b                // ...........................................*..............
        // aesmc V<ssa_184>.16b, V<ssa_179>.16b                // ......................................*...................
        // aese V<ssa_181>.16b, v21.16b                        // ............................................*.............
        // aese V<ssa_180>.16b, v17.16b                        // .....*....................................................
        // aese V<ssa_183>.16b, v21.16b                        // .............................................*............
        // aese V<ssa_182>.16b, v21.16b                        // .............................................*............
        // aesmc V<ssa_185>.16b, V<ssa_180>.16b                // .......*..................................................
        // aesmc V<ssa_186>.16b, V<ssa_181>.16b                // ..............................................*...........
        // aese V<ssa_184>.16b, v20.16b                        // ........................................*.................
        // aesmc V<ssa_187>.16b, V<ssa_182>.16b                // ...............................................*..........
        // aesmc V<ssa_188>.16b, V<ssa_183>.16b                // ...............................................*..........
        // aesmc V<ssa_189>.16b, V<ssa_184>.16b                // ..........................................*...............
        // aese V<ssa_186>.16b, v22.16b                        // ................................................*.........
        // aese V<ssa_185>.16b, v12.16b                        // .........*................................................
        // aese V<ssa_188>.16b, v22.16b                        // .................................................*........
        // aese V<ssa_187>.16b, v22.16b                        // .................................................*........
        // aese V<ssa_189>.16b, v21.16b                        // ............................................*.............
        // aesmc V<ssa_190>.16b, V<ssa_186>.16b                // ..................................................*.......
        // aesmc V<ssa_191>.16b, V<ssa_185>.16b                // ...........*..............................................
        // ld1 {v16.4S}, [X<ssa_112>], #16                     // ...*......................................................
        // aesmc V<ssa_192>.16b, V<ssa_188>.16b                // ...................................................*......
        // aesmc V<ssa_193>.16b, V<ssa_187>.16b                // ...................................................*......
        // aese V<ssa_190>.16b, v23.16b                        // ....................................................*.....
        // aese V<ssa_191>.16b, v13.16b                        // .............*............................................
        // aesmc V<ssa_194>.16b, V<ssa_189>.16b                // ..............................................*...........
        // aese V<ssa_193>.16b, v23.16b                        // .....................................................*....
        // aese V<ssa_192>.16b, v23.16b                        // .....................................................*....
        // aese V<ssa_194>.16b, v22.16b                        // ................................................*.........
        // ld1 {v17.4S}, [X<ssa_112>], #16                     // .....*....................................................
        // eor V<ssa_195>.16B, V<ssa_190>.16B, v7.16B          // ......................................................*...
        // aesmc v31.16b, V<ssa_191>.16b                       // ...............*..........................................
        // and W<ssa_196>, w19, w22, asr #31                   // ..........*...............................................
        // eor V<ssa_197>.16B, V<ssa_192>.16B, v7.16B          // .......................................................*..
        // eor V<ssa_198>.16B, V<ssa_193>.16B, v7.16B          // .......................................................*..
        // eor v29.16B, V<ssa_195>.16B, v8.16B                 // ........................................................*.
        // fmov d8, X<ssa_123>                                 // ........................................................*.
        // aese v31.16b, v14.16b                               // .................*........................................
        // aesmc v28.16b, V<ssa_194>.16b                       // ..................................................*.......
        // eor v3.16B, V<ssa_197>.16B, v6.16B                  // .........................................................*
        // fmov d6, X<ssa_108>                                 // .........................................................*
        // eor v27.16B, V<ssa_198>.16B, v10.16B                // .........................................................*
        // fmov d10, X<ssa_175>                                // .........................................................*
        // eor x4, X<ssa_196>, x9, lsl #1                      // ...........*..............................................

        sub x2, x2, #0
Loop5x_xts_enc:
                                             // Instructions:    194
                                             // Expected cycles: 64
                                             // Expected IPC:    3.03
                                             //
                                             // Cycle bound:     64.0
                                             // IPC bound:       3.03
                                             //
                                             // Wall time:     118.49s
                                             // User time:     118.49s
                                             //
                                             // ---------------------- cycle (expected) ----------------------->
                                             // 0                        25                       50
                                             // |------------------------|------------------------|-------------
        aesmc v0.16b, v31.16b                // l...............................................................
        ld1 {v2.16B}, [x0], #16              // l...............................................................
        ld1 {v1.16B}, [x0], #16              // l...............................................................
        aese v28.16b, v23.16b                // l...............................................................
        mov x15, x3                          // *...............................................................
        ld1 {v24.16B}, [x0], #16             // .l..............................................................
        fmov v8.d[1], x6                     // .l..............................................................
        ld1 {v25.16B}, [x0], #16             // .l..............................................................
        fmov v6.d[1], x13                    // ..l.............................................................
        eor v30.16B, v28.16B, v7.16B         // ..l.............................................................
        aese v0.16b, v15.16b                 // ..l.............................................................
        fmov v10.d[1], x11                   // ..l.............................................................
        ld1 {v26.16B}, [x0], #16             // ...l............................................................
        add x0, x0, x12                      // ...*............................................................
        extr x13, x10, x9, #63               // ...*............................................................
        aesmc v31.16b, v0.16b                // ....l...........................................................
        eor v30.16B, v30.16B, v11.16B        // ....l...........................................................
        fmov d11, x9                         // ....l...........................................................
        eor v1.16B, v1.16B, v8.16B           // ....l...........................................................
        extr x6, x13, x4, #63                // ....*...........................................................
        extr x22, x13, x13, #32              // ....*...........................................................
        eor v0.16B, v2.16B, v6.16B           // .....l..........................................................
        eor v25.16B, v25.16B, v10.16B        // .....l..........................................................
        and w7, w19, w22, asr #31            // .....*..........................................................
        extr x22, x6, x6, #32                // .....*..........................................................
        aese v31.16b, v4.16b                 // ......l.........................................................
        aese v1.16b, v16.16b                 // ......*.........................................................
        eor x7, x7, x4, lsl #1               // ......*.........................................................
        and w11, w19, w22, asr #31           // ......*.........................................................
        aese v25.16b, v16.16b                // .......*........................................................
        aese v0.16b, v16.16b                 // .......*........................................................
        fmov v11.d[1], x10                   // .......l........................................................
        aesmc v1.16b, v1.16b                 // ........*.......................................................
        aesmc v2.16b, v31.16b                // ........l.......................................................
        subs x10, x2, #0x50                  // ........e.......................................................
        stp q3, q29, [x1], #32               // .........l......................................................
        aesmc v0.16b, v0.16b                 // .........*......................................................
        csel x12, xzr, x10, gt               // .........e......................................................
        aesmc v28.16b, v25.16b               // .........*......................................................
        aese v2.16b, v5.16b                  // ..........l.....................................................
        aese v1.16b, v17.16b                 // ..........*.....................................................
        eor v26.16B, v26.16B, v11.16B        // ..........l.....................................................
        aese v0.16b, v17.16b                 // ...........*....................................................
        aese v28.16b, v17.16b                // ...........*....................................................
        aesmc v29.16b, v2.16b                // ............l...................................................
        aese v26.16b, v16.16b                // ............*...................................................
        aesmc v3.16b, v1.16b                 // ............*...................................................
        aesmc v28.16b, v28.16b               // .............*..................................................
        aesmc v31.16b, v0.16b                // .............*..................................................
        aese v29.16b, v18.16b                // ..............l.................................................
        aesmc v0.16b, v26.16b                // ..............*.................................................
        aese v3.16b, v12.16b                 // ..............*.................................................
        aese v28.16b, v12.16b                // ...............*................................................
        aese v31.16b, v12.16b                // ...............*................................................
        aese v0.16b, v17.16b                 // ................*...............................................
        aesmc v3.16b, v3.16b                 // ................*...............................................
        aesmc v2.16b, v29.16b                // ................l...............................................
        aesmc v25.16b, v28.16b               // .................*..............................................
        aesmc v31.16b, v31.16b               // .................*..............................................
        aese v2.16b, v19.16b                 // ..................l.............................................
        aese v3.16b, v13.16b                 // ..................*.............................................
        aesmc v26.16b, v0.16b                // ..................*.............................................
        aese v25.16b, v13.16b                // ...................*............................................
        aese v31.16b, v13.16b                // ...................*............................................
        aesmc v0.16b, v2.16b                 // ....................l...........................................
        aesmc v1.16b, v3.16b                 // ....................*...........................................
        aese v26.16b, v12.16b                // ....................*...........................................
        aesmc v28.16b, v25.16b               // .....................*..........................................
        aesmc v2.16b, v31.16b                // .....................*..........................................
        aesmc v3.16b, v26.16b                // ......................*.........................................
        aese v0.16b, v20.16b                 // ......................l.........................................
        aese v1.16b, v14.16b                 // ......................*.........................................
        aese v28.16b, v14.16b                // .......................*........................................
        aese v2.16b, v14.16b                 // .......................*........................................
        aesmc v0.16b, v0.16b                 // ........................l.......................................
        aesmc v1.16b, v1.16b                 // ........................*.......................................
        aese v3.16b, v13.16b                 // ........................*.......................................
        aesmc v25.16b, v28.16b               // .........................*......................................
        aesmc v26.16b, v2.16b                // .........................*......................................
        aese v0.16b, v21.16b                 // ..........................l.....................................
        aesmc v29.16b, v3.16b                // ..........................*.....................................
        aese v1.16b, v15.16b                 // ..........................*.....................................
        aese v25.16b, v15.16b                // ...........................*....................................
        aese v26.16b, v15.16b                // ...........................*....................................
        aesmc v2.16b, v0.16b                 // ............................l...................................
        aesmc v0.16b, v1.16b                 // ............................*...................................
        aese v29.16b, v14.16b                // ............................*...................................
        aesmc v3.16b, v25.16b                // .............................*..................................
        aesmc v1.16b, v26.16b                // .............................*..................................
        aese v0.16b, v4.16b                  // ..............................*.................................
        aese v2.16b, v22.16b                 // ..............................l.................................
        aesmc v25.16b, v29.16b               // ..............................*.................................
        aese v3.16b, v4.16b                  // ...............................*................................
        aese v1.16b, v4.16b                  // ...............................*................................
        aesmc v31.16b, v2.16b                // ................................l...............................
        aesmc v0.16b, v0.16b                 // ................................*...............................
        aese v25.16b, v15.16b                // ................................*...............................
        aesmc v28.16b, v3.16b                // .................................*..............................
        aesmc v29.16b, v1.16b                // .................................*..............................
        aese v0.16b, v5.16b                  // ..................................*.............................
        aesmc v1.16b, v25.16b                // ..................................*.............................
        aese v31.16b, v23.16b                // ..................................l.............................
        aese v29.16b, v5.16b                 // ...................................*............................
        aese v28.16b, v5.16b                 // ...................................*............................
        eor v2.16B, v31.16B, v7.16B          // ....................................l...........................
        aesmc v31.16b, v0.16b                // ....................................*...........................
        aese v1.16b, v4.16b                  // ....................................*...........................
        aesmc v29.16b, v29.16b               // .....................................*..........................
        aesmc v25.16b, v28.16b               // .....................................*..........................
        eor v0.16B, v2.16B, v9.16B           // ......................................l.........................
        fmov d9, x5                          // ......................................l.........................
        aese v31.16b, v18.16b                // ......................................*.........................
        aesmc v26.16b, v1.16b                // ......................................*.........................
        aese v25.16b, v18.16b                // .......................................*........................
        aese v29.16b, v18.16b                // .......................................*........................
        eor x5, x11, x7, lsl #1              // .......................................*........................
        aese v26.16b, v5.16b                 // ........................................*.......................
        stp q0, q27, [x1], #32               // ........................................l.......................
        aesmc v31.16b, v31.16b               // ........................................*.......................
        fmov v9.d[1], x17                    // .........................................l......................
        aesmc v27.16b, v25.16b               // .........................................*......................
        aesmc v29.16b, v29.16b               // .........................................*......................
        extr x17, x6, x7, #63                // .........................................*......................
        st1 {v30.16B}, [x1], #16             // ..........................................l.....................
        aesmc v3.16b, v26.16b                // ..........................................*.....................
        aese v31.16b, v19.16b                // ..........................................*.....................
        extr x11, x17, x5, #63               // ..........................................*.....................
        extr x22, x17, x17, #32              // ..........................................*.....................
        aese v27.16b, v19.16b                // ...........................................*....................
        and w14, w19, w22, asr #31           // ...........................................*....................
        aese v29.16b, v19.16b                // ...........................................*....................
        extr x22, x11, x11, #32              // ...........................................*....................
        eor v24.16B, v24.16B, v9.16B         // ............................................l...................
        aesmc v31.16b, v31.16b               // ............................................*...................
        eor x16, x14, x5, lsl #1             // ............................................*...................
        aese v3.16b, v18.16b                 // ............................................*...................
        aesmc v1.16b, v27.16b                // .............................................*..................
        aesmc v0.16b, v29.16b                // .............................................*..................
        and w10, w19, w22, asr #31           // .............................................*..................
        aesmc v28.16b, v3.16b                // ..............................................*.................
        aese v31.16b, v20.16b                // ..............................................*.................
        aese v24.16b, v16.16b                // ..............................................*.................
        eor x9, x10, x16, lsl #1             // ..............................................*.................
        aese v0.16b, v20.16b                 // ...............................................*................
        aese v1.16b, v20.16b                 // ...............................................*................
        extr x10, x11, x16, #63              // ...............................................*................
        aesmc v29.16b, v24.16b               // ................................................*...............
        aese v28.16b, v19.16b                // ................................................*...............
        aesmc v2.16b, v31.16b                // ................................................*...............
        extr x22, x10, x10, #32              // ................................................e...............
        aesmc v27.16b, v1.16b                // .................................................*..............
        aesmc v26.16b, v0.16b                // .................................................*..............
        aesmc v3.16b, v28.16b                // ..................................................*.............
        aese v2.16b, v21.16b                 // ..................................................*.............
        aese v29.16b, v17.16b                // ..................................................*.............
        aese v26.16b, v21.16b                // ...................................................*............
        aese v27.16b, v21.16b                // ...................................................*............
        aesmc v16.16b, v29.16b               // ....................................................*...........
        aesmc v2.16b, v2.16b                 // ....................................................*...........
        aese v3.16b, v20.16b                 // ....................................................*...........
        aesmc v24.16b, v27.16b               // .....................................................*..........
        aesmc v29.16b, v26.16b               // .....................................................*..........
        aesmc v30.16b, v3.16b                // ......................................................*.........
        aese v2.16b, v22.16b                 // ......................................................*.........
        aese v16.16b, v12.16b                // ......................................................*.........
        aese v29.16b, v22.16b                // .......................................................*........
        aese v24.16b, v22.16b                // .......................................................*........
        aese v30.16b, v21.16b                // ........................................................*.......
        aesmc v26.16b, v2.16b                // ........................................................*.......
        aesmc v3.16b, v16.16b                // ........................................................*.......
        ld1 {v16.4S}, [x15], #16             // .........................................................*......
        aesmc v29.16b, v29.16b               // .........................................................*......
        aesmc v27.16b, v24.16b               // .........................................................*......
        aese v26.16b, v23.16b                // ..........................................................*.....
        aese v3.16b, v13.16b                 // ..........................................................*.....
        aesmc v30.16b, v30.16b               // ..........................................................*.....
        aese v27.16b, v23.16b                // ...........................................................*....
        aese v29.16b, v23.16b                // ...........................................................*....
        aese v30.16b, v22.16b                // ............................................................*...
        ld1 {v17.4S}, [x15], #16             // ............................................................*...
        eor v24.16B, v26.16B, v7.16B         // ............................................................*...
        aesmc v31.16b, v3.16b                // ............................................................*...
        and w15, w19, w22, asr #31           // ............................................................e...
        eor v3.16B, v29.16B, v7.16B          // .............................................................*..
        eor v25.16B, v27.16B, v7.16B         // .............................................................*..
        eor v29.16B, v24.16B, v8.16B         // ..............................................................*.
        fmov d8, x7                          // ..............................................................*.
        aese v31.16b, v14.16b                // ..............................................................*.
        aesmc v28.16b, v30.16b               // ..............................................................*.
        eor v3.16B, v3.16B, v6.16B           // ...............................................................*
        fmov d6, x4                          // ...............................................................*
        eor v27.16B, v25.16B, v10.16B        // ...............................................................*
        fmov d10, x16                        // ...............................................................*
        eor x4, x15, x9, lsl #1              // ...............................................................e

                                              // ------------------------------------------------------------------------- cycle (expected) ------------------------------------------------------------------------->
                                              // 0                        25                       50                       75                       100                      125                      150
                                              // |------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|--------------
        // aese v0.16b,v16.16b                // ........................................................'......*........................................................'......~.....................................
        // aesmc v0.16b,v0.16b                // .~......................................................'........*......................................................'........~...................................
        // aese v1.16b,v16.16b                // ........................................................'.....*.........................................................'.....~......................................
        // aesmc v1.16b,v1.16b                // ~.......................................................'.......*.......................................................'.......~....................................
        // aese v24.16b,v16.16b               // ......................................~.................'.............................................*.................'............................................
        // aesmc v24.16b,v24.16b              // ........................................~...............'...............................................*...............'............................................
        // aese v25.16b,v16.16b               // ........................................................'......*........................................................'......~.....................................
        // aesmc v25.16b,v25.16b              // .~......................................................'........*......................................................'........~...................................
        // aese v26.16b,v16.16b               // ....~...................................................'...........*...................................................'...........~................................
        // aesmc v26.16b,v26.16b              // ......~.................................................'.............*.................................................'.............~..............................
        // subs x12,x2,#0x50                  // e.......................................................'.......~.......................................................'.......~....................................
        // aese v0.16b,v17.16b                // ...~....................................................'..........*....................................................'..........~.................................
        // aesmc v0.16b,v0.16b                // .....~..................................................'............*..................................................'............~...............................
        // aese v1.16b,v17.16b                // ..~.....................................................'.........*.....................................................'.........~..................................
        // aesmc v1.16b,v1.16b                // ....~...................................................'...........*...................................................'...........~................................
        // aese v24.16b,v17.16b               // ..........................................~.............'.................................................*.............'............................................
        // aesmc v24.16b,v24.16b              // ............................................~...........'...................................................*...........'............................................
        // aese v25.16b,v17.16b               // ...~....................................................'..........*....................................................'..........~.................................
        // aesmc v25.16b,v25.16b              // .....~..................................................'............*..................................................'............~...............................
        // aese v26.16b,v17.16b               // ........~...............................................'...............*...............................................'...............~............................
        // aesmc v26.16b,v26.16b              // ..........~.............................................'.................*.............................................'.................~..........................
        // csel x6,xzr,x12,gt                 // .e......................................................'........~......................................................'........~...................................
        // mov x7,x3                          // ........................................................*...............................................................~............................................
        // aese v0.16b,v12.16b                // .......~................................................'..............*................................................'..............~.............................
        // aesmc v0.16b,v0.16b                // .........~..............................................'................*..............................................'................~...........................
        // aese v1.16b,v12.16b                // ......~.................................................'.............*.................................................'.............~..............................
        // aesmc v1.16b,v1.16b                // ........~...............................................'...............*...............................................'...............~............................
        // aese v24.16b,v12.16b               // ..............................................~.........'.....................................................*.........'............................................
        // aesmc v24.16b,v24.16b              // ................................................~.......'.......................................................*.......'............................................
        // aese v25.16b,v12.16b               // .......~................................................'..............*................................................'..............~.............................
        // aesmc v25.16b,v25.16b              // .........~..............................................'................*..............................................'................~...........................
        // aese v26.16b,v12.16b               // ............~...........................................'...................*...........................................'...................~........................
        // aesmc v26.16b,v26.16b              // ..............~.........................................'.....................*.........................................'.....................~......................
        // aese v0.16b,v13.16b                // ...........~............................................'..................*............................................'..................~.........................
        // aesmc v0.16b,v0.16b                // .............~..........................................'....................*..........................................'....................~.......................
        // aese v1.16b,v13.16b                // ..........~.............................................'.................*.............................................'.................~..........................
        // aesmc v1.16b,v1.16b                // ............~...........................................'...................*...........................................'...................~........................
        // aese v24.16b,v13.16b               // ..................................................~.....'.........................................................*.....'............................................
        // aesmc v24.16b,v24.16b              // ....................................................~...'...........................................................*...'............................................
        // aese v25.16b,v13.16b               // ...........~............................................'..................*............................................'..................~.........................
        // aesmc v25.16b,v25.16b              // .............~..........................................'....................*..........................................'....................~.......................
        // aese v26.16b,v13.16b               // ................~.......................................'.......................*.......................................'.......................~....................
        // aesmc v26.16b,v26.16b              // ..................~.....................................'.........................*.....................................'.........................~..................
        // aese v0.16b,v14.16b                // ...............~........................................'......................*........................................'......................~.....................
        // aesmc v0.16b,v0.16b                // .................~......................................'........................*......................................'........................~...................
        // aese v1.16b,v14.16b                // ..............~.........................................'.....................*.........................................'.....................~......................
        // aesmc v1.16b,v1.16b                // ................~.......................................'.......................*.......................................'.......................~....................
        // aese v24.16b,v14.16b               // ......................................................~.'.............................................................*.'............................................
        // aesmc v24.16b,v24.16b              // ........................................................~...............................................................l............................................
        // aese v25.16b,v14.16b               // ...............~........................................'......................*........................................'......................~.....................
        // aesmc v25.16b,v25.16b              // .................~......................................'........................*......................................'........................~...................
        // aese v26.16b,v14.16b               // ....................~...................................'...........................*...................................'...........................~................
        // aesmc v26.16b,v26.16b              // ......................~.................................'.............................*.................................'.............................~..............
        // aese v0.16b,v15.16b                // ...................~....................................'..........................*....................................'..........................~.................
        // aesmc v0.16b,v0.16b                // .....................~..................................'............................*..................................'............................~...............
        // aese v1.16b,v15.16b                // ..................~.....................................'.........................*.....................................'.........................~..................
        // aesmc v1.16b,v1.16b                // ....................~...................................'...........................*...................................'...........................~................
        // aese v24.16b,v15.16b               // ........................................................'.~.............................................................'.l..........................................
        // aesmc v24.16b,v24.16b              // ........................................................'...~...........................................................'...l........................................
        // aese v25.16b,v15.16b               // ...................~....................................'..........................*....................................'..........................~.................
        // aesmc v25.16b,v25.16b              // .....................~..................................'............................*..................................'............................~...............
        // aese v26.16b,v15.16b               // ........................~...............................'...............................*...............................'...............................~............
        // aesmc v26.16b,v26.16b              // ..........................~.............................'.................................*.............................'.................................~..........
        // aese v0.16b,v4.16b                 // .......................~................................'..............................*................................'..............................~.............
        // aesmc v0.16b,v0.16b                // .........................~..............................'................................*..............................'................................~...........
        // aese v1.16b,v4.16b                 // ......................~.................................'.............................*.................................'.............................~..............
        // aesmc v1.16b,v1.16b                // ........................~...............................'...............................*...............................'...............................~............
        // aese v24.16b,v4.16b                // ........................................................'.....~.........................................................'.....l......................................
        // aesmc v24.16b,v24.16b              // ~.......................................................'.......~.......................................................'.......l....................................
        // aese v25.16b,v4.16b                // .......................~................................'..............................*................................'..............................~.............
        // aesmc v25.16b,v25.16b              // .........................~..............................'................................*..............................'................................~...........
        // aese v26.16b,v4.16b                // ............................~...........................'...................................*...........................'...................................~........
        // aesmc v26.16b,v26.16b              // ..............................~.........................'.....................................*.........................'.....................................~......
        // aese v0.16b,v5.16b                 // ...........................~............................'..................................*............................'..................................~.........
        // aesmc v0.16b,v0.16b                // .............................~..........................'....................................*..........................'....................................~.......
        // aese v1.16b,v5.16b                 // ..........................~.............................'.................................*.............................'.................................~..........
        // aesmc v1.16b,v1.16b                // ............................~...........................'...................................*...........................'...................................~........
        // aese v24.16b,v5.16b                // ..~.....................................................'.........~.....................................................'.........l..................................
        // aesmc v24.16b,v24.16b              // ....~...................................................'...........~...................................................'...........l................................
        // aese v25.16b,v5.16b                // ...........................~............................'..................................*............................'..................................~.........
        // aesmc v25.16b,v25.16b              // .............................~..........................'....................................*..........................'....................................~.......
        // aese v26.16b,v5.16b                // ................................~.......................'.......................................*.......................'.......................................~....
        // aesmc v26.16b,v26.16b              // ..................................~.....................'.........................................*.....................'.........................................~..
        // aese v0.16b,v18.16b                // ...............................~........................'......................................*........................'......................................~.....
        // aesmc v0.16b,v0.16b                // .................................~......................'........................................*......................'........................................~...
        // aese v1.16b,v18.16b                // ..............................~.........................'.....................................*.........................'.....................................~......
        // aesmc v1.16b,v1.16b                // ................................~.......................'.......................................*.......................'.......................................~....
        // aese v24.16b,v18.16b               // ......~.................................................'.............~.................................................'.............l..............................
        // aesmc v24.16b,v24.16b              // ........~...............................................'...............~...............................................'...............l............................
        // aese v25.16b,v18.16b               // ...............................~........................'......................................*........................'......................................~.....
        // aesmc v25.16b,v25.16b              // .................................~......................'........................................*......................'........................................~...
        // aese v26.16b,v18.16b               // ....................................~...................'...........................................*...................'............................................
        // aesmc v26.16b,v26.16b              // ......................................~.................'.............................................*.................'............................................
        // add x0,x0,x6                       // ........................................................'..*............................................................'..~.........................................
        // aese v0.16b,v19.16b                // ...................................~....................'..........................................*....................'..........................................~.
        // aesmc v0.16b,v0.16b                // .....................................~..................'............................................*..................'............................................
        // aese v1.16b,v19.16b                // ..................................~.....................'.........................................*.....................'.........................................~..
        // aesmc v1.16b,v1.16b                // ....................................~...................'...........................................*...................'............................................
        // aese v24.16b,v19.16b               // ..........~.............................................'.................~.............................................'.................l..........................
        // aesmc v24.16b,v24.16b              // ............~...........................................'...................~...........................................'...................l........................
        // aese v25.16b,v19.16b               // ...................................~....................'..........................................*....................'..........................................~.
        // aesmc v25.16b,v25.16b              // .....................................~..................'............................................*..................'............................................
        // aese v26.16b,v19.16b               // ........................................~...............'...............................................*...............'............................................
        // aesmc v26.16b,v26.16b              // ..........................................~.............'.................................................*.............'............................................
        // aese v0.16b,v20.16b                // .......................................~................'..............................................*................'............................................
        // aesmc v0.16b,v0.16b                // .........................................~..............'................................................*..............'............................................
        // aese v1.16b,v20.16b                // ......................................~.................'.............................................*.................'............................................
        // aesmc v1.16b,v1.16b                // ........................................~...............'...............................................*...............'............................................
        // aese v24.16b,v20.16b               // ..............~.........................................'.....................~.........................................'.....................l......................
        // aesmc v24.16b,v24.16b              // ................~.......................................'.......................~.......................................'.......................l....................
        // aese v25.16b,v20.16b               // .......................................~................'..............................................*................'............................................
        // aesmc v25.16b,v25.16b              // .........................................~..............'................................................*..............'............................................
        // aese v26.16b,v20.16b               // ............................................~...........'...................................................*...........'............................................
        // aesmc v26.16b,v26.16b              // ..............................................~.........'.....................................................*.........'............................................
        // aese v0.16b,v21.16b                // ...........................................~............'..................................................*............'............................................
        // aesmc v0.16b,v0.16b                // .............................................~..........'....................................................*..........'............................................
        // aese v1.16b,v21.16b                // ..........................................~.............'.................................................*.............'............................................
        // aesmc v1.16b,v1.16b                // ............................................~...........'...................................................*...........'............................................
        // aese v24.16b,v21.16b               // ..................~.....................................'.........................~.....................................'.........................l..................
        // aesmc v24.16b,v24.16b              // ....................~...................................'...........................~...................................'...........................l................
        // aese v25.16b,v21.16b               // ...........................................~............'..................................................*............'............................................
        // aesmc v25.16b,v25.16b              // .............................................~..........'....................................................*..........'............................................
        // aese v26.16b,v21.16b               // ................................................~.......'.......................................................*.......'............................................
        // aesmc v26.16b,v26.16b              // ..................................................~.....'.........................................................*.....'............................................
        // aese v0.16b,v22.16b                // ...............................................~........'......................................................*........'............................................
        // aesmc v0.16b,v0.16b                // .................................................~......'........................................................*......'............................................
        // aese v1.16b,v22.16b                // ..............................................~.........'.....................................................*.........'............................................
        // aesmc v1.16b,v1.16b                // ................................................~.......'.......................................................*.......'............................................
        // aese v24.16b,v22.16b               // ......................~.................................'.............................~.................................'.............................l..............
        // aesmc v24.16b,v24.16b              // ........................~...............................'...............................~...............................'...............................l............
        // aese v25.16b,v22.16b               // ...............................................~........'......................................................*........'............................................
        // aesmc v25.16b,v25.16b              // .................................................~......'........................................................*......'............................................
        // aese v26.16b,v22.16b               // ....................................................~...'...........................................................*...'............................................
        // aesmc v26.16b,v26.16b              // ......................................................~.'.............................................................*.'............................................
        // aese v0.16b,v23.16b                // ...................................................~....'..........................................................*....'............................................
        // aese v1.16b,v23.16b                // ..................................................~.....'.........................................................*.....'............................................
        // aese v24.16b,v23.16b               // ..........................~.............................'.................................~.............................'.................................l..........
        // aese v25.16b,v23.16b               // ...................................................~....'..........................................................*....'............................................
        // aese v26.16b,v23.16b               // ........................................................~...............................................................l............................................
        // eor v0.16b,v0.16b,v7.16b           // .....................................................~..'............................................................*..'............................................
        // eor v0.16b,v0.16b,v6.16b           // .......................................................~'..............................................................*'............................................
        // extr x22,x10,x10,#32               // ........................................e...............'...............................................~...............'............................................
        // extr x10,x10,x9,#63                // ........................................................'..*............................................................'..~.........................................
        // and w11,w19,w22,asr#31             // ....................................................e...'...........................................................~...'............................................
        // eor x9,x11,x9,lsl#1                // .......................................................e'..............................................................~'............................................
        // fmov d6,x9                         // .......................................................~'..............................................................*'............................................
        // fmov v6.d[1],x10                   // ........................................................'.~.............................................................'.l..........................................
        // eor v1.16b,v1.16b,v7.16b           // ....................................................~...'...........................................................*...'............................................
        // eor v1.16b,v1.16b,v8.16b           // ......................................................~.'.............................................................*.'............................................
        // ld1 {v2.16b},[x0],#16              // ........................................................~...............................................................l............................................
        // extr x22,x10,x10,#32               // ........................................................'...*...........................................................'...~........................................
        // extr x10,x10,x9,#63                // ........................................................'...*...........................................................'...~........................................
        // and w11,w19,w22,asr#31             // ........................................................'....*..........................................................'....~.......................................
        // eor x9,x11,x9,lsl#1                // ........................................................'.....*.........................................................'.....~......................................
        // fmov d8,x9                         // ......................................................~.'.............................................................*.'............................................
        // fmov v8.d[1],x10                   // ........................................................'~..............................................................'l...........................................
        // eor v24.16b,v24.16b,v7.16b         // ............................~...........................'...................................~...........................'...................................l........
        // eor v24.16b,v24.16b,v9.16b         // ..............................~.........................'.....................................~.........................'.....................................l......
        // ld1 {v3.16b},[x0],#16              // ........................................................~...............................................................l............................................
        // extr x22,x10,x10,#32               // ........................................................'....*..........................................................'....~.......................................
        // extr x10,x10,x9,#63                // .................................~......................'........................................*......................'........................................~...
        // and w11,w19,w22,asr#31             // ........................................................'.....*.........................................................'.....~......................................
        // eor x9,x11,x9,lsl#1                // ...............................~........................'......................................*........................'......................................~.....
        // fmov d9,x9                         // ..............................~.........................'.....................................~.........................'.....................................l......
        // fmov v9.d[1],x10                   // .................................~......................'........................................~......................'........................................l...
        // eor v25.16b,v25.16b,v7.16b         // .....................................................~..'............................................................*..'............................................
        // eor v25.16b,v25.16b,v10.16b        // .......................................................~'..............................................................*'............................................
        // ld1 {v27.16b},[x0],#16             // ........................................................'~..............................................................'l...........................................
        // extr x22,x10,x10,#32               // ..................................~.....................'.........................................*.....................'.........................................~..
        // extr x10,x10,x9,#63                // ..................................~.....................'.........................................*.....................'.........................................~..
        // and w11,w19,w22,asr#31             // ...................................~....................'..........................................*....................'..........................................~.
        // eor x9,x11,x9,lsl#1                // ....................................~...................'...........................................*...................'............................................
        // fmov d10,x9                        // .......................................................~'..............................................................*'............................................
        // fmov v10.d[1],x10                  // ........................................................'.~.............................................................'.l..........................................
        // eor v26.16b,v26.16b,v7.16b         // ........................................................'.~.............................................................'.l..........................................
        // eor v26.16b,v26.16b,v11.16b        // ........................................................'...~...........................................................'...l........................................
        // ld1 {v28.16b},[x0],#16             // ........................................................'~..............................................................'l...........................................
        // extr x22,x10,x10,#32               // ...................................~....................'..........................................*....................'..........................................~.
        // extr x10,x10,x9,#63                // .......................................~................'..............................................*................'............................................
        // and w11,w19,w22,asr #31            // .....................................~..................'............................................*..................'............................................
        // eor x9,x11,x9,lsl #1               // ......................................~.................'.............................................*.................'............................................
        // fmov d11,x9                        // ........................................................'...~...........................................................'...l........................................
        // fmov v11.d[1],x10                  // ........................................................'......~........................................................'......l.....................................
        // ld1 {v29.16b},[x0],#16             // ........................................................'..~............................................................'..l.........................................
        // stp q0, q1, [x1], #32              // .~......................................................'........~......................................................'........l...................................
        // stp q24, q25, [x1], #32            // ................................~.......................'.......................................~.......................'.......................................l....
        // st1 {v26.16b},[x1],#16             // ..................................~.....................'.........................................~.....................'.........................................l..
        // eor v0.16b,v2.16b,v6.16b           // ........................................................'....~..........................................................'....l.......................................
        // eor v1.16b,v3.16b,v8.16b           // ........................................................'...~...........................................................'...l........................................
        // eor v24.16b,v27.16b,v9.16b         // ....................................~...................'...........................................~...................'...........................................l
        // eor v25.16b,v28.16b,v10.16b        // ........................................................'....~..........................................................'....l.......................................
        // eor v26.16b,v29.16b,v11.16b        // ..~.....................................................'.........~.....................................................'.........l..................................
        // ld1 {v16.4s},[x7],#16              // .................................................~......'........................................................*......'............................................
        // ld1 {v17.4s},[x7],#16              // ....................................................~...'...........................................................*...'............................................

        subs x2, x2, 0
        b.hs Loop5x_xts_enc
                                             // Instructions:    232
                                             // Expected cycles: 70
                                             // Expected IPC:    3.31
                                             //
                                             // Cycle bound:     70.0
                                             // IPC bound:       3.31
                                             //
                                             // Wall time:     13.82s
                                             // User time:     13.82s
                                             //
                                             // ------------------------- cycle (expected) -------------------------->
                                             // 0                        25                       50
                                             // |------------------------|------------------------|-------------------
        ld1 {v26.16B}, [x0], #16             // *.....................................................................
        aesmc v25.16b, v31.16b               // *.....................................................................
        fmov v6.d[1], x13                    // *.....................................................................
        ld1 {v24.16B}, [x0], #16             // *.....................................................................
        mov x13, x3                          // *.....................................................................
        ld1 {v0.16B}, [x0], #16              // .*....................................................................
        ld1 {v1.16B}, [x0], #16              // .*....................................................................
        fmov v8.d[1], x6                     // .*....................................................................
        fmov d30, x5                         // .*....................................................................
        aese v25.16b, v15.16b                // ..*...................................................................
        fmov v10.d[1], x11                   // ..*...................................................................
        extr x5, x10, x9, #63                // ..*...................................................................
        stp q3, q29, [x1], #32               // ...*..................................................................
        extr x22, x5, x5, #32                // ...*..................................................................
        fmov d31, x9                         // ...*..................................................................
        extr x7, x5, x4, #63                 // ...*..................................................................
        fmov v30.d[1], x17                   // ....*.................................................................
        eor v29.16B, v24.16B, v8.16B         // ....*.................................................................
        eor v24.16B, v26.16B, v6.16B         // ....*.................................................................
        aesmc v26.16b, v25.16b               // ....*.................................................................
        and w15, w19, w22, asr #31           // ....*.................................................................
        ld1 {v2.16B}, [x0], #16              // .....*................................................................
        eor v25.16B, v1.16B, v10.16B         // .....*................................................................
        add x0, x0, x12                      // .....*................................................................
        eor x8, x15, x4, lsl #1              // .....*................................................................
        extr x22, x7, x7, #32                // .....*................................................................
        aese v26.16b, v4.16b                 // ......*...............................................................
        aese v29.16b, v16.16b                // ......*...............................................................
        fmov v31.d[1], x10                   // ......*...............................................................
        aese v24.16b, v16.16b                // ......*...............................................................
        and w10, w19, w22, asr #31           // ......*...............................................................
        extr x6, x7, x8, #63                 // ......*...............................................................
        eor v3.16B, v0.16B, v30.16B          // .......*..............................................................
        aese v25.16b, v16.16b                // .......*..............................................................
        eor x11, x10, x8, lsl #1             // .......*..............................................................
        aesmc v1.16b, v26.16b                // ........*.............................................................
        aesmc v0.16b, v29.16b                // ........*.............................................................
        extr x17, x6, x11, #63               // ........*.............................................................
        aesmc v26.16b, v24.16b               // ........*.............................................................
        eor v24.16B, v2.16B, v31.16B         // .........*............................................................
        aesmc v29.16b, v25.16b               // .........*............................................................
        aese v3.16b, v16.16b                 // .........*............................................................
        extr x22, x17, x17, #32              // .........*............................................................
        aese v1.16b, v5.16b                  // ..........*...........................................................
        aese v0.16b, v17.16b                 // ..........*...........................................................
        aese v26.16b, v17.16b                // ..........*...........................................................
        aese v29.16b, v17.16b                // ...........*..........................................................
        aesmc v3.16b, v3.16b                 // ...........*..........................................................
        aese v24.16b, v16.16b                // ...........*..........................................................
        aesmc v2.16b, v0.16b                 // ............*.........................................................
        aesmc v0.16b, v26.16b                // ............*.........................................................
        aesmc v1.16b, v1.16b                 // ............*.........................................................
        aesmc v25.16b, v24.16b               // .............*........................................................
        aesmc v24.16b, v29.16b               // .............*........................................................
        aese v3.16b, v17.16b                 // .............*........................................................
        aese v1.16b, v18.16b                 // ..............*.......................................................
        aese v2.16b, v12.16b                 // ..............*.......................................................
        aese v0.16b, v12.16b                 // ..............*.......................................................
        aese v24.16b, v12.16b                // ...............*......................................................
        aesmc v3.16b, v3.16b                 // ...............*......................................................
        aese v25.16b, v17.16b                // ...............*......................................................
        aesmc v0.16b, v0.16b                 // ................*.....................................................
        aesmc v29.16b, v2.16b                // ................*.....................................................
        aesmc v26.16b, v1.16b                // ................*.....................................................
        aesmc v2.16b, v25.16b                // .................*....................................................
        aese v3.16b, v12.16b                 // .................*....................................................
        aesmc v25.16b, v24.16b               // .................*....................................................
        aese v29.16b, v13.16b                // ..................*...................................................
        aese v0.16b, v13.16b                 // ..................*...................................................
        aese v26.16b, v19.16b                // ..................*...................................................
        aese v28.16b, v23.16b                // ...................*..................................................
        aesmc v3.16b, v3.16b                 // ...................*..................................................
        aese v2.16b, v12.16b                 // ...................*..................................................
        aese v25.16b, v13.16b                // ...................*..................................................
        aesmc v24.16b, v26.16b               // ....................*.................................................
        aesmc v29.16b, v29.16b               // ....................*.................................................
        aesmc v17.16b, v0.16b                // ....................*.................................................
        aesmc v0.16b, v25.16b                // .....................*................................................
        aese v3.16b, v13.16b                 // .....................*................................................
        aesmc v16.16b, v2.16b                // .....................*................................................
        aese v17.16b, v14.16b                // ......................*...............................................
        aese v24.16b, v20.16b                // ......................*...............................................
        aese v29.16b, v14.16b                // ......................*...............................................
        aese v0.16b, v14.16b                 // .......................*..............................................
        aese v16.16b, v13.16b                // .......................*..............................................
        aesmc v2.16b, v3.16b                 // .......................*..............................................
        aesmc v26.16b, v24.16b               // ........................*.............................................
        aesmc v1.16b, v29.16b                // ........................*.............................................
        aesmc v24.16b, v17.16b               // ........................*.............................................
        aese v2.16b, v14.16b                 // .........................*............................................
        aesmc v3.16b, v0.16b                 // .........................*............................................
        aesmc v17.16b, v16.16b               // .........................*............................................
        eor v29.16B, v28.16B, v7.16B         // ..........................*...........................................
        aese v26.16b, v21.16b                // ..........................*...........................................
        aese v24.16b, v15.16b                // ..........................*...........................................
        aese v1.16b, v15.16b                 // ..........................*...........................................
        aese v3.16b, v15.16b                 // ...........................*..........................................
        aesmc v28.16b, v2.16b                // ...........................*..........................................
        aese v17.16b, v14.16b                // ...........................*..........................................
        eor v25.16B, v29.16B, v11.16B        // ............................*.........................................
        aesmc v1.16b, v1.16b                 // ............................*.........................................
        aesmc v0.16b, v26.16b                // ............................*.........................................
        aesmc v24.16b, v24.16b               // ............................*.........................................
        aese v28.16b, v15.16b                // .............................*........................................
        aesmc v11.16b, v3.16b                // .............................*........................................
        aesmc v16.16b, v17.16b               // .............................*........................................
        aese v24.16b, v4.16b                 // ..............................*.......................................
        aese v0.16b, v22.16b                 // ..............................*.......................................
        aese v1.16b, v4.16b                  // ..............................*.......................................
        aese v16.16b, v15.16b                // ...............................*......................................
        aesmc v17.16b, v28.16b               // ...............................*......................................
        aese v11.16b, v4.16b                 // ...............................*......................................
        aesmc v26.16b, v0.16b                // ................................*.....................................
        aesmc v24.16b, v24.16b               // ................................*.....................................
        aesmc v29.16b, v1.16b                // ................................*.....................................
        aesmc v3.16b, v11.16b                // .................................*....................................
        aese v17.16b, v4.16b                 // .................................*....................................
        aesmc v28.16b, v16.16b               // .................................*....................................
        aese v26.16b, v23.16b                // ..................................*...................................
        aese v24.16b, v5.16b                 // ..................................*...................................
        aese v29.16b, v5.16b                 // ..................................*...................................
        aese v3.16b, v5.16b                  // ...................................*..................................
        aesmc v17.16b, v17.16b               // ...................................*..................................
        aese v28.16b, v4.16b                 // ...................................*..................................
        eor v0.16B, v26.16B, v7.16B          // ....................................*.................................
        ld1 {v16.4S}, [x13], #16             // ....................................*.................................
        aesmc v1.16b, v29.16b                // ....................................*.................................
        aesmc v29.16b, v24.16b               // ....................................*.................................
        ld1 {v2.16B}, [x0], #16              // .....................................*................................
        aese v17.16b, v5.16b                 // .....................................*................................
        aesmc v11.16b, v3.16b                // .....................................*................................
        aesmc v24.16b, v28.16b               // .....................................*................................
        eor v3.16B, v0.16B, v9.16B           // ......................................*...............................
        fmov d9, x11                         // ......................................*...............................
        aese v1.16b, v18.16b                 // ......................................*...............................
        aese v29.16b, v18.16b                // ......................................*...............................
        aesmc v26.16b, v17.16b               // .......................................*..............................
        aese v11.16b, v18.16b                // .......................................*..............................
        aese v24.16b, v5.16b                 // .......................................*..............................
        and w16, w19, w22, asr #31           // .......................................*..............................
        extr x22, x6, x6, #32                // .......................................*..............................
        aesmc v1.16b, v1.16b                 // ........................................*.............................
        aesmc v17.16b, v29.16b               // ........................................*.............................
        stp q3, q27, [x1], #32               // ........................................*.............................
        aese v26.16b, v18.16b                // .........................................*............................
        aesmc v28.16b, v24.16b               // .........................................*............................
        aesmc v0.16b, v11.16b                // .........................................*............................
        ld1 {v27.16B}, [x0], #16             // ..........................................*...........................
        fmov v9.d[1], x6                     // ..........................................*...........................
        aese v17.16b, v19.16b                // ..........................................*...........................
        aese v1.16b, v19.16b                 // ..........................................*...........................
        and w6, w19, w22, asr #31            // ..........................................*...........................
        aesmc v29.16b, v26.16b               // ...........................................*..........................
        st1 {v25.16B}, [x1], #16             // ...........................................*..........................
        aese v0.16b, v19.16b                 // ...........................................*..........................
        aese v28.16b, v18.16b                // ...........................................*..........................
        eor x15, x6, x11, lsl #1             // ...........................................*..........................
        aesmc v24.16b, v17.16b               // ............................................*.........................
        ld1 {v11.16B}, [x0], #16             // ............................................*.........................
        aesmc v26.16b, v1.16b                // ............................................*.........................
        eor x9, x16, x15, lsl #1             // ............................................*.........................
        extr x10, x17, x15, #63              // ............................................*.........................
        aesmc v25.16b, v28.16b               // .............................................*........................
        aese v29.16b, v19.16b                // .............................................*........................
        aesmc v3.16b, v0.16b                 // .............................................*........................
        aese v24.16b, v20.16b                // ..............................................*.......................
        aese v26.16b, v20.16b                // ..............................................*.......................
        aesmc v0.16b, v29.16b                // ...............................................*......................
        aese v25.16b, v19.16b                // ...............................................*......................
        aese v3.16b, v20.16b                 // ...............................................*......................
        aesmc v17.16b, v24.16b               // ................................................*.....................
        eor v24.16B, v11.16B, v9.16B         // ................................................*.....................
        aesmc v26.16b, v26.16b               // ................................................*.....................
        aese v0.16b, v20.16b                 // .................................................*....................
        aesmc v29.16b, v3.16b                // .................................................*....................
        aesmc v3.16b, v25.16b                // .................................................*....................
        fmov d11, x9                         // ..................................................*...................
        aese v26.16b, v21.16b                // ..................................................*...................
        aese v17.16b, v21.16b                // ..................................................*...................
        aese v3.16b, v20.16b                 // ...................................................*..................
        aesmc v28.16b, v0.16b                // ...................................................*..................
        aese v29.16b, v21.16b                // ...................................................*..................
        aesmc v17.16b, v17.16b               // ....................................................*.................
        aesmc v1.16b, v26.16b                // ....................................................*.................
        aesmc v26.16b, v29.16b               // .....................................................*................
        aese v28.16b, v21.16b                // .....................................................*................
        aesmc v3.16b, v3.16b                 // .....................................................*................
        aese v1.16b, v22.16b                 // ......................................................*...............
        aese v17.16b, v22.16b                // ......................................................*...............
        fmov v11.d[1], x10                   // .......................................................*..............
        aese v26.16b, v22.16b                // .......................................................*..............
        aesmc v29.16b, v28.16b               // .......................................................*..............
        aese v3.16b, v21.16b                 // .......................................................*..............
        aesmc v0.16b, v17.16b                // ........................................................*.............
        aesmc v28.16b, v1.16b                // ........................................................*.............
        aesmc v3.16b, v3.16b                 // .........................................................*............
        aese v29.16b, v22.16b                // .........................................................*............
        aesmc v17.16b, v26.16b               // .........................................................*............
        ld1 {v1.16B}, [x0], #16              // ..........................................................*...........
        aese v0.16b, v23.16b                 // ..........................................................*...........
        aese v28.16b, v23.16b                // ..........................................................*...........
        aese v3.16b, v22.16b                 // ...........................................................*..........
        aesmc v29.16b, v29.16b               // ...........................................................*..........
        ld1 {v25.16B}, [x0], #16             // ...........................................................*..........
        aese v17.16b, v23.16b                // ...........................................................*..........
        eor v26.16B, v28.16B, v7.16B         // ............................................................*.........
        eor v0.16B, v0.16B, v7.16B           // ............................................................*.........
        aesmc v28.16b, v3.16b                // .............................................................*........
        aese v29.16b, v23.16b                // .............................................................*........
        eor v17.16B, v17.16B, v7.16B         // .............................................................*........
        eor v3.16B, v0.16B, v6.16B           // ..............................................................*.......
        fmov d6, x4                          // ..............................................................*.......
        eor v26.16B, v26.16B, v8.16B         // ..............................................................*.......
        fmov d8, x8                          // ..............................................................*.......
        eor v0.16B, v29.16B, v7.16B          // ...............................................................*......
        aese v28.16b, v23.16b                // ...............................................................*......
        eor v29.16B, v17.16B, v10.16B        // ...............................................................*......
        fmov d10, x15                        // ...............................................................*......
        stp q3, q26, [x1], #32               // ................................................................*.....
        eor v26.16B, v25.16B, v11.16B        // ................................................................*.....
        fmov v8.d[1], x7                     // .................................................................*....
        fmov v6.d[1], x5                     // .................................................................*....
        eor v25.16B, v0.16B, v30.16B         // .................................................................*....
        eor v3.16B, v28.16B, v7.16B          // .................................................................*....
        fmov v10.d[1], x17                   // ..................................................................*...
        ld1 {v17.4S}, [x13], #16             // ..................................................................*...
        eor v3.16B, v3.16B, v31.16B          // ...................................................................*..
        stp q25, q29, [x1], #32              // ...................................................................*..
        eor v0.16B, v2.16B, v6.16B           // ....................................................................*.
        st1 {v3.16B}, [x1], #16              // .....................................................................*
        eor v25.16B, v1.16B, v10.16B         // .....................................................................*
        eor v1.16B, v27.16B, v8.16B          // .....................................................................*

                                                                  // ------------------------- cycle (expected) -------------------------->
                                                                  // 0                        25                       50
                                                                  // |------------------------|------------------------|-------------------
        // aesmc V<ssa_0>.16b, v31.16b                            // *.....................................................................
        // ld1 {V<ssa_1>.16B}, [x0], #16                          // *.....................................................................
        // ld1 {V<ssa_2>.16B}, [x0], #16                          // *.....................................................................
        // aese v28.16b, v23.16b                                  // ...................*..................................................
        // mov X<ssa_3>, x3                                       // *.....................................................................
        // ld1 {V<ssa_4>.16B}, [x0], #16                          // .*....................................................................
        // fmov v8.d[1], x6                                       // .*....................................................................
        // ld1 {V<ssa_5>.16B}, [x0], #16                          // .*....................................................................
        // fmov v6.d[1], x13                                      // *.....................................................................
        // eor V<ssa_6>.16B, v28.16B, v7.16B                      // ..........................*...........................................
        // aese V<ssa_0>.16b, v15.16b                             // ..*...................................................................
        // fmov v10.d[1], x11                                     // ..*...................................................................
        // ld1 {V<ssa_7>.16B}, [x0], #16                          // .....*................................................................
        // add x0, x0, x12                                        // .....*................................................................
        // extr X<ssa_9>, x10, x9, #63                            // ..*...................................................................
        // aesmc V<ssa_10>.16b, V<ssa_0>.16b                      // ....*.................................................................
        // eor V<ssa_11>.16B, V<ssa_6>.16B, v11.16B               // ............................*.........................................
        // fmov D<ssa_12>, x9                                     // ...*..................................................................
        // eor V<ssa_13>.16B, V<ssa_2>.16B, v8.16B                // ....*.................................................................
        // extr X<ssa_14>, X<ssa_9>, x4, #63                      // ...*..................................................................
        // extr x22, X<ssa_9>, X<ssa_9>, #32                      // ...*..................................................................
        // eor V<ssa_15>.16B, V<ssa_1>.16B, v6.16B                // ....*.................................................................
        // eor V<ssa_16>.16B, V<ssa_5>.16B, v10.16B               // .....*................................................................
        // and W<ssa_17>, w19, w22, asr #31                       // ....*.................................................................
        // extr x22, X<ssa_14>, X<ssa_14>, #32                    // .....*................................................................
        // aese V<ssa_10>.16b, v4.16b                             // ......*...............................................................
        // aese V<ssa_13>.16b, v16.16b                            // ......*...............................................................
        // eor X<ssa_18>, X<ssa_17>, x4, lsl #1                   // .....*................................................................
        // and W<ssa_19>, w19, w22, asr #31                       // ......*...............................................................
        // aese V<ssa_16>.16b, v16.16b                            // .......*..............................................................
        // aese V<ssa_15>.16b, v16.16b                            // ......*...............................................................
        // fmov V<ssa_12>.d[1], x10                               // ......*...............................................................
        // aesmc V<ssa_20>.16b, V<ssa_13>.16b                     // ........*.............................................................
        // aesmc V<ssa_21>.16b, V<ssa_10>.16b                     // ........*.............................................................
        // stp q3, q29, [x1], #32                                 // ...*..................................................................
        // aesmc V<ssa_24>.16b, V<ssa_15>.16b                     // ........*.............................................................
        // aesmc V<ssa_26>.16b, V<ssa_16>.16b                     // .........*............................................................
        // aese V<ssa_21>.16b, v5.16b                             // ..........*...........................................................
        // aese V<ssa_20>.16b, v17.16b                            // ..........*...........................................................
        // eor V<ssa_27>.16B, V<ssa_7>.16B, V<ssa_12>.16B         // .........*............................................................
        // aese V<ssa_24>.16b, v17.16b                            // ..........*...........................................................
        // aese V<ssa_26>.16b, v17.16b                            // ...........*..........................................................
        // aesmc V<ssa_28>.16b, V<ssa_21>.16b                     // ............*.........................................................
        // aese V<ssa_27>.16b, v16.16b                            // ...........*..........................................................
        // aesmc V<ssa_29>.16b, V<ssa_20>.16b                     // ............*.........................................................
        // aesmc V<ssa_30>.16b, V<ssa_26>.16b                     // .............*........................................................
        // aesmc V<ssa_31>.16b, V<ssa_24>.16b                     // ............*.........................................................
        // aese V<ssa_28>.16b, v18.16b                            // ..............*.......................................................
        // aesmc V<ssa_32>.16b, V<ssa_27>.16b                     // .............*........................................................
        // aese V<ssa_29>.16b, v12.16b                            // ..............*.......................................................
        // aese V<ssa_30>.16b, v12.16b                            // ...............*......................................................
        // aese V<ssa_31>.16b, v12.16b                            // ..............*.......................................................
        // aese V<ssa_32>.16b, v17.16b                            // ...............*......................................................
        // aesmc V<ssa_33>.16b, V<ssa_29>.16b                     // ................*.....................................................
        // aesmc V<ssa_34>.16b, V<ssa_28>.16b                     // ................*.....................................................
        // aesmc V<ssa_35>.16b, V<ssa_30>.16b                     // .................*....................................................
        // aesmc V<ssa_36>.16b, V<ssa_31>.16b                     // ................*.....................................................
        // aese V<ssa_34>.16b, v19.16b                            // ..................*...................................................
        // aese V<ssa_33>.16b, v13.16b                            // ..................*...................................................
        // aesmc V<ssa_37>.16b, V<ssa_32>.16b                     // .................*....................................................
        // aese V<ssa_35>.16b, v13.16b                            // ...................*..................................................
        // aese V<ssa_36>.16b, v13.16b                            // ..................*...................................................
        // aesmc V<ssa_38>.16b, V<ssa_34>.16b                     // ....................*.................................................
        // aesmc V<ssa_39>.16b, V<ssa_33>.16b                     // ....................*.................................................
        // aese V<ssa_37>.16b, v12.16b                            // ...................*..................................................
        // aesmc V<ssa_40>.16b, V<ssa_35>.16b                     // .....................*................................................
        // aesmc V<ssa_41>.16b, V<ssa_36>.16b                     // ....................*.................................................
        // aesmc V<ssa_42>.16b, V<ssa_37>.16b                     // .....................*................................................
        // aese V<ssa_38>.16b, v20.16b                            // ......................*...............................................
        // aese V<ssa_39>.16b, v14.16b                            // ......................*...............................................
        // aese V<ssa_40>.16b, v14.16b                            // .......................*..............................................
        // aese V<ssa_41>.16b, v14.16b                            // ......................*...............................................
        // aesmc V<ssa_43>.16b, V<ssa_38>.16b                     // ........................*.............................................
        // aesmc V<ssa_44>.16b, V<ssa_39>.16b                     // ........................*.............................................
        // aese V<ssa_42>.16b, v13.16b                            // .......................*..............................................
        // aesmc V<ssa_45>.16b, V<ssa_40>.16b                     // .........................*............................................
        // aesmc V<ssa_46>.16b, V<ssa_41>.16b                     // ........................*.............................................
        // aese V<ssa_43>.16b, v21.16b                            // ..........................*...........................................
        // aesmc V<ssa_47>.16b, V<ssa_42>.16b                     // .........................*............................................
        // aese V<ssa_44>.16b, v15.16b                            // ..........................*...........................................
        // aese V<ssa_45>.16b, v15.16b                            // ...........................*..........................................
        // aese V<ssa_46>.16b, v15.16b                            // ..........................*...........................................
        // aesmc V<ssa_48>.16b, V<ssa_43>.16b                     // ............................*.........................................
        // aesmc V<ssa_49>.16b, V<ssa_44>.16b                     // ............................*.........................................
        // aese V<ssa_47>.16b, v14.16b                            // ...........................*..........................................
        // aesmc V<ssa_50>.16b, V<ssa_45>.16b                     // .............................*........................................
        // aesmc V<ssa_51>.16b, V<ssa_46>.16b                     // ............................*.........................................
        // aese V<ssa_49>.16b, v4.16b                             // ..............................*.......................................
        // aese V<ssa_48>.16b, v22.16b                            // ..............................*.......................................
        // aesmc V<ssa_52>.16b, V<ssa_47>.16b                     // .............................*........................................
        // aese V<ssa_50>.16b, v4.16b                             // ...............................*......................................
        // aese V<ssa_51>.16b, v4.16b                             // ..............................*.......................................
        // aesmc V<ssa_53>.16b, V<ssa_48>.16b                     // ................................*.....................................
        // aesmc V<ssa_54>.16b, V<ssa_49>.16b                     // ................................*.....................................
        // aese V<ssa_52>.16b, v15.16b                            // ...............................*......................................
        // aesmc V<ssa_55>.16b, V<ssa_50>.16b                     // .................................*....................................
        // aesmc V<ssa_56>.16b, V<ssa_51>.16b                     // ................................*.....................................
        // aese V<ssa_54>.16b, v5.16b                             // ..................................*...................................
        // aesmc V<ssa_57>.16b, V<ssa_52>.16b                     // .................................*....................................
        // aese V<ssa_53>.16b, v23.16b                            // ..................................*...................................
        // aese V<ssa_56>.16b, v5.16b                             // ..................................*...................................
        // aese V<ssa_55>.16b, v5.16b                             // ...................................*..................................
        // eor V<ssa_58>.16B, V<ssa_53>.16B, v7.16B               // ....................................*.................................
        // aesmc V<ssa_59>.16b, V<ssa_54>.16b                     // ....................................*.................................
        // aese V<ssa_57>.16b, v4.16b                             // ...................................*..................................
        // aesmc V<ssa_60>.16b, V<ssa_56>.16b                     // ....................................*.................................
        // aesmc V<ssa_61>.16b, V<ssa_55>.16b                     // .....................................*................................
        // eor V<ssa_62>.16B, V<ssa_58>.16B, v9.16B               // ......................................*...............................
        // fmov D<ssa_63>, x5                                     // .*....................................................................
        // aese V<ssa_59>.16b, v18.16b                            // ......................................*...............................
        // aesmc V<ssa_64>.16b, V<ssa_57>.16b                     // .....................................*................................
        // aese V<ssa_61>.16b, v18.16b                            // .......................................*..............................
        // aese V<ssa_60>.16b, v18.16b                            // ......................................*...............................
        // eor X<ssa_65>, X<ssa_19>, X<ssa_18>, lsl #1            // .......*..............................................................
        // aese V<ssa_64>.16b, v5.16b                             // .......................................*..............................
        // stp Q<ssa_62>, q27, [x1], #32                          // ........................................*.............................
        // aesmc V<ssa_66>.16b, V<ssa_59>.16b                     // ........................................*.............................
        // fmov V<ssa_63>.d[1], x17                               // ....*.................................................................
        // aesmc V<ssa_67>.16b, V<ssa_61>.16b                     // .........................................*............................
        // aesmc V<ssa_68>.16b, V<ssa_60>.16b                     // ........................................*.............................
        // extr X<ssa_69>, X<ssa_14>, X<ssa_18>, #63              // ......*...............................................................
        // st1 {V<ssa_11>.16B}, [x1], #16                         // ...........................................*..........................
        // aesmc V<ssa_70>.16b, V<ssa_64>.16b                     // .........................................*............................
        // aese V<ssa_66>.16b, v19.16b                            // ..........................................*...........................
        // extr X<ssa_71>, X<ssa_69>, X<ssa_65>, #63              // ........*.............................................................
        // extr x22, X<ssa_69>, X<ssa_69>, #32                    // .......................................*..............................
        // aese V<ssa_67>.16b, v19.16b                            // ...........................................*..........................
        // and W<ssa_72>, w19, w22, asr #31                       // ..........................................*...........................
        // aese V<ssa_68>.16b, v19.16b                            // ..........................................*...........................
        // extr x22, X<ssa_71>, X<ssa_71>, #32                    // .........*............................................................
        // eor V<ssa_73>.16B, V<ssa_4>.16B, V<ssa_63>.16B         // .......*..............................................................
        // aesmc V<ssa_74>.16b, V<ssa_66>.16b                     // ............................................*.........................
        // eor X<ssa_75>, X<ssa_72>, X<ssa_65>, lsl #1            // ...........................................*..........................
        // aese V<ssa_70>.16b, v18.16b                            // ...........................................*..........................
        // aesmc V<ssa_76>.16b, V<ssa_67>.16b                     // .............................................*........................
        // aesmc V<ssa_77>.16b, V<ssa_68>.16b                     // ............................................*.........................
        // and W<ssa_78>, w19, w22, asr #31                       // .......................................*..............................
        // aesmc V<ssa_79>.16b, V<ssa_70>.16b                     // .............................................*........................
        // aese V<ssa_74>.16b, v20.16b                            // ..............................................*.......................
        // aese V<ssa_73>.16b, v16.16b                            // .........*............................................................
        // eor x9, X<ssa_78>, X<ssa_75>, lsl #1                   // ............................................*.........................
        // aese V<ssa_77>.16b, v20.16b                            // ..............................................*.......................
        // aese V<ssa_76>.16b, v20.16b                            // ...............................................*......................
        // extr x10, X<ssa_71>, X<ssa_75>, #63                    // ............................................*.........................
        // aesmc V<ssa_82>.16b, V<ssa_73>.16b                     // ...........*..........................................................
        // aese V<ssa_79>.16b, v19.16b                            // ...............................................*......................
        // aesmc V<ssa_83>.16b, V<ssa_74>.16b                     // ................................................*.....................
        // aesmc V<ssa_84>.16b, V<ssa_76>.16b                     // .................................................*....................
        // aesmc V<ssa_85>.16b, V<ssa_77>.16b                     // ................................................*.....................
        // aesmc V<ssa_86>.16b, V<ssa_79>.16b                     // .................................................*....................
        // aese V<ssa_83>.16b, v21.16b                            // ..................................................*...................
        // aese V<ssa_82>.16b, v17.16b                            // .............*........................................................
        // aese V<ssa_85>.16b, v21.16b                            // ..................................................*...................
        // aese V<ssa_84>.16b, v21.16b                            // ...................................................*..................
        // aesmc V<ssa_87>.16b, V<ssa_82>.16b                     // ...............*......................................................
        // aesmc V<ssa_88>.16b, V<ssa_83>.16b                     // ....................................................*.................
        // aese V<ssa_86>.16b, v20.16b                            // ...................................................*..................
        // aesmc V<ssa_89>.16b, V<ssa_84>.16b                     // .....................................................*................
        // aesmc V<ssa_90>.16b, V<ssa_85>.16b                     // ....................................................*.................
        // aesmc V<ssa_91>.16b, V<ssa_86>.16b                     // .....................................................*................
        // aese V<ssa_88>.16b, v22.16b                            // ......................................................*...............
        // aese V<ssa_87>.16b, v12.16b                            // .................*....................................................
        // aese V<ssa_90>.16b, v22.16b                            // ......................................................*...............
        // aese V<ssa_89>.16b, v22.16b                            // .......................................................*..............
        // aese V<ssa_91>.16b, v21.16b                            // .......................................................*..............
        // aesmc V<ssa_92>.16b, V<ssa_88>.16b                     // ........................................................*.............
        // aesmc V<ssa_93>.16b, V<ssa_87>.16b                     // ...................*..................................................
        // ld1 {v16.4S}, [X<ssa_3>], #16                          // ....................................*.................................
        // aesmc V<ssa_95>.16b, V<ssa_90>.16b                     // ........................................................*.............
        // aesmc V<ssa_96>.16b, V<ssa_89>.16b                     // .........................................................*............
        // aese V<ssa_92>.16b, v23.16b                            // ..........................................................*...........
        // aese V<ssa_93>.16b, v13.16b                            // .....................*................................................
        // aesmc V<ssa_97>.16b, V<ssa_91>.16b                     // .........................................................*............
        // aese V<ssa_96>.16b, v23.16b                            // ...........................................................*..........
        // aese V<ssa_95>.16b, v23.16b                            // ..........................................................*...........
        // aese V<ssa_97>.16b, v22.16b                            // ...........................................................*..........
        // ld1 {v17.4S}, [X<ssa_3>], #16                          // ..................................................................*...
        // eor V<ssa_99>.16B, V<ssa_92>.16B, v7.16B               // ............................................................*.........
        // aesmc V<ssa_100>.16b, V<ssa_93>.16b                    // .......................*..............................................
        // eor V<ssa_102>.16B, V<ssa_95>.16B, v7.16B              // ............................................................*.........
        // eor V<ssa_103>.16B, V<ssa_96>.16B, v7.16B              // .............................................................*........
        // eor V<ssa_104>.16B, V<ssa_99>.16B, v8.16B              // ..............................................................*.......
        // fmov d8, X<ssa_18>                                     // ..............................................................*.......
        // aese V<ssa_100>.16b, v14.16b                           // .........................*............................................
        // aesmc V<ssa_105>.16b, V<ssa_97>.16b                    // .............................................................*........
        // eor V<ssa_106>.16B, V<ssa_102>.16B, v6.16B             // ..............................................................*.......
        // fmov d6, x4                                            // ..............................................................*.......
        // eor V<ssa_107>.16B, V<ssa_103>.16B, v10.16B            // ...............................................................*......
        // fmov d10, X<ssa_75>                                    // ...............................................................*......
        // aesmc V<ssa_109>.16b, V<ssa_100>.16b                   // ...........................*..........................................
        // ld1 {V<ssa_110>.16B}, [x0], #16                        // .....................................*................................
        // ld1 {V<ssa_111>.16B}, [x0], #16                        // ..........................................*...........................
        // aese V<ssa_105>.16b, v23.16b                           // ...............................................................*......
        // ld1 {V<ssa_113>.16B}, [x0], #16                        // ............................................*.........................
        // fmov v8.d[1], X<ssa_14>                                // .................................................................*....
        // ld1 {V<ssa_114>.16B}, [x0], #16                        // ..........................................................*...........
        // fmov v6.d[1], X<ssa_9>                                 // .................................................................*....
        // eor V<ssa_115>.16B, V<ssa_105>.16B, v7.16B             // .................................................................*....
        // aese V<ssa_109>.16b, v15.16b                           // .............................*........................................
        // fmov v10.d[1], X<ssa_71>                               // ..................................................................*...
        // ld1 {V<ssa_116>.16B}, [x0], #16                        // ...........................................................*..........
        // aesmc V<ssa_117>.16b, V<ssa_109>.16b                   // ...............................*......................................
        // eor V<ssa_118>.16B, V<ssa_115>.16B, V<ssa_12>.16B      // ...................................................................*..
        // fmov d11, x9                                           // ..................................................*...................
        // eor v1.16B, V<ssa_111>.16B, v8.16B                     // .....................................................................*
        // eor v0.16B, V<ssa_110>.16B, v6.16B                     // ....................................................................*.
        // eor v25.16B, V<ssa_114>.16B, v10.16B                   // .....................................................................*
        // aese V<ssa_117>.16b, v4.16b                            // .................................*....................................
        // fmov v11.d[1], x10                                     // .......................................................*..............
        // aesmc V<ssa_126>.16b, V<ssa_117>.16b                   // ...................................*..................................
        // stp Q<ssa_106>, Q<ssa_104>, [x1], #32                  // ................................................................*.....
        // aese V<ssa_126>.16b, v5.16b                            // .....................................*................................
        // eor v26.16B, V<ssa_116>.16B, v11.16B                   // ................................................................*.....
        // aesmc V<ssa_132>.16b, V<ssa_126>.16b                   // .......................................*..............................
        // aese V<ssa_132>.16b, v18.16b                           // .........................................*............................
        // aesmc V<ssa_138>.16b, V<ssa_132>.16b                   // ...........................................*..........................
        // aese V<ssa_138>.16b, v19.16b                           // .............................................*........................
        // aesmc V<ssa_142>.16b, V<ssa_138>.16b                   // ...............................................*......................
        // aese V<ssa_142>.16b, v20.16b                           // .................................................*....................
        // aesmc V<ssa_147>.16b, V<ssa_142>.16b                   // ...................................................*..................
        // aese V<ssa_147>.16b, v21.16b                           // .....................................................*................
        // aesmc V<ssa_152>.16b, V<ssa_147>.16b                   // .......................................................*..............
        // aese V<ssa_152>.16b, v22.16b                           // .........................................................*............
        // aesmc V<ssa_157>.16b, V<ssa_152>.16b                   // ...........................................................*..........
        // aese V<ssa_157>.16b, v23.16b                           // .............................................................*........
        // eor V<ssa_162>.16B, V<ssa_157>.16B, v7.16B             // ...............................................................*......
        // eor V<ssa_166>.16B, V<ssa_162>.16B, V<ssa_63>.16B      // .................................................................*....
        // fmov d9, X<ssa_65>                                     // ......................................*...............................
        // stp Q<ssa_166>, Q<ssa_107>, [x1], #32                  // ...................................................................*..
        // fmov v9.d[1], X<ssa_69>                                // ..........................................*...........................
        // st1 {V<ssa_118>.16B}, [x1], #16                        // .....................................................................*
        // eor v24.16B, V<ssa_113>.16B, v9.16B                    // ................................................*.....................



    // If left 4 blocks, borrow the five block's processing.
    // This means if (x2 + 1 block) == 0, which is the case
    // when input size % 5 = 4, continue processing and do
    // another iteration in Loop5x_xts_enc which will exit from
    // cbz  x6,.Lxts_enc_tail4x.
    // Otherwise, this is the end of the loop continue processing
    // 0, 1, 2 or 3 blocks (with or without tail) starting at
    // Loop5x_enc_after
 cmn	x2,#0x10
 b.ne	Loop5x_enc_after
// orr	v11.16b,v10.16b,v10.16b
// orr	v10.16b,v9.16b,v9.16b
// orr	v9.16b,v8.16b,v8.16b
// orr	v8.16b,v6.16b,v6.16b
// fmov	x9,d11
// fmov	x10,v11.d[1]
// eor	v0.16b,v6.16b,v2.16b
// eor	v1.16b,v8.16b,v3.16b
// eor	v24.16b,v27.16b,v9.16b
// eor	v25.16b,v28.16b,v10.16b
// eor	v26.16b,v29.16b,v11.16b
    b.eq  Lxts_enc_tail4x

Loop5x_enc_after:
 add	x2,x2,#0x50
 cbz	x2,Lxts_enc_done     // no blocks left

 add	w6,w5,#2
 subs	x2,x2,#0x30
 b.lo	Lxts_inner_enc_tail    // 1 or 2 blocks left
                                    // (with tail or not)

 eor	v0.16b,v6.16b,v27.16b         // 3 blocks left
 eor	v1.16b,v8.16b,v28.16b
 eor	v24.16b,v29.16b,v9.16b
 b	Lxts_outer_enc_tail

.align	4
Lxts_enc_tail4x:
 orr	v11.16b,v10.16b,v10.16b
 orr	v10.16b,v9.16b,v9.16b
 orr	v9.16b,v8.16b,v8.16b
 orr	v8.16b,v6.16b,v6.16b
 fmov	x9,d11
 fmov	x10,v11.d[1]
 eor	v0.16b,v6.16b,v2.16b
 eor	v1.16b,v8.16b,v3.16b
 eor	v24.16b,v27.16b,v9.16b
 eor	v25.16b,v28.16b,v10.16b
 eor	v26.16b,v29.16b,v11.16b

 aese	v0.16b,v16.16b
 aesmc	v0.16b,v0.16b
 aese	v1.16b,v16.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v16.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v16.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v16.16b
 aesmc	v26.16b,v26.16b
 subs	x2,x2,#0x50         // because Lxts_enc_tail4x

 aese	v0.16b,v17.16b
 aesmc	v0.16b,v0.16b
 aese	v1.16b,v17.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v17.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v17.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v17.16b
 aesmc	v26.16b,v26.16b
 csel	x6,xzr,x2,gt    // borrow x6, w6, "gt" is not typo
 mov	x7,x3

 aese	v0.16b,v12.16b
 aesmc	v0.16b,v0.16b
 aese	v1.16b,v12.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v12.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v12.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v12.16b
 aesmc	v26.16b,v26.16b

 aese	v0.16b,v13.16b
 aesmc	v0.16b,v0.16b
 aese	v1.16b,v13.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v13.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v13.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v13.16b
 aesmc	v26.16b,v26.16b

    aese	v0.16b,v14.16b
 aesmc	v0.16b,v0.16b
 aese	v1.16b,v14.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v14.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v14.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v14.16b
 aesmc	v26.16b,v26.16b

 aese	v0.16b,v15.16b
 aesmc	v0.16b,v0.16b
 aese	v1.16b,v15.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v15.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v15.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v15.16b
 aesmc	v26.16b,v26.16b

 aese	v0.16b,v4.16b
 aesmc	v0.16b,v0.16b
 aese	v1.16b,v4.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v4.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v4.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v4.16b
 aesmc	v26.16b,v26.16b

 aese	v0.16b,v5.16b
 aesmc	v0.16b,v0.16b
 aese	v1.16b,v5.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v5.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v5.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v5.16b
 aesmc	v26.16b,v26.16b

 aese	v0.16b,v18.16b
 aesmc	v0.16b,v0.16b
 aese	v1.16b,v18.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v18.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v18.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v18.16b
 aesmc	v26.16b,v26.16b
 add	x0,x0,x6  // x0 is adjusted in such way that
                                // at exit from the loop v1.16b-v26.16b
                                // are loaded with last "words"
 // add	x6,x2,#0x60          // because Lxts_enc_tail4x

 aese	v0.16b,v19.16b
 aesmc	v0.16b,v0.16b
 aese	v1.16b,v19.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v19.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v19.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v19.16b
 aesmc	v26.16b,v26.16b

 aese	v0.16b,v20.16b
 aesmc	v0.16b,v0.16b
 aese	v1.16b,v20.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v20.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v20.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v20.16b
 aesmc	v26.16b,v26.16b

 aese	v0.16b,v21.16b
 aesmc	v0.16b,v0.16b
 aese	v1.16b,v21.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v21.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v21.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v21.16b
 aesmc	v26.16b,v26.16b

 aese	v0.16b,v22.16b
 aesmc	v0.16b,v0.16b
 aese	v1.16b,v22.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v22.16b
 aesmc	v24.16b,v24.16b
 aese	v25.16b,v22.16b
 aesmc	v25.16b,v25.16b
 aese	v26.16b,v22.16b
 aesmc	v26.16b,v26.16b

 aese	v0.16b,v23.16b
 aese	v1.16b,v23.16b
 aese	v24.16b,v23.16b
 aese	v25.16b,v23.16b
 aese	v26.16b,v23.16b

 eor	v0.16b,v0.16b,v7.16b
 eor	v0.16b,v0.16b,v6.16b
    // The iv for first block of one iteration
 extr	x22,x10,x10,#32
 extr	x10,x10,x9,#63
 and	w11,w19,w22,asr#31
 eor	x9,x11,x9,lsl#1
 fmov	d6,x9
 fmov	v6.d[1],x10
    eor	v1.16b,v1.16b,v7.16b
    eor	v1.16b,v1.16b,v8.16b
 ld1	{v2.16b},[x0],#16
    // The iv for second block
 extr	x22,x10,x10,#32
 extr	x10,x10,x9,#63
 and	w11,w19,w22,asr#31
 eor	x9,x11,x9,lsl#1
 fmov	d8,x9
 fmov	v8.d[1],x10
    eor	v24.16b,v24.16b,v7.16b
    eor	v24.16b,v24.16b,v9.16b
    ld1	{v3.16b},[x0],#16
    // The iv for third block
 extr	x22,x10,x10,#32
 extr	x10,x10,x9,#63
 and	w11,w19,w22,asr#31
 eor	x9,x11,x9,lsl#1
 fmov	d9,x9
 fmov	v9.d[1],x10
    eor	v25.16b,v25.16b,v7.16b
    eor	v25.16b,v25.16b,v10.16b
 ld1	{v27.16b},[x0],#16
    // The iv for fourth block
 extr	x22,x10,x10,#32
 extr	x10,x10,x9,#63
 and	w11,w19,w22,asr#31
 eor	x9,x11,x9,lsl#1
 fmov	d10,x9
 fmov	v10.d[1],x10
    eor	v26.16b,v26.16b,v7.16b
    eor	v26.16b,v26.16b,v11.16b
 ld1	{v28.16b},[x0],#16

    // The iv for fifth block
 extr	x22,x10,x10,#32
 extr	x10,x10,x9,#63
 and	w11,w19,w22,asr #31
 eor	x9,x11,x9,lsl #1
 fmov	d11,x9
 fmov	v11.d[1],x10

 ld1	{v29.16b},[x0],#16

 add	x0,x0,#16
    st1  {v1.16b},[x1],#16
    st1	{v24.16b,v25.16b},[x1],#32
    st1  {v26.16b},[x1],#16
 b	Lxts_enc_done
.align	4
Lxts_outer_enc_tail:
 aese	v0.16b,v16.16b
 aesmc	v0.16b,v0.16b
 aese	v1.16b,v16.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v16.16b
 aesmc	v24.16b,v24.16b
 ld1	{v16.4s},[x7],#16
 subs	w6,w6,#2
 aese	v0.16b,v17.16b
 aesmc	v0.16b,v0.16b
 aese	v1.16b,v17.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v17.16b
 aesmc	v24.16b,v24.16b
 ld1	{v17.4s},[x7],#16
 b.gt	Lxts_outer_enc_tail

 aese	v0.16b,v16.16b
 aesmc	v0.16b,v0.16b
 aese	v1.16b,v16.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v16.16b
 aesmc	v24.16b,v24.16b
 eor	v4.16b,v6.16b,v7.16b
 aese	v0.16b,v17.16b
 aesmc	v0.16b,v0.16b
 aese	v1.16b,v17.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v17.16b
 aesmc	v24.16b,v24.16b
 aese	v0.16b,v20.16b
 aesmc	v0.16b,v0.16b
 aese	v1.16b,v20.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v20.16b
 aesmc	v24.16b,v24.16b
 aese	v0.16b,v21.16b
 aesmc	v0.16b,v0.16b
 aese	v1.16b,v21.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v21.16b
 aesmc	v24.16b,v24.16b
 aese	v0.16b,v22.16b
 aesmc	v0.16b,v0.16b
 aese	v1.16b,v22.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v22.16b
 aesmc	v24.16b,v24.16b
 aese	v0.16b,v23.16b
 aese	v1.16b,v23.16b
 aese	v24.16b,v23.16b

 eor	v17.16b,v9.16b,v7.16b
 subs	x2,x2,#0x30
    // The iv for first block
 fmov	x9,d9
 fmov	x10,v9.d[1]
    // mov   w19,#0x87
 extr	x22,x10,x10,#32
 extr	x10,x10,x9,#63
 and	w11,w19,w22,asr#31
 eor	x9,x11,x9,lsl#1
 fmov	d6,x9
 fmov	v6.d[1],x10
 eor	v5.16b,v8.16b,v7.16b
 csel	x6,x2,x6,lo   // x6, w6, is zero at this point

 add	x6,x6,#0x20
 add	x0,x0,x6
 mov	x7,x3

 ld1	{v27.16b},[x0],#16
 add	w6,w5,#2
 eor	v4.16b,v4.16b,v0.16b
 eor	v5.16b,v5.16b,v1.16b
 eor	v24.16b,v24.16b,v17.16b
 ld1	{v16.4s,v17.4s},[x7],#32
 st1	{v4.16b,v5.16b},[x1],#32
 st1	{v24.16b},[x1],#16
 cmn	x2,#0x30
 b.eq	Lxts_enc_done
Lxts_encxor_one:
 orr	v28.16b,v3.16b,v3.16b
 orr	v29.16b,v27.16b,v27.16b
 nop

Lxts_inner_enc_tail:
 cmn	x2,#0x10
 eor	v1.16b,v28.16b,v6.16b
 eor	v24.16b,v29.16b,v8.16b
 b.eq	Lxts_enc_tail_loop
 eor	v24.16b,v29.16b,v6.16b
Lxts_enc_tail_loop:
 aese	v1.16b,v16.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v16.16b
 aesmc	v24.16b,v24.16b
 ld1	{v16.4s},[x7],#16
 subs	w6,w6,#2
 aese	v1.16b,v17.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v17.16b
 aesmc	v24.16b,v24.16b
 ld1	{v17.4s},[x7],#16
 b.gt	Lxts_enc_tail_loop

 aese	v1.16b,v16.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v16.16b
 aesmc	v24.16b,v24.16b
 aese	v1.16b,v17.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v17.16b
 aesmc	v24.16b,v24.16b
 aese	v1.16b,v20.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v20.16b
 aesmc	v24.16b,v24.16b
 cmn	x2,#0x20
 aese	v1.16b,v21.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v21.16b
 aesmc	v24.16b,v24.16b
 eor	v5.16b,v6.16b,v7.16b
 aese	v1.16b,v22.16b
 aesmc	v1.16b,v1.16b
 aese	v24.16b,v22.16b
 aesmc	v24.16b,v24.16b
 eor	v17.16b,v8.16b,v7.16b
 aese	v1.16b,v23.16b
 aese	v24.16b,v23.16b
 b.eq	Lxts_enc_one
 eor	v5.16b,v5.16b,v1.16b
 st1	{v5.16b},[x1],#16
 eor	v17.16b,v17.16b,v24.16b
 orr	v6.16b,v8.16b,v8.16b
 st1	{v17.16b},[x1],#16
 fmov	x9,d8
 fmov	x10,v8.d[1]
 mov	w19,#0x87
 extr	x22,x10,x10,#32
 extr	x10,x10,x9,#63
 and	w11,w19,w22,asr #31
 eor	x9,x11,x9,lsl #1
 fmov	d6,x9
 fmov	v6.d[1],x10
 b	Lxts_enc_done

Lxts_enc_one:
 eor	v5.16b,v5.16b,v24.16b
 orr	v6.16b,v6.16b,v6.16b
 st1	{v5.16b},[x1],#16
 fmov	x9,d6
 fmov	x10,v6.d[1]
 mov	w19,#0x87
 extr	x22,x10,x10,#32
 extr	x10,x10,x9,#63
 and	w11,w19,w22,asr #31
 eor	x9,x11,x9,lsl #1
 fmov	d6,x9
 fmov	v6.d[1],x10
 b	Lxts_enc_done
.align	5
Lxts_enc_done:
    // Process the tail block with cipher stealing.
 tst	x21,#0xf
 b.eq	Lxts_abort

 mov	x20,x0
 mov	x13,x1
 sub	x1,x1,#16
.composite_enc_loop:
 subs	x21,x21,#1
 ldrb	w15,[x1,x21]
 ldrb	w14,[x20,x21]
 strb	w15,[x13,x21]
 strb	w14,[x1,x21]
 b.gt	.composite_enc_loop
Lxts_enc_load_done:
 ld1	{v26.16b},[x1]
 eor	v26.16b,v26.16b,v6.16b

    // Encrypt the composite block to get the last second encrypted text block
 ldr	w6,[x3,#240]        // load key schedule...
 ld1	{v0.16b},[x3],#16
 sub	w6,w6,#2
 ld1	{v1.16b},[x3],#16     // load key schedule...
Loop_final_enc:
 aese	v26.16b,v0.16b
 aesmc	v26.16b,v26.16b
 ld1	{v0.4s},[x3],#16
 subs	w6,w6,#2
 aese	v26.16b,v1.16b
 aesmc	v26.16b,v26.16b
 ld1	{v1.4s},[x3],#16
 b.gt	Loop_final_enc

 aese	v26.16b,v0.16b
 aesmc	v26.16b,v26.16b
 ld1	{v0.4s},[x3]
 aese	v26.16b,v1.16b
 eor	v26.16b,v26.16b,v0.16b
 eor	v26.16b,v26.16b,v6.16b
 st1	{v26.16b},[x1]

Lxts_abort:
 ldp	x21,x22,[sp,#16]
 ldp	x19,x20,[sp],#32
Lxts_enc_final_abort:
    restore_vregs
    add sp, sp, #STACK_SIZE_VREGS
 ret

#endif
#endif  // !OPENSSL_NO_ASM && defined(__AARCH64EL__) && defined(__APPLE__)
#if defined(__ELF__)
// See https: // www.airs.com/blog/archives/518.
.section .note.GNU-stack,"",%progbits
#endif
